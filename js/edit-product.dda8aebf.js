(window.webpackJsonp=window.webpackJsonp||[]).push([["edit-product"],{"06c5":function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));e=n("fb6a"),e=n("d3b7"),e=n("b0c0"),e=n("a630"),e=n("3ca3");var r=n("6b75");function o(t,e){if(t){if("string"==typeof t)return Object(r.a)(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(r.a)(t,e):void 0}}},"0a31":function(t,e,n){},"1148d":function(t,e,n){"use strict";var r=n("a691"),o=n("1d80");t.exports=function(t){var e=String(o(this)),n="",i=r(t);if(i<0||i==1/0)throw RangeError("Wrong number of repetitions");for(;0<i;(i>>>=1)&&(e+=e))1&i&&(n+=e);return n}},2909:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("6b75");n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0"),n("a630");var o=n("06c5");function i(t){return function(t){if(Array.isArray(t))return Object(r.a)(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Object(o.a)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},"408a":function(t,e,n){var r=n("c6b6");t.exports=function(t){if("number"!=typeof t&&"Number"!=r(t))throw TypeError("Incorrect invocation");return+t}},"654a":function(t,e,n){"use strict";n("944c")},"6b75":function(t,e,n){"use strict";function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.d(e,"a",(function(){return r}))},"82a1":function(t,e,n){},"944c":function(t,e,n){},a9e3:function(t,e,n){"use strict";function r(t){var e,n,r,o,i,s,a,c=d(t,!1);if("string"==typeof c&&2<c.length)if(43===(e=(c=g(c)).charCodeAt(0))||45===e){if(88===(t=c.charCodeAt(2))||120===t)return NaN}else if(48===e){switch(c.charCodeAt(1)){case 66:case 98:n=2,r=49;break;case 79:case 111:n=8,r=55;break;default:return+c}for(i=(o=c.slice(2)).length,s=0;s<i;s++)if((a=o.charCodeAt(s))<48||r<a)return NaN;return parseInt(o,n)}return+c}var o=n("83ab"),i=n("da84"),s=n("94ca"),a=n("6eeb"),c=n("5135"),l=n("c6b6"),p=n("7156"),d=n("c04e"),u=n("d039"),h=n("7c73"),f=n("241c").f,m=n("06cf").f,v=n("9bf2").f,g=n("58a8").trim,y="Number",b=i[y],w=b.prototype,k=l(h(w))==y;if(s(y,!b(" 0o1")||!b("0b1")||b("+0x1"))){for(var O,x=function(t){t=arguments.length<1?0:t;var e=this;return e instanceof x&&(k?u((function(){w.valueOf.call(e)})):l(e)!=y)?p(new b(r(t)),e,x):r(t)},M=o?f(b):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),S=0;M.length>S;S++)c(b,O=M[S])&&!c(x,O)&&v(x,O,m(b,O));(x.prototype=w).constructor=x,a(i,y,x)}},abb3:function(t,e,n){"use strict";n("82a1")},b680:function(t,e,n){"use strict";function r(t,e,n){for(var r=-1,o=n;++r<6;)o+=e*t[r],t[r]=o%1e7,o=d(o/1e7)}function o(t,e){for(var n=6,r=0;0<=--n;)r+=t[n],t[n]=d(r/e),r=r%e*1e7}function i(t){for(var e,n=6,r="";0<=--n;)""===r&&0!==n&&0===t[n]||(e=String(t[n]),r=""===r?e:r+l.call("0",7-e.length)+e);return r}var s=n("23e7"),a=n("a691"),c=n("408a"),l=n("1148d"),p=(n=n("d039"),1..toFixed),d=Math.floor,u=function(t,e,n){return 0===e?n:e%2==1?u(t,e-1,n*t):u(t*t,e/2,n)};s({target:"Number",proto:!0,forced:p&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n((function(){p.call({})}))},{toFixed:function(t){var e,n,s=c(this),p=a(t),d=[0,0,0,0,0,0],h="";t="0";if(p<0||20<p)throw RangeError("Incorrect fraction digits");if(s!=s)return"NaN";if(s<=-1e21||1e21<=s)return String(s);if(s<0&&(h="-",s=-s),1e-21<s)if(s=(n=function(t){for(var e=0,n=t;4096<=n;)e+=12,n/=4096;for(;2<=n;)e+=1,n/=2;return e}(s*u(2,69,1))-69)<0?s*u(2,-n,1):s/u(2,n,1),s*=4503599627370496,0<(n=52-n)){for(r(d,0,s),e=p;7<=e;)r(d,1e7,0),e-=7;for(r(d,u(10,e,1),0),e=n-1;23<=e;)o(d,1<<23),e-=23;o(d,1<<e),r(d,1,1),o(d,2),t=i(d)}else r(d,0,s),r(d,1<<-n,0),t=i(d)+l.call("0",p);return 0<p?h+((n=t.length)<=p?"0."+l.call("0",p-n)+t:t.slice(0,n-p)+"."+t.slice(n-p)):h+t}})},c2fb:function(t,e,n){"use strict";n.r(e);var r=n("8bbf"),o=Object(r.withScopeId)("data-v-321a5573");Object(r.pushScopeId)("data-v-321a5573");var i=Object(r.createTextVNode)(" 媒体上传 "),s=Object(r.createTextVNode)(" open showViewer "),a=Object(r.createTextVNode)(" 产品多属性 变体配置 "),c=Object(r.createTextVNode)(" 产品状态 下拉列表 "),l=Object(r.createTextVNode)(" 洞察 产品近期进行过销售 会显示洞察 "),p=Object(r.createTextVNode)(" 组织 产品 系列 标签 厂商 "),d=Object(r.createTextVNode)(" 删除 保存 ");Object(r.popScopeId)();var u=o((function(t,e,n,u,h,f){var m=Object(r.resolveComponent)("el-input"),v=Object(r.resolveComponent)("el-form-item"),g=Object(r.resolveComponent)("editor"),y=Object(r.resolveComponent)("el-form"),b=Object(r.resolveComponent)("el-card"),w=Object(r.resolveComponent)("el-button"),k=Object(r.resolveComponent)("preview-media"),O=Object(r.resolveComponent)("el-table-column"),x=Object(r.resolveComponent)("el-table"),M=Object(r.resolveComponent)("el-col"),S=Object(r.resolveComponent)("el-row"),C=Object(r.resolveComponent)("el-main"),T=Object(r.resolveDirective)("has");return Object(r.openBlock)(),Object(r.createBlock)(C,{class:"edit-product"},{default:o((function(){return[Object(r.createVNode)(S,{gutter:20},{default:o((function(){return[Object(r.createVNode)(M,{xl:16},{default:o((function(){return[Object(r.createVNode)(b,null,{default:o((function(){return[Object(r.createVNode)(y,null,{default:o((function(){return[Object(r.createVNode)(v,{label:"标题"},{default:o((function(){return[Object(r.createVNode)(m)]})),_:1}),Object(r.createVNode)(v,{label:"描述"},{default:o((function(){return[Object(r.createVNode)(g,{class:"editor"})]})),_:1})]})),_:1})]})),_:1}),Object(r.createVNode)(b,null,{default:o((function(){return[i,Object(r.withDirectives)(Object(r.createVNode)("div",null,"has",512),[[T]]),Object(r.createVNode)(w,{onClick:e[1]||(e[1]=function(e){return t.showViewer=!0})},{default:o((function(){return[s]})),_:1}),t.showViewer?(Object(r.openBlock)(),Object(r.createBlock)(k,{key:0,onClose:t.handleClosePreview,"initial-index":1,mediaList:[{type:"image",src:"https://fuss10.elemecdn.com/8/27/f01c15bb73e1ef3793e64e6b7bbccjpeg.jpeg"},{type:"video",src:"http://clips.vorwaerts-gmbh.de/big_buck_bunny.mp4"}]},null,8,["onClose","mediaList"])):Object(r.createCommentVNode)("",!0)]})),_:1}),Object(r.createVNode)(b,null,{default:o((function(){return[Object(r.createVNode)(x,null,{default:o((function(){return[Object(r.createVNode)(O)]})),_:1}),a]})),_:1})]})),_:1}),Object(r.createVNode)(M,{xl:8},{default:o((function(){return[Object(r.createVNode)(b,null,{default:o((function(){return[c]})),_:1}),Object(r.createVNode)(b,null,{default:o((function(){return[l]})),_:1}),Object(r.createVNode)(b,null,{default:o((function(){return[p]})),_:1})]})),_:1})]})),_:1}),Object(r.createVNode)(S,null,{default:o((function(){return[d]})),_:1})]})),_:1})})),h=n("1da1"),f=(n("96cf"),n("6389")),m=Object(r.withScopeId)("data-v-6815dab7");Object(r.pushScopeId)("data-v-6815dab7");var v={key:0},g={class:"item"},y={class:"item"},b=Object(r.createVNode)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},[Object(r.createVNode)("path",{fill:"none",d:"M0 0h24v24H0z"}),Object(r.createVNode)("path",{d:"M3 3h18a1 1 0 0 1 1 1v16a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1zm1 2v14h16V5H4zm16 7l-3.536 3.536-1.414-1.415L17.172 12 15.05 9.879l1.414-1.415L20 12zM6.828 12l2.122 2.121-1.414 1.415L4 12l3.536-3.536L8.95 9.88 6.828 12zm4.416 5H9.116l3.64-10h2.128l-3.64 10z"})],-1),w={class:"editor-container"},k={ref:"textareaEl",class:"editor-textarea"};Object(r.popScopeId)();var O=m((function(t,e,n,o,i,s){var a=Object(r.resolveComponent)("el-button"),c=Object(r.resolveComponent)("el-tooltip"),l=Object(r.resolveComponent)("el-button-group"),p=Object(r.resolveComponent)("editor-content");return t.editor?(Object(r.openBlock)(),Object(r.createBlock)("div",v,[Object(r.createVNode)("div",{class:"tools-container",style:{flexDirection:"".concat(t.sourceShow?"row-reverse":"row")}},[Object(r.withDirectives)(Object(r.createVNode)("div",g,[(Object(r.openBlock)(!0),Object(r.createBlock)(r.Fragment,null,Object(r.renderList)(t.toolsList,(function(t,e){return Object(r.openBlock)(),Object(r.createBlock)(l,{key:e},{default:m((function(){return[(Object(r.openBlock)(!0),Object(r.createBlock)(r.Fragment,null,Object(r.renderList)(t,(function(t){return Object(r.openBlock)(),Object(r.createBlock)(c,{key:t.tip,content:t.tip,placement:"top"},{default:m((function(){return[Object(r.createVNode)(a,{size:"mini",onClick:function(e){return t.handleClick()},class:{"is-active":t.handleIsActive()},innerHTML:t.svg},null,8,["onClick","class","innerHTML"])]})),_:2},1032,["content"])})),128))]})),_:2},1024)})),128))],512),[[r.vShow,!t.sourceShow]]),Object(r.createVNode)("div",y,[Object(r.createVNode)(a,{size:"mini",onClick:t.handleSwitchHTML,class:{"is-active":t.sourceShow}},{default:m((function(){return[b]})),_:1},8,["onClick","class"])])],4),Object(r.createVNode)("div",w,[Object(r.withDirectives)(Object(r.createVNode)(p,{class:"editor-content",editor:t.editor},null,8,["editor"]),[[r.vShow,!t.sourceShow]]),Object(r.withDirectives)(Object(r.createVNode)("textarea",k,null,512),[[r.vShow,t.sourceShow]])])])):Object(r.createCommentVNode)("",!0)})),x=n("2909");function M(t){this.content=t}n("99af"),M.prototype={constructor:M,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){return t=this.find(t),-1==t?void 0:this.content[t+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,o=r.find(t);r=r.content.slice();return-1==o?r.push(n||t,e):(r[o+1]=e,n&&(r[o]=n)),new M(r)},remove:function(t){var e=this.find(t);return-1==e?this:(t=this.content.slice(),t.splice(e,2),new M(t))},addToStart:function(t,e){return new M([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new M(n)},addBefore:function(t,e,n){var r=this.remove(e),o=r.content.slice();t=r.find(t);return o.splice(-1==t?o.length:t,0,e,n),new M(o)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return(t=M.from(t)).size?new M(t.content.concat(this.subtract(t).content)):this},append:function(t){return(t=M.from(t)).size?new M(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=M.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},get size(){return this.content.length>>1}},M.from=function(t){if(t instanceof M)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new M(e)};var S=M,C=function(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize},T={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};C.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<e;i++){var a,c=this.content[i],l=s+c.nodeSize;t<l&&!1!==n(c,r+s,o,i)&&c.content.size&&(a=s+1,c.nodesBetween(Math.max(0,t-a),Math.min(c.content.size,e-a),n,r+a)),s=l}},C.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},C.prototype.textBetween=function(t,e,n,r){var o="",i=!0;return this.nodesBetween(t,e,(function(s,a){s.isText?(o+=s.text.slice(Math.max(t,a)-a,e-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},C.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,r=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),o=1);o<t.content.length;o++)r.push(t.content[o]);return new C(r,this.size+t.size)},C.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(t<e)for(var o=0,i=0;i<e;o++){var s=this.content[o],a=i+s.nodeSize;t<a&&((i<t||e<a)&&(s=s.isText?s.cut(Math.max(0,t-i),Math.min(s.text.length,e-i)):s.cut(Math.max(0,t-i-1),Math.min(s.content.size,e-i-1))),n.push(s),r+=s.nodeSize),i=a}return new C(n,r)},C.prototype.cutByIndex=function(t,e){return t==e?C.empty:0==t&&e==this.content.length?this:new C(this.content.slice(t,e))},C.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice();n=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new C(r,n)},C.prototype.addToStart=function(t){return new C([t].concat(this.content),this.size+t.nodeSize)},C.prototype.addToEnd=function(t){return new C(this.content.concat(t),this.size+t.nodeSize)},C.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},T.firstChild.get=function(){return this.content.length?this.content[0]:null},T.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},T.childCount.get=function(){return this.content.length},C.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},C.prototype.maybeChild=function(t){return this.content[t]},C.prototype.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},C.prototype.findDiffStart=function(t,e){return function t(e,n,r){for(var o=0;;o++){if(o==e.childCount||o==n.childCount)return e.childCount==n.childCount?null:r;var i=e.child(o),s=n.child(o);if(i!=s){if(!i.sameMarkup(s))return r;if(i.isText&&i.text!=s.text){for(var a=0;i.text[a]==s.text[a];a++)r++;return r}if(i.content.size||s.content.size){var c=t(i.content,s.content,r+1);if(null!=c)return c}r+=i.nodeSize}else r+=i.nodeSize}}(this,t,e=void 0===e?0:e)},C.prototype.findDiffEnd=function(t,e,n){return function t(e,n,r,o){for(var i=e.childCount,s=n.childCount;;){if(0==i||0==s)return i==s?null:{a:r,b:o};var a=e.child(--i),c=n.child(--s),l=a.nodeSize;if(a!=c){if(!a.sameMarkup(c))return{a:r,b:o};if(a.isText&&a.text!=c.text){for(var p=0,d=Math.min(a.text.length,c.text.length);p<d&&a.text[a.text.length-p-1]==c.text[c.text.length-p-1];)p++,r--,o--;return{a:r,b:o}}if(a.content.size||c.content.size){var u=t(a.content,c.content,r-1,o-1);if(u)return u}r-=l,o-=l}else r-=l,o-=l}}(this,t,e=void 0===e?this.size:e,n=void 0===n?t.size:n)},C.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return A(0,t);if(t==this.size)return A(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(t<=o)return o==t||0<e?A(n+1,o):A(n,r);r=o}},C.prototype.toString=function(){return"<"+this.toStringInner()+">"},C.prototype.toStringInner=function(){return this.content.join(", ")},C.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},C.fromJSON=function(t,e){if(!e)return C.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new C(e.map(t.nodeFromJSON))},C.fromArray=function(t){if(!t.length)return C.empty;for(var e,n=0,r=0;r<t.length;r++){var o=t[r];n+=o.nodeSize,r&&o.isText&&t[r-1].sameMarkup(o)?(e=e||t.slice(0,r))[e.length-1]=o.withText(e[e.length-1].text+o.text):e&&e.push(o)}return new C(e||t,n)},C.from=function(t){if(!t)return C.empty;if(t instanceof C)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new C([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(C.prototype,T);var N={index:0,offset:0};function A(t,e){return N.index=t,N.offset=e,N}function E(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!E(t[r],e[r]))return!1}else{for(var o in t)if(!(o in e)||!E(t[o],e[o]))return!1;for(var i in e)if(!(i in t))return!1}return!0}function D(t,e){this.type=t,this.attrs=e}function _(t){return t=Error.call(this,t),t.__proto__=_.prototype,t}C.empty=new C([],0),D.prototype.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e=e||t.slice(0,r);else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&((e=e||t.slice(0,r)).push(this),n=!0),e&&e.push(o)}}return e=e||t.slice(),n||e.push(this),e},D.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},D.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},D.prototype.eq=function(t){return this==t||this.type==t.type&&E(this.attrs,t.attrs)},D.prototype.toJSON=function(){var t,e={type:this.type.name};for(t in this.attrs){e.attrs=this.attrs;break}return e},D.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");if(t=t.marks[e.type],!t)throw new RangeError("There is no mark type "+e.type+" in this schema");return t.create(e.attrs)},D.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},D.setFrom=function(t){return t&&0!=t.length?t instanceof D?[t]:(t=t.slice(),t.sort((function(t,e){return t.type.rank-e.type.rank})),t):D.none},D.none=[],((_.prototype=Object.create(Error.prototype)).constructor=_).prototype.name="ReplaceError";var j=function(t,e,n){this.content=t,this.openStart=e,this.openEnd=n},I={size:{configurable:!0}};function z(t,e,n){if(n.openStart>t.depth)throw new _("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new _("Inconsistent open depths");return function t(e,n,r,o){var i=e.index(o),s=e.node(o);if(i==n.index(o)&&o<e.depth-r.openStart){var a=t(e,n,r,o+1);return s.copy(s.content.replaceChild(i,a))}if(r.content.size){if(r.openStart||r.openEnd||e.depth!=o||n.depth!=o){var c=F(r,e),l=c.start;c=c.end;return P(s,H(e,l,c,n,o))}return l=e.parent,c=l.content,P(l,c.cut(0,e.parentOffset).append(r.content).append(c.cut(n.parentOffset)))}return P(s,$(e,n,o))}(t,e,n,0)}function V(t,e){if(!e.type.compatibleContent(t.type))throw new _("Cannot join "+e.type.name+" onto "+t.type.name)}function R(t,e,n){return t=t.node(n),V(t,e.node(n)),t}function L(t,e){var n=e.length-1;0<=n&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function B(t,e,n,r){var o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(L(t.nodeAfter,r),i++));for(var a=i;a<s;a++)L(o.child(a),r);e&&e.depth==n&&e.textOffset&&L(e.nodeBefore,r)}function P(t,e){if(!t.type.validContent(e))throw new _("Invalid content for node "+t.type.name);return t.copy(e)}function H(t,e,n,r,o){var i=t.depth>o&&R(t,e,o+1),s=r.depth>o&&R(n,r,o+1),a=[];return B(null,t,o,a),i&&s&&e.index(o)==n.index(o)?(V(i,s),L(P(i,H(t,e,n,r,o+1)),a)):(i&&L(P(i,$(t,e,o+1)),a),B(e,n,o,a),s&&L(P(s,$(n,r,o+1)),a)),B(r,null,o,a),new C(a)}function $(t,e,n){var r=[];return B(null,t,n,r),t.depth>n&&L(P(R(t,e,n+1),$(t,e,n+1)),r),B(e,null,n,r),new C(r)}function F(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),o=n-1;0<=o;o--)r=e.node(o).copy(C.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}function q(t,e,n){this.pos=t,this.path=e,this.depth=e.length/3-1,this.parentOffset=n}I.size.get=function(){return this.content.size-this.openStart-this.openEnd},j.prototype.insertAt=function(t,e){return e=function t(e,n,r,o){var i=e.findIndex(n),s=i.index,a=i.offset;return i=e.maybeChild(s),a==n||i.isText?o&&!o.canReplace(s,s,r)?null:e.cut(0,n).append(r).append(e.cut(n)):(r=t(i.content,n-a-1,r),r&&e.replaceChild(s,i.copy(r)))}(this.content,t+this.openStart,e,null),e&&new j(e,this.openStart,this.openEnd)},j.prototype.removeBetween=function(t,e){return new j(function t(e,n,r){var o=e.findIndex(n),i=o.index,s=o.offset,a=e.maybeChild(i),c=e.findIndex(r);if(o=c.index,c=c.offset,s==n||a.isText){if(c!=r&&!e.child(o).isText)throw new RangeError("Removing non-flat range");return e.cut(0,n).append(e.cut(r))}if(i!=o)throw new RangeError("Removing non-flat range");return e.replaceChild(i,a.copy(t(a.content,n-s-1,r-s-1)))}(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},j.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},j.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},j.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return 0<this.openStart&&(t.openStart=this.openStart),0<this.openEnd&&(t.openEnd=this.openEnd),t},j.fromJSON=function(t,e){if(!e)return j.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new j(C.fromJSON(t,e.content),n,r)},j.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)r++;return new j(t,n,r)},Object.defineProperties(j.prototype,I),j.empty=new j(C.empty,0,0),T={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}},q.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},T.parent.get=function(){return this.node(this.depth)},T.doc.get=function(){return this.node(0)},q.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},q.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},q.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},q.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},q.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},q.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},q.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},T.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},T.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},T.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},q.prototype.posAtIndex=function(t,e){e=this.resolveDepth(e);for(var n=this.path[3*e],r=0==e?0:this.path[3*e-1]+1,o=0;o<t;o++)r+=n.child(o).nodeSize;return r},q.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return D.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);n||(e=n,n=r,r=e);for(var o=n.marks,i=0;i<o.length;i++)!1!==o[i].type.spec.inclusive||r&&o[i].isInSet(r.marks)||(o=o[i--].removeFromSet(o));return o},q.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},q.prototype.sharedDepth=function(t){for(var e=this.depth;0<e;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},q.prototype.blockRange=function(t,e){if((t=void 0===t?this:t).pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);0<=n;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new U(this,t,n)},q.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},q.prototype.max=function(t){return t.pos>this.pos?t:this},q.prototype.min=function(t){return t.pos<this.pos?t:this},q.prototype.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},q.resolve=function(t,e){if(!(0<=e&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var n=[],r=0,o=e,i=t;;){var s=i.content.findIndex(o),a=s.index,c=s.offset;s=o-c;if(n.push(i,a,r+c),!s)break;if((i=i.child(a)).isText)break;o=s-1,r+=c+1}return new q(e,n,o)},q.resolveCached=function(t,e){for(var n=0;n<J.length;n++){var r=J[n];if(r.pos==e&&r.doc==t)return r}var o=J[W]=q.resolve(t,e);return W=(W+1)%K,o},Object.defineProperties(q.prototype,T);var J=[],W=0,K=12,U=function(t,e,n){this.$from=t,this.$to=e,this.depth=n};I={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};I.start.get=function(){return this.$from.before(this.depth+1)},I.end.get=function(){return this.$to.after(this.depth+1)},I.parent.get=function(){return this.$from.node(this.depth)},I.startIndex.get=function(){return this.$from.index(this.depth)},I.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(U.prototype,I);var G=Object.create(null),X=function(t,e,n,r){this.type=t,this.attrs=e,this.content=n||C.empty,this.marks=r||D.none};T={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};T.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},T.childCount.get=function(){return this.content.childCount},X.prototype.child=function(t){return this.content.child(t)},X.prototype.maybeChild=function(t){return this.content.maybeChild(t)},X.prototype.forEach=function(t){this.content.forEach(t)},X.prototype.nodesBetween=function(t,e,n,r){this.content.nodesBetween(t,e,n,r=void 0===r?0:r,this)},X.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},T.textContent.get=function(){return this.textBetween(0,this.content.size,"")},X.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},T.firstChild.get=function(){return this.content.firstChild},T.lastChild.get=function(){return this.content.lastChild},X.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},X.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},X.prototype.hasMarkup=function(t,e,n){return this.type==t&&E(this.attrs,e||t.defaultAttrs||G)&&D.sameSet(this.marks,n||D.none)},X.prototype.copy=function(t){return(t=void 0===t?null:t)==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},X.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},X.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},X.prototype.slice=function(t,e,n){if(void 0===n&&(n=!1),t==(e=void 0===e?this.content.size:e))return j.empty;var r=this.resolve(t);t=this.resolve(e),n=n?0:r.sharedDepth(e),e=r.start(n),e=r.node(n).content.cut(r.pos-e,t.pos-e);return new j(e,r.depth-n,t.depth-n)},X.prototype.replace=function(t,e,n){return z(this.resolve(t),this.resolve(e),n)},X.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index;n=n.offset;if(!(e=e.maybeChild(r)))return null;if(n==t||e.isText)return e;t-=n+1}},X.prototype.childAfter=function(t){var e=this.content.findIndex(t);t=e.index,e=e.offset;return{node:this.content.maybeChild(t),index:t,offset:e}},X.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index;e=e.offset;return e<t?{node:this.content.child(n),index:n,offset:e}:(t=this.content.child(n-1),{node:t,index:n-1,offset:e-t.nodeSize})},X.prototype.resolve=function(t){return q.resolveCached(this,t)},X.prototype.resolveNoCache=function(t){return q.resolve(this,t)},X.prototype.rangeHasMark=function(t,e,n){var r=!1;return t<e&&this.nodesBetween(t,e,(function(t){return!(r=!!n.isInSet(t.marks)||r)})),r},T.isBlock.get=function(){return this.type.isBlock},T.isTextblock.get=function(){return this.type.isTextblock},T.inlineContent.get=function(){return this.type.inlineContent},T.isInline.get=function(){return this.type.isInline},T.isText.get=function(){return this.type.isText},T.isLeaf.get=function(){return this.type.isLeaf},T.isAtom.get=function(){return this.type.isAtom},X.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),Q(this.marks,t)},X.prototype.contentMatchAt=function(t){if(t=this.type.contentMatch.matchFragment(this.content,0,t),!t)throw new Error("Called contentMatchAt on a node with invalid content");return t},X.prototype.canReplace=function(t,e,n,r,o){if(void 0===n&&(n=C.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount),t=this.contentMatchAt(t).matchFragment(n,r,o),e=t&&t.matchFragment(this.content,e),!e||!e.validEnd)return!1;for(var i=r;i<o;i++)if(!this.type.allowsMarks(n.child(i).marks))return!1;return!0},X.prototype.canReplaceWith=function(t,e,n,r){return!(r&&!this.type.allowsMarks(r))&&(n=this.contentMatchAt(t).matchType(n),e=n&&n.matchFragment(this.content,e),!!e&&e.validEnd)},X.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},X.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));for(var t=D.none,e=0;e<this.marks.length;e++)t=this.marks[e].addToSet(t);if(!D.sameSet(t,this.marks))throw new RangeError("Invalid collection of marks for node "+this.type.name+": "+this.marks.map((function(t){return t.type.name})));this.content.forEach((function(t){return t.check()}))},X.prototype.toJSON=function(){var t,e={type:this.type.name};for(t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map((function(t){return t.toJSON()}))),e},X.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=C.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,r,n)},Object.defineProperties(X.prototype,T);var Y=function(t){function e(e,n,r,o){if(t.call(this,e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}t&&(e.__proto__=t);var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Q(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},e.prototype.cut=function(t,e){return void 0===e&&(e=this.text.length),0==(t=void 0===t?0:t)&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},Object.defineProperties(e.prototype,n),e}(X);function Q(t,e){for(var n=t.length-1;0<=n;n--)e=t[n].type.name+"("+e+")";return e}function Z(t){this.validEnd=t,this.next=[],this.wrapCache=[]}I={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}},Z.parse=function(t,e){if(t=new tt(t,e),null==t.next)return Z.empty;e=et(t),t.next&&t.err("Unexpected trailing text");var n,r,o;o=[[]],a(function t(e,n){if("choice"==e.type)return e.exprs.reduce((function(e,r){return e.concat(t(r,n))}),[]);if("seq"!=e.type){if("star"==e.type){var r=i();return s(n,r),a(t(e.expr,r),r),[s(r)]}if("plus"==e.type)return r=i(),a(t(e.expr,n),r),a(t(e.expr,r),r),[s(r)];if("opt"==e.type)return[s(n)].concat(t(e.expr,n));if("range"!=e.type)return"name"==e.type?[s(n,null,e.value)]:void 0;for(var o=n,c=0;c<e.min;c++){var l=i();a(t(e.expr,o),l),o=l}if(-1==e.max)a(t(e.expr,o),o);else for(var p=e.min;p<e.max;p++){var d=i();s(o,d),a(t(e.expr,o),d),o=d}return[s(o)]}for(var u=0;;u++){var h=t(e.exprs[u],n);if(u==e.exprs.length-1)return h;a(h,n=i())}}(e,0),i()),n=o,r=Object.create(null),e=function t(e){var o=[];e.forEach((function(t){n[t].forEach((function(t){var e,r=t.term,i=t.to;r&&(t=o.indexOf(r),e=-1<t&&o[t+1],ot(n,i).forEach((function(t){e||o.push(r,e=[]),-1==e.indexOf(t)&&e.push(t)})))}))}));for(var i=r[e.join(",")]=new Z(-1<e.indexOf(n.length-1)),s=0;s<o.length;s+=2){var a=o[s+1].sort(rt);i.next.push(o[s],r[a.join(",")]||t(a))}return i}(ot(n,0));function i(){return o.push([])-1}function s(t,e,n){return e={term:n,to:e},o[t].push(e),e}function a(t,e){t.forEach((function(t){return t.to=e}))}return function(t,e){for(var n=0,r=[t];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],l=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(l)&&r.push(l)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(e,t),e},Z.prototype.matchType=function(t){for(var e=0;e<this.next.length;e+=2)if(this.next[e]==t)return this.next[e+1];return null},Z.prototype.matchFragment=function(t,e,n){void 0===n&&(n=t.childCount);for(var r=this,o=e=void 0===e?0:e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r},I.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},I.defaultType.get=function(){for(var t=0;t<this.next.length;t+=2){var e=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}},Z.prototype.compatible=function(t){for(var e=0;e<this.next.length;e+=2)for(var n=0;n<t.next.length;n+=2)if(this.next[e]==t.next[n])return!0;return!1},Z.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function o(i,s){var a=i.matchFragment(t,n);if(a&&(!e||a.validEnd))return C.from(s.map((function(t){return t.createAndFill()})));for(var c=0;c<i.next.length;c+=2){var l=i.next[c],p=i.next[c+1];if(!l.isText&&!l.hasRequiredAttrs()&&-1==r.indexOf(p)&&(r.push(p),l=o(p,s.concat(l))))return l}}(this,[])},Z.prototype.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},Z.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}},I.edgeCount.get=function(){return this.next.length>>1},Z.prototype.edge=function(t){var e=t<<1;if(e>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[e],next:this.next[1+e]}},Z.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)-1==t.indexOf(n.next[r])&&e(n.next[r])}(this),t.map((function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o+=2)r+=(o?", ":"")+e.next[o].name+"->"+t.indexOf(e.next[o+1]);return r})).join("\n")},Object.defineProperties(Z.prototype,I),Z.empty=new Z(!0);var tt=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()};T={next:{configurable:!0}};function et(t){for(var e=[];e.push(function(t){for(var e=[];e.push(function(t){for(var e=function(t){if(t.eat("(")){var e=et(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next))return e=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o,i=[];for(o in n){var s=n[o];-1<s.groups.indexOf(e)&&i.push(s)}return 0==i.length&&t.err("No node type or group '"+e+"' found"),i}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}})),t.pos++,1==e.length?e[0]:{type:"choice",exprs:e};t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=function(t,e){var n=nt(t),r=n;return t.eat(",")&&(r="}"!=t.next?nt(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}(t,e)}return e}(t)),t.next&&")"!=t.next&&"|"!=t.next;);return 1==e.length?e[0]:{type:"seq",exprs:e}}(t)),t.eat("|"););return 1==e.length?e[0]:{type:"choice",exprs:e}}function nt(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function rt(t,e){return e-t}function ot(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term;s=s.to;a||-1!=n.indexOf(s)||e(s)}}(e),n.sort(rt)}function it(t){var e,n=Object.create(null);for(e in t){var r=t[e];if(!r.hasDefault)return null;n[e]=r.default}return n}function st(t,e){var n,r=Object.create(null);for(n in t){var o=e&&e[n];if(void 0===o){var i=t[n];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+n);o=i.default}r[n]=o}return r}function at(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new lt(t[n]);return e}function ct(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=at(n.attrs),this.defaultAttrs=it(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t}T.next.get=function(){return this.tokens[this.pos]},tt.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},tt.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(tt.prototype,T),I={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}},I.isInline.get=function(){return!this.isBlock},I.isTextblock.get=function(){return this.isBlock&&this.inlineContent},I.isLeaf.get=function(){return this.contentMatch==Z.empty},I.isAtom.get=function(){return this.isLeaf||this.spec.atom},ct.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},ct.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},ct.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:st(this.attrs,t)},ct.prototype.create=function(t,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new X(this,this.computeAttrs(t),C.from(e),D.setFrom(n))},ct.prototype.createChecked=function(t,e,n){if(e=C.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new X(this,this.computeAttrs(t),e,D.setFrom(n))},ct.prototype.createAndFill=function(t,e,n){if(t=this.computeAttrs(t),(e=C.from(e)).size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}return r=this.contentMatch.matchFragment(e).fillBefore(C.empty,!0),r?new X(this,t,e.append(r),D.setFrom(n)):null},ct.prototype.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},ct.prototype.allowsMarkType=function(t){return null==this.markSet||-1<this.markSet.indexOf(t)},ct.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},ct.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e=e||t.slice(0,n);return e?e.length?e:D.empty:t},ct.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new ct(t,e,r)}));var r;t=e.spec.topNode||"doc";if(!n[t])throw new RangeError("Schema is missing its top node type ('"+t+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(r in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(ct.prototype,I);var lt=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default};T={isRequired:{configurable:!0}};function pt(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=at(r.attrs),this.rank=e,this.excluded=null,e=it(this.attrs),this.instance=e&&new D(this,e)}T.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(lt.prototype,T),pt.prototype.create=function(t){return!t&&this.instance?this.instance:new D(this,st(this.attrs,t))},pt.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new pt(t,r++,e,o)})),n},pt.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)t[e].type==this&&(t=t.slice(0,e).concat(t.slice(e+1)),e--);return t},pt.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},pt.prototype.excludes=function(t){return-1<this.excluded.indexOf(t)};var dt=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=S.from(t.nodes),this.spec.marks=S.from(t.marks),this.nodes=ct.compile(this.spec.nodes,this),this.marks=pt.compile(this.spec.marks,this);var n,r,o=Object.create(null);for(n in this.nodes){if(n in this.marks)throw new RangeError(n+" can not be both a node and a mark");var i=this.nodes[n],s=i.spec.content||"",a=i.spec.marks;i.contentMatch=o[s]||(o[s]=Z.parse(s,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.markSet="_"==a?null:a?ut(this,a.split(" ")):""!=a&&i.inlineContent?null:[]}for(r in this.marks){var c=this.marks[r],l=c.spec.excludes;c.excluded=null==l?[c]:""==l?[]:ut(this,l.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function ut(t,e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(var a in t.marks)a=t.marks[a],("_"==o||a.spec.group&&-1<a.spec.group.split(" ").indexOf(o))&&n.push(s=a);if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}dt.prototype.node=function(t,e,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof ct))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},dt.prototype.text=function(t,e){var n=this.nodes.text;return new Y(n,n.defaultAttrs,t,D.setFrom(e))},dt.prototype.mark=function(t,e){return(t="string"==typeof t?this.marks[t]:t).create(e)},dt.prototype.nodeFromJSON=function(t){return X.fromJSON(this,t)},dt.prototype.markFromJSON=function(t){return D.fromJSON(this,t)},dt.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var ht=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)})),this.normalizeLists=!this.tags.some((function(e){return!(!/^(ul|ol)\b/.test(e.tag)||!e.node)&&(e=t.nodes[e.node],e.contentMatch.matchType(e))}))};ht.prototype.parse=function(t,e){var n=new bt(this,e=void 0===e?{}:e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},ht.prototype.parseSlice=function(t,e){var n=new bt(this,e=void 0===e?{}:e,!0);return n.addAll(t,null,e.from,e.to),j.maxOpen(n.finish())},ht.prototype.matchTag=function(t,e,n){for(var r,o=n?this.tags.indexOf(n)+1:0;o<this.tags.length;o++){var i=this.tags[o];if(r=t,s=i.tag,(r.matches||r.msMatchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector).call(r,s)&&(void 0===i.namespace||t.namespaceURI==i.namespace)&&(!i.context||e.matchesContext(i.context))){if(i.getAttrs){var s=i.getAttrs(t);if(!1===s)continue;i.attrs=s}return i}}},ht.prototype.matchStyle=function(t,e,n,r){for(var o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){var i=this.styles[o];if(!(0!=i.style.indexOf(t)||i.context&&!n.matchesContext(i.context)||i.style.length>t.length&&(61!=i.style.charCodeAt(t.length)||i.style.slice(t.length+1)!=e))){if(i.getAttrs){var s=i.getAttrs(e);if(!1===s)continue;i.attrs=s}return i}}},ht.schemaRules=function(t){var e,n,r=[];function o(t){for(var e=null==t.priority?50:t.priority,n=0;n<r.length;n++){var o=r[n];if((null==o.priority?50:o.priority)<e)break}r.splice(n,0,t)}for(var i in t.marks)!function(e){var n=t.marks[e].spec.parseDOM;n&&n.forEach((function(t){o(t=wt(t)),t.mark=e}))}(i);for(e in t.nodes)n=void 0,n=t.nodes[e].spec.parseDOM,n&&n.forEach((function(t){o(t=wt(t)),t.node=e}));return r},ht.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new ht(t,ht.schemaRules(t)))};var ft={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},mt={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},vt={ol:!0,ul:!0};function gt(t){return(t?1:0)|("full"===t?2:0)}function yt(t,e,n,r,o,i,s){this.type=t,this.attrs=e,this.solid=o,this.match=i||(4&s?null:t.contentMatch),this.options=s,this.content=[],this.marks=n,this.activeMarks=D.none,this.pendingMarks=r,this.stashMarks=[]}yt.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(C.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},yt.prototype.finish=function(t){var e;1&this.options||(e=this.content[this.content.length-1])&&e.isText&&(n=/[ \t\r\n\u000c]+$/.exec(e.text))&&(e.text.length==n[0].length?this.content.pop():this.content[this.content.length-1]=e.withText(e.text.slice(0,e.text.length-n[0].length)));var n=C.from(this.content);return!t&&this.match&&(n=n.append(this.match.fillBefore(C.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n},yt.prototype.popFromStashMark=function(t){for(var e=this.stashMarks.length-1;0<=e;e--)if(t.eq(this.stashMarks[e]))return this.stashMarks.splice(e,1)[0]},yt.prototype.applyPending=function(t){for(var e=0,n=this.pendingMarks;e<n.length;e++){var r=n[e];(this.type?this.type.allowsMarkType(r.type):function(t,e){var n,r=e.schema.nodes;for(n in r){var o=function(n){if(n=r[n],n.allowsMarkType(t)){var o=[],i=function(t){o.push(t);for(var n=0;n<t.edgeCount;n++){var r=t.edge(n),s=r.type;r=r.next;if(s==e)return!0;if(o.indexOf(r)<0&&i(r))return!0}};return i(n.contentMatch)?{v:!0}:void 0}}(n);if(o)return o.v}}(r.type,t))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}},yt.prototype.inlineContext=function(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!ft.hasOwnProperty(t.parentNode.nodeName.toLowerCase())};var bt=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n;var r=e.topNode,o=gt(e.preserveWhitespace)|(n?4:0);o=r?new yt(r.type,r.attrs,D.none,D.none,!0,e.topMatch||r.type.contentMatch,o):new yt(n?null:t.schema.topNodeType,null,D.none,D.none,!0,null,o);this.nodes=[o],this.open=0,this.find=e.findPositions,this.needsBlock=!1};I={top:{configurable:!0},currentPos:{configurable:!0}};function wt(t){var e,n={};for(e in t)n[e]=t[e];return n}I.top.get=function(){return this.nodes[this.open]},bt.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var e=t.getAttribute("style"),n=e?this.readStyles(function(t){for(var e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];e=n.exec(t);)r.push(e[1],e[2].trim());return r}(e)):null,r=this.top;if(null!=n)for(var o=0;o<n.length;o++)this.addPendingMark(n[o]);if(this.addElement(t),null!=n)for(var i=0;i<n.length;i++)this.removePendingMark(n[i],r)}},bt.prototype.addTextNode=function(t){var e,n=t.nodeValue,r=this.top;2&r.options||r.inlineContext(t)||/[^ \t\r\n\u000c]/.test(n)?(1&r.options?n=2&r.options?n.replace(/\r\n?/g,"\n"):n.replace(/\r?\n|\r/g," "):(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1&&(e=r.content[r.content.length-1],r=t.previousSibling,(!e||r&&"BR"==r.nodeName||e.isText&&/[ \t\r\n\u000c]$/.test(e.text))&&(n=n.slice(1)))),n&&this.insertNode(this.parser.schema.text(n)),this.findInText(t)):this.findInside(t)},bt.prototype.addElement=function(t,e){var n,r=t.nodeName.toLowerCase();vt.hasOwnProperty(r)&&this.parser.normalizeLists&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&vt.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var o=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(n=this.parser.matchTag(t,this,e));if(o?o.ignore:mt.hasOwnProperty(r))this.findInside(t),this.ignoreFallback(t);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(t=o.skip);var i,s=this.top;e=this.needsBlock;if(ft.hasOwnProperty(r))i=!0,s.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),i&&this.sync(s),this.needsBlock=e}else this.addElementByRule(t,o,!1===o.consuming?n:null)},bt.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},bt.prototype.ignoreFallback=function(t){"BR"!=t.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"))},bt.prototype.readStyles=function(t){var e=D.none;t:for(var n=0;n<t.length;n+=2)for(var r=null;;){var o=this.parser.matchStyle(t[n],t[n+1],this,r);if(!o)continue t;if(o.ignore)return null;if(e=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(e),!1!==o.consuming)break;r=o}return e},bt.prototype.addElementByRule=function(t,e,n){var r,o,i,s=this;e.node?(o=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(o.create(e.attrs))||this.leafFallback(t):r=this.enter(o,e.attrs,e.preserveWhitespace):(i=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(i));var a=this.top;o&&o.isLeaf?this.findInside(t):n?this.addElement(t,n):e.getContent?(this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return s.insertNode(t)}))):("string"==typeof(e=e.contentElement)?e=t.querySelector(e):"function"==typeof e&&(e=e(t)),this.findAround(t,e=e||t,!0),this.addAll(e,r)),r&&(this.sync(a),this.open--),i&&this.removePendingMark(i,a)},bt.prototype.addAll=function(t,e,n,r){for(var o=n||0,i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i),e&&ft.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},bt.prototype.findPlace=function(t){for(var e,n,r=this.open;0<=r;r--){var o=this.nodes[r],i=o.findWrapping(t);if(i&&(!e||e.length>i.length)&&(n=o,!(e=i).length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var s=0;s<e.length;s++)this.enterInner(e[s],null,!1);return!0},bt.prototype.insertNode=function(t){var e;if(!t.isInline||!this.needsBlock||this.top.type||(e=this.textblockFromContext())&&this.enterInner(e),this.findPlace(t)){this.closeExtra();var n=this.top;n.applyPending(t.type),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,o=0;o<t.marks.length;o++)n.type&&!n.type.allowsMarkType(t.marks[o].type)||(r=t.marks[o].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},bt.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&this.enterInner(t,e,!0,n),r},bt.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.applyPending(t),o.match=o.match&&o.match.matchType(t,e),r=null==r?-5&o.options:gt(r),4&o.options&&0==o.content.length&&(r|=4),this.nodes.push(new yt(t,e,o.activeMarks,o.pendingMarks,n,null,r)),this.open++},bt.prototype.closeExtra=function(t){var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},bt.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},bt.prototype.sync=function(t){for(var e=this.open;0<=e;e--)if(this.nodes[e]==t)return void(this.open=e)},I.currentPos.get=function(){this.closeExtra();for(var t=0,e=this.open;0<=e;e--){for(var n=this.nodes[e].content,r=n.length-1;0<=r;r--)t+=n[r].nodeSize;e&&t++}return t},bt.prototype.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},bt.prototype.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},bt.prototype.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++)null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node)&&e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)},bt.prototype.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},bt.prototype.matchesContext=function(t){var e=this;if(-1<t.indexOf("|"))return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,o=!(this.isOpen||r&&r.parent.type!=this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1),s=function(t,a){for(;0<=t;t--){var c=n[t];if(""==c){if(t!=n.length-1&&0!=t){for(;i<=a;a--)if(s(t-1,a))return!0;return!1}}else{var l=0<a||0==a&&o?e.nodes[a].type:r&&i<=a?r.node(a-i).type:null;if(!l||l.name!=c&&-1==l.groups.indexOf(c))return!1;a--}}return!0};return s(n.length-1,this.open)},bt.prototype.textblockFromContext=function(){var t,e=this.options.context;if(e)for(var n=e.depth;0<=n;n--){var r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(t in this.parser.schema.nodes){var o=this.parser.schema.nodes[t];if(o.isTextblock&&o.defaultAttrs)return o}},bt.prototype.addPendingMark=function(t){var e=function(t,e){for(var n=0;n<e.length;n++)if(t.eq(e[n]))return e[n]}(t,this.top.pendingMarks);e&&this.top.stashMarks.push(e),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)},bt.prototype.removePendingMark=function(t,e){for(var n=this.open;0<=n;n--){var r,o=this.nodes[n];if(-1<o.pendingMarks.lastIndexOf(t)?o.pendingMarks=t.removeFromSet(o.pendingMarks):(o.activeMarks=t.removeFromSet(o.activeMarks),(r=o.popFromStashMark(t))&&o.type&&o.type.allowsMarkType(r.type)&&(o.activeMarks=r.addToSet(o.activeMarks))),o==e)break}},Object.defineProperties(bt.prototype,I);var kt=function(t,e){this.nodes=t||{},this.marks=e||{}};function Ot(t){var e,n={};for(e in t){var r=t[e].spec.toDOM;r&&(n[e]=r)}return n}function xt(t){return t.document||window.document}kt.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={});var o=n=n||xt(e).createDocumentFragment(),i=null;return t.forEach((function(t){if(i||t.marks.length){i=i||[];for(var n=0,s=0;n<i.length&&s<t.marks.length;){var a=t.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<t.marks.length;){var c=t.marks[s++],l=r.serializeMark(c,t.isInline,e);l&&(i.push(c,o),o.appendChild(l.dom),o=l.contentDOM||l.dom)}}o.appendChild(r.serializeNodeInner(t,e))})),n},kt.prototype.serializeNodeInner=function(t,e){var n=kt.renderSpec(xt(e=void 0===e?{}:e),this.nodes[t.type.name](t)),r=n.dom;n=n.contentDOM;if(n){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,n,e):this.serializeFragment(t.content,e,n)}return r},kt.prototype.serializeNode=function(t,e){for(var n=this.serializeNodeInner(t,e=void 0===e?{}:e),r=t.marks.length-1;0<=r;r--){var o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},kt.prototype.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&kt.renderSpec(xt(n),r(t,e))},kt.renderSpec=function(t,e,n){if(void 0===n&&(n=null),"string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};if(e.dom&&null!=e.dom.nodeType)return e;var r=e[0],o=r.indexOf(" ");0<o&&(n=r.slice(0,o),r=r.slice(o+1));var i,s=null,a=n?t.createElementNS(n,r):t.createElement(r),c=e[1],l=1;if(c&&"object"==typeof c&&null==c.nodeType&&!Array.isArray(c))for(var p in l=2,c)null!=c[p]&&(0<(i=p.indexOf(" "))?a.setAttributeNS(p.slice(0,i),p.slice(i+1),c[p]):a.setAttribute(p,c[p]));for(var d=l;d<e.length;d++){var u=e[d];if(0===u){if(d<e.length-1||l<d)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}var h=kt.renderSpec(t,u,n);u=h.dom,h=h.contentDOM;if(a.appendChild(u),h){if(s)throw new RangeError("Multiple content holes");s=h}}return{dom:a,contentDOM:s}},kt.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new kt(this.nodesFromSchema(t),this.marksFromSchema(t)))},kt.nodesFromSchema=function(t){return t=Ot(t.nodes),t.text||(t.text=function(t){return t.text}),t},kt.marksFromSchema=function(t){return Ot(t.marks)};var Mt=Math.pow(2,16);function St(t){return 65535&t}function Ct(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=null),this.pos=t,this.deleted=e,this.recover=n}function Tt(t,e){void 0===e&&(e=!1),this.ranges=t,this.inverted=e}function Nt(t,e,n,r){this.maps=t||[],this.from=n||0,this.to=null==r?this.maps.length:r,this.mirror=e}function At(t){return t=Error.call(this,t),t.__proto__=At.prototype,t}function Et(){throw new Error("Override me")}Tt.prototype.recover=function(t){var e=0,n=St(t);if(!this.inverted)for(var r=0;r<n;r++)e+=this.ranges[3*r+2]-this.ranges[3*r+1];return this.ranges[3*n]+e+(t-(65535&t))/Mt},Tt.prototype.mapResult=function(t,e){return this._map(t,e=void 0===e?1:e,!1)},Tt.prototype.map=function(t,e){return this._map(t,e=void 0===e?1:e,!0)},Tt.prototype._map=function(t,e,n){for(var r=0,o=this.inverted?2:1,i=this.inverted?1:2,s=0;s<this.ranges.length;s+=3){var a=this.ranges[s]-(this.inverted?r:0);if(t<a)break;var c=this.ranges[s+o],l=this.ranges[s+i],p=a+c;if(t<=p){var d=a+r+((c?t==a?-1:t==p?1:e:e)<0?0:l);return n?d:new Ct(d,e<0?t!=a:t!=p,t==(e<0?a:p)?null:s/3+(t-a)*Mt)}r+=l-c}return n?t+r:new Ct(t+r)},Tt.prototype.touches=function(t,e){for(var n=0,r=St(e),o=this.inverted?2:1,i=this.inverted?1:2,s=0;s<this.ranges.length;s+=3){var a=this.ranges[s]-(this.inverted?n:0);if(t<a)break;var c=this.ranges[s+o];if(t<=a+c&&s==3*r)return!0;n+=this.ranges[s+i]-c}return!1},Tt.prototype.forEach=function(t){for(var e=this.inverted?2:1,n=this.inverted?1:2,r=0,o=0;r<this.ranges.length;r+=3){var i=this.ranges[r],s=i-(this.inverted?o:0),a=i+(this.inverted?0:o),c=this.ranges[r+e];i=this.ranges[r+n];t(s,s+c,a,a+i),o+=i-c}},Tt.prototype.invert=function(){return new Tt(this.ranges,!this.inverted)},Tt.prototype.toString=function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)},Tt.offset=function(t){return 0==t?Tt.empty:new Tt(t<0?[0,-t,0]:[0,0,t])},Tt.empty=new Tt([]),Nt.prototype.slice=function(t,e){return void 0===e&&(e=this.maps.length),new Nt(this.maps,this.mirror,t=void 0===t?0:t,e)},Nt.prototype.copy=function(){return new Nt(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)},Nt.prototype.appendMap=function(t,e){this.to=this.maps.push(t),null!=e&&this.setMirror(this.maps.length-1,e)},Nt.prototype.appendMapping=function(t){for(var e=0,n=this.maps.length;e<t.maps.length;e++){var r=t.getMirror(e);this.appendMap(t.maps[e],null!=r&&r<e?n+r:null)}},Nt.prototype.getMirror=function(t){if(this.mirror)for(var e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)]},Nt.prototype.setMirror=function(t,e){this.mirror||(this.mirror=[]),this.mirror.push(t,e)},Nt.prototype.appendMappingInverted=function(t){for(var e=t.maps.length-1,n=this.maps.length+t.maps.length;0<=e;e--){var r=t.getMirror(e);this.appendMap(t.maps[e].invert(),null!=r&&e<r?n-r-1:null)}},Nt.prototype.invert=function(){var t=new Nt;return t.appendMappingInverted(this),t},Nt.prototype.map=function(t,e){if(void 0===e&&(e=1),this.mirror)return this._map(t,e,!0);for(var n=this.from;n<this.to;n++)t=this.maps[n].map(t,e);return t},Nt.prototype.mapResult=function(t,e){return this._map(t,e=void 0===e?1:e,!1)},Nt.prototype._map=function(t,e,n){for(var r=!1,o=this.from;o<this.to;o++){var i=this.maps[o].mapResult(t,e);if(null!=i.recover){var s=this.getMirror(o);if(null!=s&&o<s&&s<this.to){t=this.maps[o=s].recover(i.recover);continue}}i.deleted&&(r=!0),t=i.pos}return n?t:new Ct(t,r)},((At.prototype=Object.create(Error.prototype)).constructor=At).prototype.name="TransformError",T=function(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new Nt},I={before:{configurable:!0},docChanged:{configurable:!0}},I.before.get=function(){return this.docs.length?this.docs[0]:this.doc},T.prototype.step=function(t){if(t=this.maybeStep(t),t.failed)throw new At(t.failed);return this},T.prototype.maybeStep=function(t){var e=t.apply(this.doc);return e.failed||this.addStep(t,e.doc),e},I.docChanged.get=function(){return 0<this.steps.length},T.prototype.addStep=function(t,e){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=e},Object.defineProperties(T.prototype,I);var Dt=Object.create(null);I=function(){};function _t(t,e){this.doc=t,this.failed=e}I.prototype.apply=Et,I.prototype.getMap=function(){return Tt.empty},I.prototype.invert=function(t){return Et()},I.prototype.map=function(t){return Et()},I.prototype.merge=function(t){return null},I.prototype.toJSON=function(){return Et()},I.fromJSON=function(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");var n=Dt[e.stepType];if(!n)throw new RangeError("No step type "+e.stepType+" defined");return n.fromJSON(t,e)},I.jsonID=function(t,e){if(t in Dt)throw new RangeError("Duplicate use of step JSON ID "+t);return(Dt[t]=e).prototype.jsonID=t,e},_t.ok=function(t){return new _t(t,null)},_t.fail=function(t){return new _t(null,t)},_t.fromReplace=function(t,e,n,r){try{return _t.ok(t.replace(e,n,r))}catch(t){if(t instanceof _)return _t.fail(t.message);throw t}};var jt=function(t){function e(e,n,r,o){t.call(this),this.from=e,this.to=n,this.slice=r,this.structure=!!o}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.apply=function(t){return this.structure&&zt(t,this.from,this.to)?_t.fail("Structure replace would overwrite content"):_t.fromReplace(t,this.from,this.to,this.slice)},e.prototype.getMap=function(){return new Tt([this.from,this.to-this.from,this.slice.size])},e.prototype.invert=function(t){return new e(this.from,this.from+this.slice.size,t.slice(this.from,this.to))},e.prototype.map=function(t){var n=t.mapResult(this.from,1);t=t.mapResult(this.to,-1);return n.deleted&&t.deleted?null:new e(n.pos,Math.max(n.pos,t.pos),this.slice)},e.prototype.merge=function(t){if(!(t instanceof e)||t.structure||this.structure)return null;if(this.from+this.slice.size!=t.from||this.slice.openEnd||t.slice.openStart){if(t.to!=this.from||this.slice.openStart||t.slice.openEnd)return null;var n=this.slice.size+t.slice.size==0?j.empty:new j(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new e(t.from,this.to,n,this.structure)}return n=this.slice.size+t.slice.size==0?j.empty:new j(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd),new e(this.from,this.to+(t.to-t.from),n,this.structure)},e.prototype.toJSON=function(){var t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new e(n.from,n.to,j.fromJSON(t,n.slice),!!n.structure)},e}(I);I.jsonID("replace",jt);var It=function(t){function e(e,n,r,o,i,s,a){t.call(this),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=o,this.slice=i,this.insert=s,this.structure=!!a}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.apply=function(t){if(this.structure&&(zt(t,this.from,this.gapFrom)||zt(t,this.gapTo,this.to)))return _t.fail("Structure gap-replace would overwrite content");var e=t.slice(this.gapFrom,this.gapTo);return e.openStart||e.openEnd?_t.fail("Gap is not a flat range"):(e=this.slice.insertAt(this.insert,e.content),e?_t.fromReplace(t,this.from,this.to,e):_t.fail("Content does not fit in gap"))},e.prototype.getMap=function(){return new Tt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])},e.prototype.invert=function(t){var n=this.gapTo-this.gapFrom;return new e(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1),o=t.map(this.gapFrom,-1);t=t.map(this.gapTo,1);return n.deleted&&r.deleted||o<n.pos||t>r.pos?null:new e(n.pos,r.pos,o,t,this.slice,this.insert,this.structure)},e.prototype.toJSON=function(){var t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to||"number"!=typeof n.gapFrom||"number"!=typeof n.gapTo||"number"!=typeof n.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new e(n.from,n.to,n.gapFrom,n.gapTo,j.fromJSON(t,n.slice),n.insert,!!n.structure)},e}(I);function zt(t,e,n){for(var r=t.resolve(e),o=n-e,i=r.depth;0<o&&0<i&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(0<o)for(var s=r.node(i).maybeChild(r.indexAfter(i));0<o;){if(!s||s.isLeaf)return 1;s=s.firstChild,o--}}function Vt(t){for(var e=t.parent.content.cutByIndex(t.startIndex,t.endIndex),n=t.depth;;--n){var r=t.$from.node(n),o=t.$from.index(n),i=t.$to.indexAfter(n);if(n<t.depth&&r.canReplace(o,i,e))return n;if(0==n||r.type.spec.isolating||(r=r,i=i,0!=(o=o)&&!r.canReplace(o,r.childCount)||i!=r.childCount&&!r.canReplace(0,i)))break}}function Rt(t,e,n,r){return void 0===r&&(r=t),t=function(t,e){var n=t.parent,r=t.startIndex,o=t.endIndex;t=n.contentMatchAt(r).findWrapping(e);return t?(e=t.length?t[0]:e,n.canReplaceWith(r,o,e)?t:null):null}(t,e),r=t&&function(t,e){var n=t.parent,r=t.startIndex,o=t.endIndex;t=n.child(r),t=e.contentMatch.findWrapping(t.type);if(!t)return null;for(var i=(t.length?t[t.length-1]:e).contentMatch,s=r;i&&s<o;s++)i=i.matchType(n.child(s).type);return i&&i.validEnd?t:null}(r,e),r?t.map(Lt).concat({type:e,attrs:n}).concat(r.map(Lt)):null}function Lt(t){return{type:t,attrs:null}}function Bt(t,e,n,r){void 0===n&&(n=1);var o=t.resolve(e),i=o.depth-n;e=r&&r[r.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!e.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(var s=o.depth-1,a=n-2;i<s;s--,a--){var c=o.node(s),l=o.index(s);if(c.type.spec.isolating)return!1;var p=c.content.cutByIndex(l,c.childCount),d=r&&r[a]||c;if(d!=c&&(p=p.replaceChild(0,d.type.create(d.attrs))),!c.canReplace(l+1,c.childCount)||!d.type.validContent(p))return!1}return e=o.indexAfter(i),n=r&&r[0],o.node(i).canReplaceWith(e,e,(n||o.node(1+i)).type)}function Pt(t,e){return t=t.resolve(e),e=t.index(),Ht(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(e,e+1)}function Ht(t,e){return t&&e&&!t.isLeaf&&t.canAppend(e)}function $t(t,e,n){var r=t.resolve(e);if(!n.content.size)return e;for(var o=n.content,i=0;i<n.openStart;i++)o=o.firstChild.content;for(var s=1;s<=(0==n.openStart&&n.size?2:1);s++)for(var a=r.depth;0<=a;a--){var c,l=a==r.depth?0:r.pos<=(r.start(a+1)+r.end(a+1))/2?-1:1,p=r.index(a)+(0<l?1:0),d=r.node(a);if(1==s?d.canReplace(p,p,o):(c=d.contentMatchAt(p).findWrapping(o.firstChild.type))&&d.canReplaceWith(p,p,c[0]))return 0==l?r.pos:l<0?r.before(a+1):r.after(a+1)}return null}function Ft(t,e,n){for(var r=[],o=0;o<t.childCount;o++){var i=t.child(o);(i=i.content.size?i.copy(Ft(i.content,e,i)):i).isInline&&(i=e(i,n,o)),r.push(i)}return C.fromArray(r)}I.jsonID("replaceAround",It),T.prototype.lift=function(t,e){for(var n=t.$from,r=t.$to,o=t.depth,i=n.before(o+1),s=(t=r.after(o+1),i),a=t,c=C.empty,l=0,p=o,d=!1;e<p;p--)d||0<n.index(p)?(d=!0,c=C.from(n.node(p).copy(c)),l++):s--;for(var u=C.empty,h=0,f=o,m=!1;e<f;f--)m||r.after(f+1)<r.end(f)?(m=!0,u=C.from(r.node(f).copy(u)),h++):a++;return this.step(new It(s,a,i,t,new j(c.append(u),l,h),c.size-l,!0))},T.prototype.wrap=function(t,e){for(var n=C.empty,r=e.length-1;0<=r;r--)n=C.from(e[r].type.create(e[r].attrs,n));var o=t.start;t=t.end;return this.step(new It(o,t,o,t,new j(n,0,0),e.length,!0))},T.prototype.setBlockType=function(t,e,n,r){var o=this;if(void 0===e&&(e=t),!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var i=this.steps.length;return this.doc.nodesBetween(t,e,(function(t,e){if(t.isTextblock&&!t.hasMarkup(n,r)&&function(t,e,n){return t=t.resolve(e),e=t.index(),t.parent.canReplaceWith(e,e+1,n)}(o.doc,o.mapping.slice(i).map(e),n)){o.clearIncompatible(o.mapping.slice(i).map(e,1),n);var s=o.mapping.slice(i),a=s.map(e,1);e=s.map(e+t.nodeSize,1);return o.step(new It(a,e,a+1,e-1,new j(C.from(n.create(r,null,t.marks)),0,0),1,!0)),!1}})),this},T.prototype.setNodeMarkup=function(t,e,n,r){var o=this.doc.nodeAt(t);if(!o)throw new RangeError("No node at given position");if(r=(e=e||o.type).create(n,null,r||o.marks),o.isLeaf)return this.replaceWith(t,t+o.nodeSize,r);if(!e.validContent(o.content))throw new RangeError("Invalid content for node type "+e.name);return this.step(new It(t,t+o.nodeSize,t+1,t+o.nodeSize-1,new j(C.from(r),0,0),1,!0))},T.prototype.split=function(t,e,n){void 0===e&&(e=1);for(var r=this.doc.resolve(t),o=C.empty,i=C.empty,s=r.depth,a=r.depth-e,c=e-1;a<s;s--,c--){o=C.from(r.node(s).copy(o));var l=n&&n[c];i=C.from(l?l.type.create(l.attrs,i):r.node(s).copy(i))}return this.step(new jt(t,t,new j(o.append(i),e,e),!0))},T.prototype.join=function(t,e){return e=new jt(t-(e=void 0===e?1:e),t+e,j.empty,!0),this.step(e)};var qt=function(t){function e(e,n,r){t.call(this),this.from=e,this.to=n,this.mark=r}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.apply=function(t){var e=this,n=t.slice(this.from,this.to),r=t.resolve(this.from);r=r.node(r.sharedDepth(this.to)),n=new j(Ft(n.content,(function(t,n){return t.isAtom&&n.type.allowsMarkType(e.mark.type)?t.mark(e.mark.addToSet(t.marks)):t}),r),n.openStart,n.openEnd);return _t.fromReplace(t,this.from,this.to,n)},e.prototype.invert=function(){return new Jt(this.from,this.to,this.mark)},e.prototype.map=function(t){var n=t.mapResult(this.from,1);t=t.mapResult(this.to,-1);return n.deleted&&t.deleted||n.pos>=t.pos?null:new e(n.pos,t.pos,this.mark)},e.prototype.merge=function(t){if(t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from)return new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark)},e.prototype.toJSON=function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new e(n.from,n.to,t.markFromJSON(n.mark))},e}(I);I.jsonID("addMark",qt);var Jt=function(t){function e(e,n,r){t.call(this),this.from=e,this.to=n,this.mark=r}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.apply=function(t){var e=this,n=t.slice(this.from,this.to);n=new j(Ft(n.content,(function(t){return t.mark(e.mark.removeFromSet(t.marks))})),n.openStart,n.openEnd);return _t.fromReplace(t,this.from,this.to,n)},e.prototype.invert=function(){return new qt(this.from,this.to,this.mark)},e.prototype.map=function(t){var n=t.mapResult(this.from,1);t=t.mapResult(this.to,-1);return n.deleted&&t.deleted||n.pos>=t.pos?null:new e(n.pos,t.pos,this.mark)},e.prototype.merge=function(t){if(t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from)return new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark)},e.prototype.toJSON=function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new e(n.from,n.to,t.markFromJSON(n.mark))},e}(I);function Wt(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}I.jsonID("removeMark",Jt),T.prototype.addMark=function(t,e,n){var r=this,o=[],i=[],s=null,a=null;return this.doc.nodesBetween(t,e,(function(r,c,l){if(r.isInline){var p=r.marks;if(!n.isInSet(p)&&l.type.allowsMarkType(n.type)){for(var d=Math.max(c,t),u=Math.min(c+r.nodeSize,e),h=n.addToSet(p),f=0;f<p.length;f++)p[f].isInSet(h)||(s&&s.to==d&&s.mark.eq(p[f])?s.to=u:o.push(s=new Jt(d,u,p[f])));a&&a.to==d?a.to=u:i.push(a=new qt(d,u,n))}}})),o.forEach((function(t){return r.step(t)})),i.forEach((function(t){return r.step(t)})),this},T.prototype.removeMark=function(t,e,n){var r=this;void 0===n&&(n=null);var o=[],i=0;return this.doc.nodesBetween(t,e,(function(r,s){if(r.isInline){i++;var a=null;if(n instanceof pt)for(var c,l=r.marks;c=n.isInSet(l);)(a=a||[]).push(c),l=c.removeFromSet(l);else n?n.isInSet(r.marks)&&(a=[n]):a=r.marks;if(a&&a.length)for(var p=Math.min(s+r.nodeSize,e),d=0;d<a.length;d++){for(var u=a[d],h=void 0,f=0;f<o.length;f++){var m=o[f];m.step==i-1&&u.eq(o[f].style)&&(h=m)}h?(h.to=p,h.step=i):o.push({style:u,from:Math.max(s,t),to:p,step:i})}}})),o.forEach((function(t){return r.step(new Jt(t.from,t.to,t.style))})),this},T.prototype.clearIncompatible=function(t,e,n){void 0===n&&(n=e.contentMatch);for(var r=this.doc.nodeAt(t),o=[],i=t+1,s=0;s<r.childCount;s++){var a=r.child(s),c=i+a.nodeSize,l=n.matchType(a.type,a.attrs);if(l){n=l;for(var p=0;p<a.marks.length;p++)e.allowsMarkType(a.marks[p].type)||this.step(new Jt(i,c,a.marks[p]))}else o.push(new jt(i,c,j.empty));i=c}n.validEnd||(t=n.fillBefore(C.empty,!0),this.replace(i,i,new j(t,0,0)));for(var d=o.length-1;0<=d;d--)this.step(o[d]);return this},T.prototype.replace=function(t,e,n){return void 0===n&&(n=j.empty),n=function(t,e,n,r){if(void 0===r&&(r=j.empty),e==(n=void 0===n?e:n)&&!r.size)return null;var o=t.resolve(e);t=t.resolve(n);return Wt(o,t,r)?new jt(e,n,r):new Kt(o,t,r).fit()}(this.doc,t,e=void 0===e?t:e,n),n&&this.step(n),this},T.prototype.replaceWith=function(t,e,n){return this.replace(t,e,new j(C.from(n),0,0))},T.prototype.delete=function(t,e){return this.replace(t,e,j.empty)},T.prototype.insert=function(t,e){return this.replaceWith(t,t,e)};var Kt=function(t,e,n){this.$to=e,this.$from=t,this.unplaced=n,this.frontier=[];for(var r=0;r<=t.depth;r++){var o=t.node(r);this.frontier.push({type:o.type,match:o.contentMatchAt(t.indexAfter(r))})}this.placed=C.empty;for(var i=t.depth;0<i;i--)this.placed=C.from(t.node(i).copy(this.placed))};I={depth:{configurable:!0}};function Ut(t,e,n){return 0==e?t.cutByIndex(n):t.replaceChild(0,t.firstChild.copy(Ut(t.firstChild.content,e-1,n)))}function Gt(t,e,n){return 0==e?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(Gt(t.lastChild.content,e-1,n)))}function Xt(t,e){for(var n=0;n<e;n++)t=t.firstChild.content;return t}function Yt(t,e,n,r,o){var i=t.node(e);e=o?t.indexAfter(e):t.index(e);return e!=i.childCount||n.compatibleContent(i.type)?(r=r.fillBefore(i.content,!0,e),r&&!function(t,e,n){for(var r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}(n,i.content,e)?r:null):null}function Qt(t,e){for(var n=[],r=Math.min(t.depth,e.depth);0<=r;r--){var o=t.start(r);if(o<t.pos-(t.depth-r)||e.end(r)>e.pos+(e.depth-r)||t.node(r).type.spec.isolating||e.node(r).type.spec.isolating)break;o==e.start(r)&&n.push(r)}return n}I.depth.get=function(){return this.frontier.length-1},Kt.prototype.fit=function(){for(;this.unplaced.size;){var t;(t=this.findFittable())?this.placeNodes(t):this.openMore()||this.dropNode()}var e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,o=this.close(e<0?this.$to:r.doc.resolve(e));if(!o)return null;for(var i=this.placed,s=r.depth,a=o.depth;s&&a&&1==i.childCount;)i=i.firstChild.content,s--,a--;var c=new j(i,s,a);return-1<e?new It(r.pos,e,this.$to.pos,this.$to.end(),c,n):c.size||r.pos!=this.$to.pos?new jt(r.pos,o.pos,c):void 0},Kt.prototype.findFittable=function(){for(var t=1;t<=2;t++)for(var e=this.unplaced.openStart;0<=e;e--)for(var n=void 0,r=(e?n=Xt(this.unplaced.content,e-1).firstChild:this.unplaced).content.firstChild,o=this.depth;0<=o;o--){var i=this.frontier[o],s=i.type,a=i.match,c=void 0;i=void 0;if(1==t&&(r?a.matchType(r.type)||(i=a.fillBefore(C.from(r),!1)):s.compatibleContent(n.type)))return{sliceDepth:e,frontierDepth:o,parent:n,inject:i};if(2==t&&r&&(c=a.findWrapping(r.type)))return{sliceDepth:e,frontierDepth:o,parent:n,wrap:c};if(n&&a.matchType(n.type))break}},Kt.prototype.openMore=function(){var t=this.unplaced,e=t.content,n=t.openStart,r=t.openEnd;t=Xt(e,n);return!(!t.childCount||t.firstChild.isLeaf)&&(this.unplaced=new j(e,n+1,Math.max(r,t.size+n>=e.size-r?n+1:0)),!0)},Kt.prototype.dropNode=function(){var t=this.unplaced,e=t.content,n=t.openStart,r=t.openEnd;t=Xt(e,n);t.childCount<=1&&0<n?(t=e.size-n<=n+t.size,this.unplaced=new j(Ut(e,n-1,1),n-1,t?n-1:r)):this.unplaced=new j(Ut(e,n,1),n,r)},Kt.prototype.placeNodes=function(t){for(var e=t.sliceDepth,n=t.frontierDepth,r=t.parent,o=t.inject,i=t.wrap;this.depth>n;)this.closeFrontierNode();if(i)for(var s=0;s<i.length;s++)this.openFrontierNode(i[s]);var a=this.unplaced,c=(r||a).content,l=a.openStart-e,p=0,d=[],u=(t=this.frontier[n],t.match),h=t.type;if(o){for(var f=0;f<o.childCount;f++)d.push(o.child(f));u=u.matchFragment(o)}for(var m=c.size+e-(a.content.size-a.openEnd);p<c.childCount;){var v=c.child(p),g=u.matchType(v.type);if(!g)break;(1<++p||0==l||v.content.size)&&(u=g,d.push(function t(e,n,r){if(n<=0)return e;var o=e.content;return 1<n&&(o=o.replaceChild(0,t(o.firstChild,n-1,1==o.childCount?r-1:0))),0<n&&(o=e.type.contentMatch.fillBefore(o).append(o),r<=0&&(o=o.append(e.type.contentMatch.matchFragment(o).fillBefore(C.empty,!0)))),e.copy(o)}(v.mark(h.allowedMarks(v.marks)),1==p?l:0,p==c.childCount?m:-1)))}t=p==c.childCount,t||(m=-1),this.placed=Gt(this.placed,n,C.from(d)),this.frontier[n].match=u,t&&m<0&&r&&r.type==this.frontier[this.depth].type&&1<this.frontier.length&&this.closeFrontierNode();for(var y=0,b=c;y<m;y++){var w=b.lastChild;this.frontier.push({type:w.type,match:w.contentMatchAt(w.childCount)}),b=w.content}this.unplaced=t?0==e?j.empty:new j(Ut(a.content,e-1,1),e-1,m<0?a.openEnd:e-1):new j(Ut(a.content,e,p),a.openStart,a.openEnd)},Kt.prototype.mustMoveInline=function(){if(!this.$to.parent.isTextblock||this.$to.end()==this.$to.pos)return-1;var t,e=this.frontier[this.depth];if(!e.type.isTextblock||!Yt(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;for(var n=this.$to.depth,r=this.$to.after(n);1<n&&r==this.$to.end(--n);)++r;return r},Kt.prototype.findCloseLevel=function(t){t:for(var e=Math.min(this.depth,t.depth);0<=e;e--){var n=this.frontier[e],r=n.match,o=n.type;n=e<t.depth&&t.end(e+1)==t.pos+(t.depth-(e+1)),r=Yt(t,e,o,r,n);if(r){for(var i=e-1;0<=i;i--){var s=this.frontier[i],a=s.match;a=Yt(t,i,s.type,a,!0);if(!a||a.childCount)continue t}return{depth:e,fit:r,move:n?t.doc.resolve(t.after(e+1)):t}}}},Kt.prototype.close=function(t){var e;if(!(e=this.findCloseLevel(t)))return null;for(;this.depth>e.depth;)this.closeFrontierNode();e.fit.childCount&&(this.placed=Gt(this.placed,e.depth,e.fit)),t=e.move;for(var n=e.depth+1;n<=t.depth;n++){var r=t.node(n),o=r.type.contentMatch.fillBefore(r.content,!0,t.index(n));this.openFrontierNode(r.type,r.attrs,o)}return t},Kt.prototype.openFrontierNode=function(t,e,n){var r=this.frontier[this.depth];r.match=r.match.matchType(t),this.placed=Gt(this.placed,this.depth,C.from(t.create(e,n))),this.frontier.push({type:t,match:t.contentMatch})},Kt.prototype.closeFrontierNode=function(){var t=this.frontier.pop().match.fillBefore(C.empty,!0);t.childCount&&(this.placed=Gt(this.placed,this.frontier.length,t))},Object.defineProperties(Kt.prototype,I),T.prototype.replaceRange=function(t,e,n){if(!n.size)return this.deleteRange(t,e);var r=this.doc.resolve(t),o=this.doc.resolve(e);if(Wt(r,o,n))return this.step(new jt(t,e,n));var i=Qt(r,this.doc.resolve(e));0==i[i.length-1]&&i.pop();var s=-(r.depth+1);i.unshift(s);for(var a=r.depth,c=r.pos-1;0<a;a--,c--){var l=r.node(a).type.spec;if(l.defining||l.isolating)break;-1<i.indexOf(a)?s=a:r.before(a)==c&&i.splice(1,0,-a)}for(var p=i.indexOf(s),d=[],u=n.openStart,h=n.content,f=0;;f++){var m=h.firstChild;if(d.push(m),f==n.openStart)break;h=m.content}0<u&&d[u-1].type.spec.defining&&r.node(p).type!=d[u-1].type?--u:2<=u&&d[u-1].isTextblock&&d[u-2].type.spec.defining&&r.node(p).type!=d[u-2].type&&(u-=2);for(var v=n.openStart;0<=v;v--){var g=(v+u+1)%(n.openStart+1),y=d[g];if(y)for(var b=0;b<i.length;b++){var w=i[(b+p)%i.length],k=!0;w<0&&(k=!1,w=-w);var O=r.node(w-1),x=r.index(w-1);if(O.canReplaceWith(x,x,y.type,y.marks))return this.replace(r.before(w),k?o.after(w):e,new j(function t(e,n,r,o,i){var s;return n<r&&(s=e.firstChild,e=e.replaceChild(0,s.copy(t(s.content,n+1,r,o,s)))),o<n&&(n=i.contentMatchAt(0),i=n.fillBefore(e).append(e),e=i.append(n.matchFragment(i).fillBefore(C.empty,!0))),e}(n.content,0,n.openStart,g),g,n.openEnd))}}for(var M=this.steps.length,S=i.length-1;0<=S&&(this.replace(t,e,n),!(this.steps.length>M));S--){var T=i[S];T<0||(t=r.before(T),e=o.after(T))}return this},T.prototype.replaceRangeWith=function(t,e,n){var r;return n.isInline||t!=e||!this.doc.resolve(t).parent.content.size||null!=(r=function(t,e,n){var r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(0==r.parentOffset)for(var o=r.depth-1;0<=o;o--){var i=r.index(o);if(r.node(o).canReplaceWith(i,i,n))return r.before(o+1);if(0<i)return null}if(r.parentOffset==r.parent.content.size)for(var s=r.depth-1;0<=s;s--){var a=r.indexAfter(s);if(r.node(s).canReplaceWith(a,a,n))return r.after(s+1);if(a<r.node(s).childCount)return null}}(this.doc,t,n.type))&&(t=e=r),this.replaceRange(t,e,new j(C.from(n),0,0))},T.prototype.deleteRange=function(t,e){for(var n=this.doc.resolve(t),r=this.doc.resolve(e),o=Qt(n,r),i=0;i<o.length;i++){var s=o[i],a=i==o.length-1;if(a&&0==s||n.node(s).type.contentMatch.validEnd)return this.delete(n.start(s),r.end(s));if(0<s&&(a||n.node(s-1).canReplace(n.index(s-1),r.indexAfter(s-1))))return this.delete(n.before(s),r.after(s))}for(var c=1;c<=n.depth&&c<=r.depth;c++)if(t-n.start(c)==n.depth-c&&e>n.end(c)&&r.end(c)-e!=r.depth-c)return this.delete(n.before(c),e);return this.delete(t,e)};var Zt=Object.create(null),te=function(t,e,n){this.ranges=n||[new ee(t.min(e),t.max(e))],this.$anchor=t,this.$head=e};I={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};I.anchor.get=function(){return this.$anchor.pos},I.head.get=function(){return this.$head.pos},I.from.get=function(){return this.$from.pos},I.to.get=function(){return this.$to.pos},I.$from.get=function(){return this.ranges[0].$from},I.$to.get=function(){return this.ranges[0].$to},I.empty.get=function(){for(var t=this.ranges,e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0},te.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)},te.prototype.replace=function(t,e){for(var n=(e=void 0===e?j.empty:e).content.lastChild,r=null,o=0;o<e.openEnd;o++)n=(r=n).lastChild;for(var i=t.steps.length,s=this.ranges,a=0;a<s.length;a++){var c=s[a],l=c.$from,p=c.$to;c=t.mapping.slice(i);t.replaceRange(c.map(l.pos),c.map(p.pos),a?j.empty:e),0==a&&le(t,i,(n?n.isInline:r&&r.isTextblock)?-1:1)}},te.prototype.replaceWith=function(t,e){for(var n=t.steps.length,r=this.ranges,o=0;o<r.length;o++){var i=r[o],s=i.$from,a=i.$to;i=t.mapping.slice(n),s=i.map(s.pos),a=i.map(a.pos);o?t.deleteRange(s,a):(t.replaceRangeWith(s,a,e),le(t,n,e.isInline?-1:1))}},te.findFrom=function(t,e,n){var r=t.parent.inlineContent?new ne(t):ce(t.node(0),t.parent,t.pos,t.index(),e,n);if(r)return r;for(var o=t.depth-1;0<=o;o--){var i=e<0?ce(t.node(0),t.node(o),t.before(o+1),t.index(o),e,n):ce(t.node(0),t.node(o),t.after(o+1),t.index(o)+1,e,n);if(i)return i}},te.near=function(t,e){return this.findFrom(t,e=void 0===e?1:e)||this.findFrom(t,-e)||new se(t.node(0))},te.atStart=function(t){return ce(t,t,0,0,1)||new se(t)},te.atEnd=function(t){return ce(t,t,t.content.size,t.childCount,-1)||new se(t)},te.fromJSON=function(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");var n=Zt[e.type];if(!n)throw new RangeError("No selection type "+e.type+" defined");return n.fromJSON(t,e)},te.jsonID=function(t,e){if(t in Zt)throw new RangeError("Duplicate use of selection JSON ID "+t);return(Zt[t]=e).prototype.jsonID=t,e},te.prototype.getBookmark=function(){return ne.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(te.prototype,I),te.prototype.visible=!0;var ee=function(t,e){this.$from=t,this.$to=e},ne=function(t){function e(e,n){t.call(this,e,n=void 0===n?e:n)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={$cursor:{configurable:!0}};return n.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},e.prototype.map=function(n,r){var o=n.resolve(r.map(this.head));return o.parent.inlineContent?(r=n.resolve(r.map(this.anchor)),new e(r.parent.inlineContent?r:o,o)):t.near(o)},e.prototype.replace=function(e,n){void 0===n&&(n=j.empty),t.prototype.replace.call(this,e,n),n!=j.empty||(n=this.$from.marksAcross(this.$to))&&e.ensureMarks(n)},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor&&t.head==this.head},e.prototype.getBookmark=function(){return new re(this.anchor,this.head)},e.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},e.fromJSON=function(t,n){if("number"!=typeof n.anchor||"number"!=typeof n.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new e(t.resolve(n.anchor),t.resolve(n.head))},e.create=function(t,e,n){void 0===n&&(n=e);var r=t.resolve(e);return new this(r,n==e?r:t.resolve(n))},e.between=function(n,r,o){var i=n.pos-r.pos;if(o&&!i||(o=0<=i?1:-1),!r.parent.inlineContent){var s=t.findFrom(r,o,!0)||t.findFrom(r,-o,!0);if(!s)return t.near(r,o);r=s.$head}return new e(n=n.parent.inlineContent||0!=i&&(n=(t.findFrom(n,-o,!0)||t.findFrom(n,o,!0)).$anchor).pos<r.pos==i<0?n:r,r)},Object.defineProperties(e.prototype,n),e}(te);te.jsonID("text",ne);var re=function(t,e){this.anchor=t,this.head=e};re.prototype.map=function(t){return new re(t.map(this.anchor),t.map(this.head))},re.prototype.resolve=function(t){return ne.between(t.resolve(this.anchor),t.resolve(this.head))};var oe=function(t){function e(e){var n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);t.call(this,e,r),this.node=n}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.map=function(n,r){var o=r.mapResult(this.anchor);r=o.deleted,o=o.pos,o=n.resolve(o);return r?t.near(o):new e(o)},e.prototype.content=function(){return new j(C.from(this.node),0,0)},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor},e.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},e.prototype.getBookmark=function(){return new ie(this.anchor)},e.fromJSON=function(t,n){if("number"!=typeof n.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new e(t.resolve(n.anchor))},e.create=function(t,e){return new this(t.resolve(e))},e.isSelectable=function(t){return!t.isText&&!1!==t.type.spec.selectable},e}(te);oe.prototype.visible=!1,te.jsonID("node",oe);var ie=function(t){this.anchor=t};ie.prototype.map=function(t){var e=t.mapResult(this.anchor);t=e.deleted,e=e.pos;return t?new re(e,e):new ie(e)},ie.prototype.resolve=function(t){var e=t.resolve(this.anchor);t=e.nodeAfter;return t&&oe.isSelectable(t)?new oe(e):te.near(e)};var se=function(t){function e(e){t.call(this,e.resolve(0),e.resolve(e.content.size))}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.replace=function(e,n){var r;(n=void 0===n?j.empty:n)==j.empty?(e.delete(0,e.doc.content.size),(r=t.atStart(e.doc)).eq(e.selection)||e.setSelection(r)):t.prototype.replace.call(this,e,n)},e.prototype.toJSON=function(){return{type:"all"}},e.fromJSON=function(t){return new e(t)},e.prototype.map=function(t){return new e(t)},e.prototype.eq=function(t){return t instanceof e},e.prototype.getBookmark=function(){return ae},e}(te);te.jsonID("all",se);var ae={map:function(){return this},resolve:function(t){return new se(t)}};function ce(t,e,n,r,o,i){if(e.inlineContent)return ne.create(t,n);for(var s=r-(0<o?0:1);0<o?s<e.childCount:0<=s;s+=o){var a=e.child(s);if(a.isAtom){if(!i&&oe.isSelectable(a))return oe.create(t,n-(o<0?a.nodeSize:0))}else{var c=ce(t,a,n+o,o<0?a.childCount:0,o,i);if(c)return c}n+=a.nodeSize*o}}function le(t,e,n){var r,o=t.steps.length-1;o<e||((e=t.steps[o])instanceof jt||e instanceof It)&&(t.mapping.maps[o].forEach((function(t,e,n,o){null==r&&(r=o)})),t.setSelection(te.near(t.doc.resolve(r),n)))}var pe=function(t){function e(e){t.call(this,e.doc),this.time=Date.now(),this.curSelection=e.selection,this.curSelectionFor=0,this.storedMarks=e.storedMarks,this.updated=0,this.meta=Object.create(null)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return n.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},e.prototype.setSelection=function(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},n.selectionSet.get=function(){return 0<(1&this.updated)},e.prototype.setStoredMarks=function(t){return this.storedMarks=t,this.updated|=2,this},e.prototype.ensureMarks=function(t){return D.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this},e.prototype.addStoredMark=function(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))},e.prototype.removeStoredMark=function(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))},n.storedMarksSet.get=function(){return 0<(2&this.updated)},e.prototype.addStep=function(e,n){t.prototype.addStep.call(this,e,n),this.updated=-3&this.updated,this.storedMarks=null},e.prototype.setTime=function(t){return this.time=t,this},e.prototype.replaceSelection=function(t){return this.selection.replace(this,t),this},e.prototype.replaceSelectionWith=function(t,e){var n=this.selection;return!1!==e&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||D.none))),n.replaceWith(this,t),this},e.prototype.deleteSelection=function(){return this.selection.replace(this),this},e.prototype.insertText=function(t,e,n){void 0===n&&(n=e);var r=this.doc.type.schema;if(null==e)return t?this.replaceSelectionWith(r.text(t),!0):this.deleteSelection();if(!t)return this.deleteRange(e,n);var o,i=this.storedMarks;return i||(o=this.doc.resolve(e),i=n==e?o.marks():o.marksAcross(this.doc.resolve(n))),this.replaceRangeWith(e,n,r.text(t,i)),this.selection.empty||this.setSelection(te.near(this.selection.$to)),this},e.prototype.setMeta=function(t,e){return this.meta["string"==typeof t?t:t.key]=e,this},e.prototype.getMeta=function(t){return this.meta["string"==typeof t?t:t.key]},n.isGeneric.get=function(){for(var t in this.meta)return!1;return!0},e.prototype.scrollIntoView=function(){return this.updated|=4,this},n.scrolledIntoView.get=function(){return 0<(4&this.updated)},Object.defineProperties(e.prototype,n),e}(T);function de(t,e){return e&&t?t.bind(e):t}function ue(t,e,n){this.name=t,this.init=de(e.init,n),this.apply=de(e.apply,n)}function he(t,e){var n=this;this.schema=t,this.fields=me.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),e&&e.forEach((function(t){if(n.pluginsByKey[t.key])throw new RangeError("Adding different instances of a keyed plugin ("+t.key+")");n.plugins.push(t),(n.pluginsByKey[t.key]=t).spec.state&&n.fields.push(new ue(t.key,t.spec.state,t))}))}function fe(t){this.config=t}var me=[new ue("doc",{init:function(t){return t.doc||t.schema.topNodeType.createAndFill()},apply:function(t){return t.doc}}),new ue("selection",{init:function(t,e){return t.selection||te.atStart(e.doc)},apply:function(t){return t.selection}}),new ue("storedMarks",{init:function(t){return t.storedMarks||null},apply:function(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new ue("scrollToSelection",{init:function(){return 0},apply:function(t,e){return t.scrolledIntoView?e+1:e}})];T={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};T.schema.get=function(){return this.config.schema},T.plugins.get=function(){return this.config.plugins},fe.prototype.apply=function(t){return this.applyTransaction(t).state},fe.prototype.filterTransaction=function(t,e){void 0===e&&(e=-1);for(var n=0;n<this.config.plugins.length;n++)if(n!=e){var r=this.config.plugins[n];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,t,this))return!1}return!0},fe.prototype.applyTransaction=function(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};for(var e=[t],n=this.applyInner(t),r=null;;){for(var o=!1,i=0;i<this.config.plugins.length;i++){var s=this.config.plugins[i];if(s.spec.appendTransaction){var a=r?r[i].n:0,c=r?r[i].state:this;c=a<e.length&&s.spec.appendTransaction.call(s,a?e.slice(a):e,c,n);if(c&&n.filterTransaction(c,i)){if(c.setMeta("appendedTransaction",t),!r){r=[];for(var l=0;l<this.config.plugins.length;l++)r.push(l<i?{state:n,n:e.length}:{state:this,n:0})}e.push(c),n=n.applyInner(c),o=!0}r&&(r[i]={state:n,n:e.length})}}if(!o)return{state:n,transactions:e}}},fe.prototype.applyInner=function(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var e=new fe(this.config),n=this.config.fields,r=0;r<n.length;r++){var o=n[r];e[o.name]=o.apply(t,this[o.name],this,e)}for(var i=0;i<ve.length;i++)ve[i](this,t,e);return e},T.tr.get=function(){return new pe(this)},fe.create=function(t){for(var e=new he((t.doc?t.doc.type:t).schema,t.plugins),n=new fe(e),r=0;r<e.fields.length;r++)n[e.fields[r].name]=e.fields[r].init(t,n);return n},fe.prototype.reconfigure=function(t){for(var e=new he(this.schema,t.plugins),n=e.fields,r=new fe(e),o=0;o<n.length;o++){var i=n[o].name;r[i]=this.hasOwnProperty(i)?this[i]:n[o].init(t,r)}return r},fe.prototype.toJSON=function(t){var e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map((function(t){return t.toJSON()}))),t&&"object"==typeof t)for(var n in t){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var r=t[n],o=r.spec.state;o&&o.toJSON&&(e[n]=o.toJSON.call(r,this[r.key]))}return e},fe.fromJSON=function(t,e,n){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");var r=new he(t.schema,t.plugins),o=new fe(r);return r.fields.forEach((function(r){if("doc"==r.name)o.doc=X.fromJSON(t.schema,e.doc);else if("selection"==r.name)o.selection=te.fromJSON(o.doc,e.selection);else if("storedMarks"==r.name)e.storedMarks&&(o.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(n)for(var i in n){var s=n[i],a=s.spec.state;if(s.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(e,i))return void(o[r.name]=a.fromJSON.call(s,t,e[i],o))}o[r.name]=r.init(t,o)}})),o},fe.addApplyListener=function(t){ve.push(t)},fe.removeApplyListener=function(t){t=ve.indexOf(t),-1<t&&ve.splice(t,1)},Object.defineProperties(fe.prototype,T);var ve=[],ge=function(t){this.props={},t.props&&function t(e,n,r){for(var o in e){var i=e[o];i instanceof Function?i=i.bind(n):"handleDOMEvents"==o&&(i=t(i,n,{})),r[o]=i}return r}(t.props,this,this.props),this.spec=t,this.key=t.key?t.key.key:be("plugin")};ge.prototype.getState=function(t){return t[this.key]};var ye=Object.create(null);function be(t){return t in ye?t+"$"+ ++ye[t]:(ye[t]=0,t+"$")}function we(t){this.key=be(t=void 0===t?"key":t)}we.prototype.get=function(t){return t.config.pluginsByKey[this.key]},we.prototype.getState=function(t){return t[this.key]};var ke={};function Oe(t,e,n,r){return n&&(Ne(t,e,n,r,-1)||Ne(t,e,n,r,1))}"undefined"!=typeof navigator&&"undefined"!=typeof document&&(Ir=/Edge\/(\d+)/.exec(navigator.userAgent),Ye=/MSIE \d/.test(navigator.userAgent),Qe=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),ke.mac=/Mac/.test(navigator.platform),no=ke.ie=!!(Ye||Qe||Ir),ke.ie_version=Ye?document.documentMode||6:Qe?+Qe[1]:Ir?+Ir[1]:null,ke.gecko=!no&&/gecko\/(\d+)/i.test(navigator.userAgent),ke.gecko_version=ke.gecko&&+(/Firefox\/(\d+)/.exec(navigator.userAgent)||[0,0])[1],Gr=!no&&/Chrome\/(\d+)/.exec(navigator.userAgent),ke.chrome=!!Gr,ke.chrome_version=Gr&&+Gr[1],ke.safari=!no&&/Apple Computer/.test(navigator.vendor),ke.ios=ke.safari&&(/Mobile\/\w+/.test(navigator.userAgent)||2<navigator.maxTouchPoints),ke.android=/Android \d/.test(navigator.userAgent),ke.webkit="webkitFontSmoothing"in document.documentElement.style,ke.webkit_version=ke.webkit&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]);var xe=function(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e},Me=function(t){return t=t.assignedSlot||t.parentNode,t&&11==t.nodeType?t.host:t},Se=null,Ce=function(t,e,n){var r=Se=Se||document.createRange();return r.setEnd(t,null==n?t.nodeValue.length:n),r.setStart(t,e||0),r},Te=/^(img|br|input|textarea|hr)$/i;function Ne(t,e,n,r,o){for(;;){if(t==n&&e==r)return!0;if(e==(o<0?0:Ae(t))){var i=t.parentNode;if(1!=i.nodeType||function(t){for(var e,n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}(t)||Te.test(t.nodeName)||"false"==t.contentEditable)return!1;e=xe(t)+(o<0?0:1),t=i}else{if(1!=t.nodeType)return!1;if("false"==(t=t.childNodes[e+(o<0?-1:0)]).contentEditable)return!1;e=o<0?Ae(t):0}}}function Ae(t){return(3==t.nodeType?t.nodeValue:t.childNodes).length}var Ee=function(t){var e=t.isCollapsed;return!(e&&ke.chrome&&t.rangeCount&&!t.getRangeAt(0).collapsed)&&e};function De(t,e){var n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function _e(t,e){return"number"==typeof t?t:t[e]}function je(t,e,n){for(var r=t.someProp("scrollThreshold")||0,o=t.someProp("scrollMargin")||5,i=t.dom.ownerDocument,s=n||t.dom;s;s=Me(s))if(1==s.nodeType){var a,c=s==i.body||1!=s.nodeType,l=c?{left:0,right:i.documentElement.clientWidth,top:0,bottom:i.documentElement.clientHeight}:(a=l=p=void 0,p=(d=s).getBoundingClientRect(),l=p.width/d.offsetWidth||1,a=p.height/d.offsetHeight||1,{left:p.left,right:p.left+d.clientWidth*l,top:p.top,bottom:p.top+d.clientHeight*a}),p=0,d=0;if(e.top<l.top+_e(r,"top")?d=-(l.top-e.top+_e(o,"top")):e.bottom>l.bottom-_e(r,"bottom")&&(d=e.bottom-l.bottom+_e(o,"bottom")),e.left<l.left+_e(r,"left")?p=-(l.left-e.left+_e(o,"left")):e.right>l.right-_e(r,"right")&&(p=e.right-l.right+_e(o,"right")),(p||d)&&(c?i.defaultView.scrollBy(p,d):(a=s.scrollLeft,l=s.scrollTop,d&&(s.scrollTop+=d),p&&(s.scrollLeft+=p),a=s.scrollLeft-a,l=s.scrollTop-l,e={left:e.left-a,top:e.top-l,right:e.right-a,bottom:e.bottom-l})),c)break}}function Ie(t){for(var e=[],n=t.ownerDocument;t&&(e.push({dom:t,top:t.scrollTop,left:t.scrollLeft}),t!=n);t=Me(t));return e}function ze(t,e){for(var n=0;n<t.length;n++){var r=t[n],o=r.dom,i=r.top;r=r.left;o.scrollTop!=i+e&&(o.scrollTop=i+e),o.scrollLeft!=r&&(o.scrollLeft=r)}}var Ve=null;function Re(t,e){for(var n,r,o=2e8,i=0,s=e.top,a=e.top,c=t.firstChild,l=0;c;c=c.nextSibling,l++){var p=void 0;if(1==c.nodeType)p=c.getClientRects();else{if(3!=c.nodeType)continue;p=Ce(c).getClientRects()}for(var d=0;d<p.length;d++){var u=p[d];if(u.top<=s&&u.bottom>=a){s=Math.max(u.bottom,s),a=Math.min(u.top,a);var h=u.left>e.left?u.left-e.left:u.right<e.left?e.left-u.right:0;if(h<o){n=c,r=(o=h)&&3==n.nodeType?{left:u.right<e.left?u.right:u.left,top:e.top}:e,1==c.nodeType&&h&&(i=l+(e.left>=(u.left+u.right)/2?1:0));continue}}!n&&(e.left>=u.right&&e.top>=u.top||e.left>=u.left&&e.top>=u.bottom)&&(i=l+1)}}return n&&3==n.nodeType?function(t,e){for(var n=t.nodeValue.length,r=document.createRange(),o=0;o<n;o++){r.setEnd(t,o+1),r.setStart(t,o);var i=Pe(r,1);if(i.top!=i.bottom&&Le(e,i))return{node:t,offset:o+(e.left>=(i.left+i.right)/2?1:0)}}return{node:t,offset:0}}(n,r):!n||o&&1==n.nodeType?{node:t,offset:i}:Re(n,r)}function Le(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function Be(t,e){var n,r=t.root;if(r.caretPositionFromPoint)try{var o=r.caretPositionFromPoint(e.left,e.top);o&&(n=o.offsetNode,s=o.offset)}catch(t){}n||!r.caretRangeFromPoint||(a=r.caretRangeFromPoint(e.left,e.top))&&(n=a.startContainer,s=a.startOffset);var i,s,a,c,l;o=r.elementFromPoint(e.left,e.top+1);if(!o||!t.dom.contains(1!=o.nodeType?o.parentNode:o)){var p=t.dom.getBoundingClientRect();if(!Le(e,p))return null;if(!(o=function t(e,n,r){var o=e.childNodes.length;if(o&&r.top<r.bottom)for(var i=Math.max(0,Math.min(o-1,Math.floor(o*(n.top-r.top)/(r.bottom-r.top))-2)),s=i;;){var a=e.childNodes[s];if(1==a.nodeType)for(var c=a.getClientRects(),l=0;l<c.length;l++){var p=c[l];if(Le(n,p))return t(a,n,p)}if((s=(s+1)%o)==i)break}return e}(t.dom,e,p)))return null}if(ke.safari)for(var d=o;n&&d;d=Me(d))d.draggable&&(n=s=null);return a=e,o=(p=(r=o).parentNode)&&/^li$/i.test(p.nodeName)&&a.left<r.getBoundingClientRect().left?p:r,n&&(ke.gecko&&1==n.nodeType&&(s=Math.min(s,n.childNodes.length))<n.childNodes.length&&"IMG"==(c=n.childNodes[s]).nodeName&&(l=c.getBoundingClientRect()).right<=e.left&&l.bottom>e.top&&s++,n==t.dom&&s==n.childNodes.length-1&&1==n.lastChild.nodeType&&e.top>n.lastChild.getBoundingClientRect().bottom?i=t.state.doc.content.size:0!=s&&1==n.nodeType&&"BR"==n.childNodes[s-1].nodeName||(i=function(t,e,n,r){for(var o=-1,i=e;i!=t.dom;){var s=t.docView.nearestDesc(i,!0);if(!s)return null;if(s.node.isBlock&&s.parent){var a=s.dom.getBoundingClientRect();if(a.left>r.left||a.top>r.top)o=s.posBefore;else{if(!(a.right<r.left||a.bottom<r.top))break;o=s.posAfter}}i=s.dom.parentNode}return-1<o?o:t.docView.posFromDOM(e,n)}(t,n,s,e))),null==i&&(a=t,c=Re(p=o,r=e),l=c.node,e=c.offset,p=-1,1!=l.nodeType||l.firstChild||(p=(c=l.getBoundingClientRect()).left!=c.right&&r.left>(c.left+c.right)/2?1:-1),i=a.docView.posFromDOM(l,e,p)),o=t.docView.nearestDesc(o,!0),{pos:i,inside:o?o.posAtStart-o.border:-1}}function Pe(t,e){var n=t.getClientRects();return n.length?n[e<0?0:n.length-1]:t.getBoundingClientRect()}var He=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function $e(t,e,n){var r=t.docView.domFromPos(e,n<0?-1:1),o=r.node,i=r.offset;r=ke.webkit||ke.gecko;if(3==o.nodeType){if(!r||!He.test(o.nodeValue)&&(n<0?i:i!=o.nodeValue.length)){var s=i,a=i,c=n<0?1:-1;return n<0&&!i?(a++,c=-1):0<=n&&i==o.nodeValue.length?(s--,c=1):n<0?s--:a++,Fe(Pe(Ce(o,s,a),c),c<0)}return s=Pe(Ce(o,i,i),n),ke.gecko&&i&&/\s/.test(o.nodeValue[i-1])&&i<o.nodeValue.length&&(a=Pe(Ce(o,i-1,i-1),-1),a.top==s.top&&(c=Pe(Ce(o,i,i+1),-1),c.top!=s.top))?Fe(c,c.left<a.left):s}if(!t.state.doc.resolve(e).parent.inlineContent){if(i&&(n<0||i==Ae(o))&&(e=o.childNodes[i-1],1==e.nodeType))return qe(e.getBoundingClientRect(),!1);if(i<Ae(o)){var l=o.childNodes[i];if(1==l.nodeType)return qe(l.getBoundingClientRect(),!0)}return qe(o.getBoundingClientRect(),0<=n)}return i&&(n<0||i==Ae(o))&&(l=o.childNodes[i-1],l=3==l.nodeType?Ce(l,Ae(l)-(r?0:1)):1!=l.nodeType||"BR"==l.nodeName&&l.nextSibling?null:l,l)?Fe(Pe(l,1),!1):i<Ae(o)&&(i=o.childNodes[i],i=3==i.nodeType?Ce(i,0,r?0:1):1==i.nodeType?i:null,i)?Fe(Pe(i,-1),!0):Fe(Pe(3==o.nodeType?Ce(o):o,-n),0<=n)}function Fe(t,e){return 0==t.width?t:(e=e?t.left:t.right,{top:t.top,bottom:t.bottom,left:e,right:e})}function qe(t,e){return 0==t.height?t:(e=e?t.top:t.bottom,{top:e,bottom:e,left:t.left,right:t.right})}function Je(t,e,n){var r=t.state,o=t.root.activeElement;r!=e&&t.updateState(e),o!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),o!=t.dom&&o&&o.focus()}}var We=/[\u0590-\u08ac]/,Ke=null,Ue=null,Ge=!1;function Xe(t,e,n){return Ke==e&&Ue==n?Ge:(Ke=e,Ge="up"==(Ue=n)||"down"==n?(r=t,o=n,i=e.selection,s="up"==o?i.$from:i.$to,Je(r,e,(function(){for(var t=r.docView.domFromPos(s.pos,"up"==o?-1:1).node;;){var e=r.docView.nearestDesc(t,!0);if(!e)break;if(e.node.isBlock){t=e.dom;break}t=e.dom.parentNode}for(var n=$e(r,s.pos,1),i=t.firstChild;i;i=i.nextSibling){var a=void 0;if(1==i.nodeType)a=i.getClientRects();else{if(3!=i.nodeType)continue;a=Ce(i,0,i.nodeValue.length).getClientRects()}for(var c=0;c<a.length;c++){var l=a[c];if(l.bottom>l.top&&("up"==o?l.bottom<n.top+1:l.top>n.bottom-1))return!1}}return!0}))):function(t,e,n){var r=e.selection.$head;if(!r.parent.isTextblock)return!1;var o=!(i=r.parentOffset),i=i==r.parent.content.size,s=getSelection();return We.test(r.parent.textContent)&&s.modify?Je(t,e,(function(){var e=s.getRangeAt(0),o=s.focusNode,i=s.focusOffset,a=s.caretBidiLevel;return s.modify("move",n,"character"),i=!(r.depth?t.docView.domAfterPos(r.before()):t.dom).contains(1==s.focusNode.nodeType?s.focusNode:s.focusNode.parentNode)||o==s.focusNode&&i==s.focusOffset,s.removeAllRanges(),s.addRange(e),null!=a&&(s.caretBidiLevel=a),i})):"left"==n||"backward"==n?o:i}(t,e,n));var r,o,i,s}var Ye=function(t,e,n,r){this.parent=t,this.children=e,((this.dom=n).pmViewDesc=this).contentDOM=r,this.dirty=0},Qe={beforePosition:{configurable:!0},size:{configurable:!0},border:{configurable:!0},posBefore:{configurable:!0},posAtStart:{configurable:!0},posAfter:{configurable:!0},posAtEnd:{configurable:!0},contentLost:{configurable:!0},domAtom:{configurable:!0}};Ye.prototype.matchesWidget=function(){return!1},Ye.prototype.matchesMark=function(){return!1},Ye.prototype.matchesNode=function(){return!1},Ye.prototype.matchesHack=function(t){return!1},Qe.beforePosition.get=function(){return!1},Ye.prototype.parseRule=function(){return null},Ye.prototype.stopEvent=function(){return!1},Qe.size.get=function(){for(var t=0,e=0;e<this.children.length;e++)t+=this.children[e].size;return t},Qe.border.get=function(){return 0},Ye.prototype.destroy=function(){this.parent=null,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=null);for(var t=0;t<this.children.length;t++)this.children[t].destroy()},Ye.prototype.posBeforeChild=function(t){for(var e=0,n=this.posAtStart;e<this.children.length;e++){var r=this.children[e];if(r==t)return n;n+=r.size}},Qe.posBefore.get=function(){return this.parent.posBeforeChild(this)},Qe.posAtStart.get=function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0},Qe.posAfter.get=function(){return this.posBefore+this.size},Qe.posAtEnd.get=function(){return this.posAtStart+this.size-2*this.border},Ye.prototype.localPosFromDOM=function(t,e,n){if(this.contentDOM&&this.contentDOM.contains(1==t.nodeType?t:t.parentNode)){if(n<0){var r,o;if(t==this.contentDOM)r=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;r=t.previousSibling}for(;r&&(!(o=r.pmViewDesc)||o.parent!=this);)r=r.previousSibling;return r?this.posBeforeChild(o)+o.size:this.posAtStart}var i,s;if(t==this.contentDOM)i=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;i=t.nextSibling}for(;i&&(!(s=i.pmViewDesc)||s.parent!=this);)i=i.nextSibling;return i?this.posBeforeChild(s):this.posAtEnd}var a;if(t==this.dom&&this.contentDOM)a=e>xe(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))a=2&t.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==e)for(var c=t;;c=c.parentNode){if(c==this.dom){a=!1;break}if(c.parentNode.firstChild!=c)break}if(null==a&&e==t.childNodes.length)for(var l=t;;l=l.parentNode){if(l==this.dom){a=!0;break}if(l.parentNode.lastChild!=l)break}}return(null==a?0<n:a)?this.posAtEnd:this.posAtStart},Ye.prototype.nearestDesc=function(t,e){for(var n=!0,r=t;r;r=r.parentNode){var o=this.getDesc(r);if(o&&(!e||o.node)){if(!n||!o.nodeDOM||(1==o.nodeDOM.nodeType?o.nodeDOM.contains(1==t.nodeType?t:t.parentNode):o.nodeDOM==t))return o;n=!1}}},Ye.prototype.getDesc=function(t){for(var e=t.pmViewDesc,n=e;n;n=n.parent)if(n==this)return e},Ye.prototype.posFromDOM=function(t,e,n){for(var r=t;r;r=r.parentNode){var o=this.getDesc(r);if(o)return o.localPosFromDOM(t,e,n)}return-1},Ye.prototype.descAt=function(t){for(var e=0,n=0;e<this.children.length;e++){var r=this.children[e],o=n+r.size;if(n==t&&o!=n){for(;!r.border&&r.children.length;)r=r.children[0];return r}if(t<o)return r.descAt(t-n-r.border);n=o}},Ye.prototype.domFromPos=function(t,e){if(!this.contentDOM)return{node:this.dom,offset:0};for(var n=0,r=0,o=!0;;r++,o=!1){for(;r<this.children.length&&(this.children[r].beforePosition||this.children[r].dom.parentNode!=this.contentDOM);)n+=this.children[r++].size;var i=r==this.children.length?null:this.children[r];if(n==t&&(0==e||!i||!i.size||i.border||e<0&&o)||i&&i.domAtom&&t<n+i.size)return{node:this.contentDOM,offset:i?xe(i.dom):this.contentDOM.childNodes.length};if(!i)throw new Error("Invalid position "+t);var s=n+i.size;if(!i.domAtom&&(e<0&&!i.border?t<=s:t<s)&&(t<s||r+1>=this.children.length||!this.children[r+1].beforePosition))return i.domFromPos(t-n-i.border,e);n=s}},Ye.prototype.parseRange=function(t,e,n){if(0==this.children.length)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var r=-1,o=-1,i=n=void 0===n?0:n,s=0;;s++){var a=this.children[s],c=i+a.size;if(-1==r&&t<=c){var l=i+a.border;if(l<=t&&e<=c-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(t,e,l);t=i;for(var p=s;0<p;p--){var d=this.children[p-1];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(1)){r=xe(d.dom)+1;break}t-=d.size}-1==r&&(r=0)}if(-1<r&&(e<c||s==this.children.length-1)){e=c;for(var u=s+1;u<this.children.length;u++){var h=this.children[u];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(-1)){o=xe(h.dom);break}e+=h.size}-1==o&&(o=this.contentDOM.childNodes.length);break}i=c}return{node:this.contentDOM,from:t,to:e,fromOffset:r,toOffset:o}},Ye.prototype.emptyChildAt=function(t){if(this.border||!this.contentDOM||!this.children.length)return!1;var e=this.children[t<0?0:this.children.length-1];return 0==e.size||e.emptyChildAt(t)},Ye.prototype.domAfterPos=function(t){var e=this.domFromPos(t,0),n=e.node;e=e.offset;if(1!=n.nodeType||e==n.childNodes.length)throw new RangeError("No node after pos "+t);return n.childNodes[e]},Ye.prototype.setSelection=function(t,e,n,r){for(var o=Math.min(t,e),i=Math.max(t,e),s=0,a=0;s<this.children.length;s++){var c=this.children[s],l=a+c.size;if(a<o&&i<l)return c.setSelection(t-a-c.border,e-a-c.border,n,r);a=l}var p=this.domFromPos(t,t?-1:1),d=e==t?p:this.domFromPos(e,e?-1:1),u=n.getSelection(),h=!1;if((ke.gecko||ke.safari)&&t==e){var f=p.node,m=p.offset;if(3==f.nodeType){if((h=m&&"\n"==f.nodeValue[m-1])&&m==f.nodeValue.length)for(var v,g=f;g;g=g.parentNode){if(v=g.nextSibling){"BR"==v.nodeName&&(p=d={node:v.parentNode,offset:xe(v)+1});break}var y=g.pmViewDesc;if(y&&y.node&&y.node.isBlock)break}}else m=f.childNodes[m-1],h=m&&("BR"==m.nodeName||"false"==m.contentEditable)}if(ke.gecko&&u.focusNode&&u.focusNode!=d.node&&1==u.focusNode.nodeType&&(w=u.focusNode.childNodes[u.focusOffset])&&"false"==w.contentEditable&&(r=!0),r||h&&ke.safari||!Oe(p.node,p.offset,u.anchorNode,u.anchorOffset)||!Oe(d.node,d.offset,u.focusNode,u.focusOffset)){var b,w=!1;if((u.extend||t==e)&&!h){u.collapse(p.node,p.offset);try{t!=e&&u.extend(d.node,d.offset),w=!0}catch(t){if(!(t instanceof DOMException))throw t}}w||(e<t&&(b=p,p=d,d=b),(b=document.createRange()).setEnd(d.node,d.offset),b.setStart(p.node,p.offset),u.removeAllRanges(),u.addRange(b))}},Ye.prototype.ignoreMutation=function(t){return!this.contentDOM&&"selection"!=t.type},Qe.contentLost.get=function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)},Ye.prototype.markDirty=function(t,e){for(var n=0,r=0;r<this.children.length;r++){var o=this.children[r],i=n+o.size;if(n==i?t<=i&&n<=e:t<i&&n<e){var s=n+o.border,a=i-o.border;if(s<=t&&e<=a)return this.dirty=t==n||e==i?2:1,void(t!=s||e!=a||!o.contentLost&&o.dom.parentNode==this.contentDOM?o.markDirty(t-s,e-s):o.dirty=3);o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM?2:3}n=i}this.dirty=2},Ye.prototype.markParentsDirty=function(){for(var t=1,e=this.parent;e;e=e.parent,t++){var n=1==t?2:1;e.dirty<n&&(e.dirty=n)}},Qe.domAtom.get=function(){return!1},Object.defineProperties(Ye.prototype,Qe);var Ze=[],tn=function(t){function e(e,n,r,o){var i,s=n.type.toDOM;"function"==typeof s&&(s=s(r,(function(){return i?i.parent?i.parent.posBeforeChild(i):void 0:o}))),n.type.spec.raw||(1!=s.nodeType&&((r=document.createElement("span")).appendChild(s),s=r),s.contentEditable=!1,s.classList.add("ProseMirror-widget")),t.call(this,e,Ze,s,null),this.widget=n,i=this}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={beforePosition:{configurable:!0},domAtom:{configurable:!0}};return n.beforePosition.get=function(){return this.widget.type.side<0},e.prototype.matchesWidget=function(t){return 0==this.dirty&&t.type.eq(this.widget.type)},e.prototype.parseRule=function(){return{ignore:!0}},e.prototype.stopEvent=function(t){var e=this.widget.spec.stopEvent;return!!e&&e(t)},e.prototype.ignoreMutation=function(t){return"selection"!=t.type||this.widget.spec.ignoreSelection},n.domAtom.get=function(){return!0},Object.defineProperties(e.prototype,n),e}(Ye),en=function(t){function e(e,n,r,o){t.call(this,e,Ze,n,null),this.textDOM=r,this.text=o}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={size:{configurable:!0}};return n.size.get=function(){return this.text.length},e.prototype.localPosFromDOM=function(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e},e.prototype.domFromPos=function(t){return{node:this.textDOM,offset:t}},e.prototype.ignoreMutation=function(t){return"characterData"===t.type&&t.target.nodeValue==t.oldValue},Object.defineProperties(e.prototype,n),e}(Ye),nn=function(t){function e(e,n,r,o){t.call(this,e,[],r,o),this.mark=n}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).create=function(t,n,r,o){var i=o.nodeViews[n.type.name];o=i&&i(n,o,r);return o&&o.dom||(o=kt.renderSpec(document,n.type.spec.toDOM(n,r))),new e(t,n,o.dom,o.contentDOM||o.dom)},e.prototype.parseRule=function(){return{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}},e.prototype.matchesMark=function(t){return 3!=this.dirty&&this.mark.eq(t)},e.prototype.markDirty=function(e,n){if(t.prototype.markDirty.call(this,e,n),0!=this.dirty){for(var r=this.parent;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=0}},e.prototype.slice=function(t,n,r){var o=e.create(this.parent,this.mark,!0,r),i=this.children,s=this.size;n<s&&(i=yn(i,n,s,r)),0<t&&(i=yn(i,0,t,r));for(var a=0;a<i.length;a++)i[a].parent=o;return o.children=i,o},e}(Ye),rn=function(t){function e(e,n,r,o,i,s,a,c,l){t.call(this,e,n.isLeaf?Ze:[],i,s),this.nodeDOM=a,this.node=n,this.outerDeco=r,this.innerDeco=o,s&&this.updateChildren(c,l)}t&&(e.__proto__=t);var n={size:{configurable:!0},border:{configurable:!0},domAtom:{configurable:!0}};return((e.prototype=Object.create(t&&t.prototype)).constructor=e).create=function(t,n,r,o,i,s){var a,c=i.nodeViews[n.type.name],l=c&&c(n,i,(function(){return a?a.parent?a.parent.posBeforeChild(a):void 0:s}),r,o),p=l&&l.dom;c=l&&l.contentDOM;if(n.isText)if(p){if(3!=p.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else p=document.createTextNode(n.text);else p||(p=(d=kt.renderSpec(document,n.type.spec.toDOM(n))).dom,c=d.contentDOM);c||n.isText||"BR"==p.nodeName||(p.hasAttribute("contenteditable")||(p.contentEditable=!1),n.type.spec.draggable&&(p.draggable=!0));var d=p;p=hn(p,r,n);return l?a=new cn(t,n,r,o,p,c,d,l,i,s+1):n.isText?new sn(t,n,r,o,p,d,i):new e(t,n,r,o,p,c,d,i,s+1)},e.prototype.parseRule=function(){var t=this;if(this.node.type.spec.reparseInView)return null;var e={node:this.node.type.name,attrs:this.node.attrs};return this.node.type.spec.code&&(e.preserveWhitespace="full"),this.contentDOM&&!this.contentLost?e.contentElement=this.contentDOM:e.getContent=function(){return t.contentDOM?C.empty:t.node.content},e},e.prototype.matchesNode=function(t,e,n){return 0==this.dirty&&t.eq(this.node)&&fn(e,this.outerDeco)&&n.eq(this.innerDeco)},n.size.get=function(){return this.node.nodeSize},n.border.get=function(){return this.node.isLeaf?0:1},e.prototype.updateChildren=function(t,e){var n=this,r=this.node.inlineContent,o=e,i=t.composing&&this.localCompositionInfo(t,e),s=(e=i&&-1<i.pos?i:null,i&&i.pos<0),a=new vn(this,e&&e.node);!function(t,e,n,r){var o=e.locals(t),i=0;if(0!=o.length)for(var s=0,a=[],c=null,l=0;;){if(s<o.length&&o[s].to==i){for(var p=o[s++],d=void 0;s<o.length&&o[s].to==i;)(d=d||[p]).push(o[s++]);if(d){d.sort(gn);for(var u=0;u<d.length;u++)n(d[u],l,!!c)}else n(p,l,!!c)}var h=void 0,f=void 0;if(c)f=-1,h=c,c=null;else{if(!(l<t.childCount))break;f=l,h=t.child(l++)}for(var m=0;m<a.length;m++)a[m].to<=i&&a.splice(m--,1);for(;s<o.length&&o[s].from<=i&&o[s].to>i;)a.push(o[s++]);var v=i+h.nodeSize;if(h.isText){var g=v;s<o.length&&o[s].from<g&&(g=o[s].from);for(var y=0;y<a.length;y++)a[y].to<g&&(g=a[y].to);g<v&&(c=h.cut(g-i),h=h.cut(0,g-i),v=g,f=-1)}var b=a.length?h.isInline&&!h.isLeaf?a.filter((function(t){return!t.inline})):a.slice():Ze;r(h,b,e.forChild(i,h),f),i=v}else for(var w=0;w<t.childCount;w++){var k=t.child(w);r(k,o,e.forChild(i,k),w),i+=k.nodeSize}}(this.node,this.innerDeco,(function(e,i,s){e.spec.marks?a.syncToMarks(e.spec.marks,r,t):0<=e.type.side&&!s&&a.syncToMarks(i==n.node.childCount?D.none:n.node.child(i).marks,r,t),a.placeWidget(e,t,o)}),(function(e,n,c,l){var p;a.syncToMarks(e.marks,r,t),a.findNodeMatch(e,n,c,l)||s&&t.state.selection.from>o&&t.state.selection.to<o+e.nodeSize&&-1<(p=a.findIndexWithChild(i.node))&&a.updateNodeAt(e,n,c,p,t)||a.updateNextNode(e,n,c,t,l)||a.addNode(e,n,c,t,o),o+=e.nodeSize})),a.syncToMarks(Ze,r,t),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),!a.changed&&2!=this.dirty||(e&&this.protectLocalComposition(t,e),function t(e,n,r){for(var o=e.firstChild,i=!1,s=0;s<n.length;s++){var a,c=n[s],l=c.dom;if(l.parentNode==e){for(;l!=o;)o=mn(o),i=!0;o=o.nextSibling}else i=!0,e.insertBefore(l,o);c instanceof nn&&(a=o?o.previousSibling:e.lastChild,t(c.contentDOM,c.children,r),o=a?a.nextSibling:e.firstChild)}for(;o;)o=mn(o),i=!0;i&&r.trackWrites==e&&(r.trackWrites=null)}(this.contentDOM,this.children,t),ke.ios&&function(t){var e;"UL"!=t.nodeName&&"OL"!=t.nodeName||(e=t.style.cssText,t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e)}(this.dom))},e.prototype.localCompositionInfo=function(t,e){var n=t.state.selection,r=n.from,o=n.to;if(!(!(t.state.selection instanceof ne)||r<e||o>e+this.node.content.size)&&(n=t.root.getSelection(),t=function(t,e){for(;;){if(3==t.nodeType)return t;if(1==t.nodeType&&0<e){if(t.childNodes.length>e&&3==t.childNodes[e].nodeType)return t.childNodes[e];t=t.childNodes[e-1],e=Ae(t)}else{if(!(1==t.nodeType&&e<t.childNodes.length))return null;t=t.childNodes[e],e=0}}}(n.focusNode,n.focusOffset),t&&this.dom.contains(t.parentNode)))return this.node.inlineContent?(n=t.nodeValue,e=function(t,e,n,r){for(var o=0,i=0;o<t.childCount&&i<=r;){var s=t.child(o++),a=i;if(i+=s.nodeSize,s.isText){for(var c=s.text;o<t.childCount;){var l=t.child(o++);if(i+=l.nodeSize,!l.isText)break;c+=l.text}if(n<=i&&(s=c.lastIndexOf(e,r-a),0<=s&&s+e.length+a>=n))return a+s}}return-1}(this.node.content,n,r-e,o-e),e<0?null:{node:t,pos:e,text:n}):{node:t,pos:-1}},e.prototype.protectLocalComposition=function(t,e){var n=e.node,r=e.pos;e=e.text;if(!this.getDesc(n)){for(var o=n;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=null)}n=new en(this,o,n,e),t.compositionNodes.push(n),this.children=yn(this.children,r,r+e.length,t,n)}},e.prototype.update=function(t,e,n,r){return!(3==this.dirty||!t.sameMarkup(this.node))&&(this.updateInner(t,e,n,r),!0)},e.prototype.updateInner=function(t,e,n,r){this.updateOuterDeco(e),this.node=t,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0},e.prototype.updateOuterDeco=function(t){var e,n;fn(t,this.outerDeco)||(e=1!=this.nodeDOM.nodeType,n=this.dom,this.dom=un(this.dom,this.nodeDOM,dn(this.outerDeco,this.node,e),dn(t,this.node,e)),this.dom!=n&&(n.pmViewDesc=null,this.dom.pmViewDesc=this),this.outerDeco=t)},e.prototype.selectNode=function(){this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)},e.prototype.deselectNode=function(){this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.dom.removeAttribute("draggable")},n.domAtom.get=function(){return this.node.isAtom},Object.defineProperties(e.prototype,n),e}(Ye);function on(t,e,n,r,o){return hn(r,e,t),new rn(null,t,e,n,r,r,r,o,0)}var sn=function(t){function e(e,n,r,o,i,s,a){t.call(this,e,n,r,o,i,null,s,a)}t&&(e.__proto__=t);var n={domAtom:{configurable:!0}};return((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.parseRule=function(){for(var t=this.nodeDOM.parentNode;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}},e.prototype.update=function(t,e,n,r){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!t.sameMarkup(this.node))&&(this.updateOuterDeco(e),0==this.dirty&&t.text==this.node.text||t.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=t.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=t,!(this.dirty=0))},e.prototype.inParent=function(){for(var t=this.parent.contentDOM,e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1},e.prototype.domFromPos=function(t){return{node:this.nodeDOM,offset:t}},e.prototype.localPosFromDOM=function(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):t.prototype.localPosFromDOM.call(this,e,n,r)},e.prototype.ignoreMutation=function(t){return"characterData"!=t.type&&"selection"!=t.type},e.prototype.slice=function(t,n,r){return t=this.node.cut(t,n),n=document.createTextNode(t.text),new e(this.parent,t,this.outerDeco,this.innerDeco,n,n,r)},e.prototype.markDirty=function(e,n){t.prototype.markDirty.call(this,e,n),this.dom==this.nodeDOM||0!=e&&n!=this.nodeDOM.nodeValue.length||(this.dirty=3)},n.domAtom.get=function(){return!1},Object.defineProperties(e.prototype,n),e}(rn),an=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t);var n={domAtom:{configurable:!0}};return((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.parseRule=function(){return{ignore:!0}},e.prototype.matchesHack=function(t){return 0==this.dirty&&this.dom.nodeName==t},n.domAtom.get=function(){return!0},Object.defineProperties(e.prototype,n),e}(Ye),cn=function(t){function e(e,n,r,o,i,s,a,c,l,p){t.call(this,e,n,r,o,i,s,a,l,p),this.spec=c}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.update=function(e,n,r,o){if(3==this.dirty)return!1;if(this.spec.update){var i=this.spec.update(e,n,r);return i&&this.updateInner(e,n,r,o),i}return!(!this.contentDOM&&!e.isLeaf)&&t.prototype.update.call(this,e,n,r,o)},e.prototype.selectNode=function(){this.spec.selectNode?this.spec.selectNode():t.prototype.selectNode.call(this)},e.prototype.deselectNode=function(){this.spec.deselectNode?this.spec.deselectNode():t.prototype.deselectNode.call(this)},e.prototype.setSelection=function(e,n,r,o){this.spec.setSelection?this.spec.setSelection(e,n,r):t.prototype.setSelection.call(this,e,n,r,o)},e.prototype.destroy=function(){this.spec.destroy&&this.spec.destroy(),t.prototype.destroy.call(this)},e.prototype.stopEvent=function(t){return!!this.spec.stopEvent&&this.spec.stopEvent(t)},e.prototype.ignoreMutation=function(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):t.prototype.ignoreMutation.call(this,e)},e}(rn);function ln(t){t&&(this.nodeName=t)}ln.prototype=Object.create(null);var pn=[new ln];function dn(t,e,n){if(0==t.length)return pn;for(var r=n?pn[0]:new ln,o=[r],i=0;i<t.length;i++){var s=t[i].type.attrs;if(s)for(var a in s.nodeName&&o.push(r=new ln(s.nodeName)),s){var c=s[a];null!=c&&(n&&1==o.length&&o.push(r=new ln(e.isInline?"span":"div")),"class"==a?r.class=(r.class?r.class+" ":"")+c:"style"==a?r.style=(r.style?r.style+";":"")+c:"nodeName"!=a&&(r[a]=c))}}return o}function un(t,e,n,r){if(n==pn&&r==pn)return e;for(var o=e,i=0;i<r.length;i++){var s,a=r[i],c=n[i];i&&(s=void 0,c&&c.nodeName==a.nodeName&&o!=t&&(s=o.parentNode)&&s.tagName.toLowerCase()==a.nodeName||((s=document.createElement(a.nodeName)).pmIsDeco=!0,s.appendChild(o),c=pn[0]),o=s),function(t,e,n){for(var r in e)"class"==r||"style"==r||"nodeName"==r||r in n||t.removeAttribute(r);for(var o in n)"class"!=o&&"style"!=o&&"nodeName"!=o&&n[o]!=e[o]&&t.setAttribute(o,n[o]);if(e.class!=n.class){for(var i=e.class?e.class.split(" ").filter(Boolean):Ze,s=n.class?n.class.split(" ").filter(Boolean):Ze,a=0;a<i.length;a++)-1==s.indexOf(i[a])&&t.classList.remove(i[a]);for(var c=0;c<s.length;c++)-1==i.indexOf(s[c])&&t.classList.add(s[c])}if(e.style!=n.style){if(e.style)for(var l,p=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;l=p.exec(e.style);)t.style.removeProperty(l[1]);n.style&&(t.style.cssText+=n.style)}}(o,c||pn[0],a)}return o}function hn(t,e,n){return un(t,t,pn,dn(e,n,1!=t.nodeType))}function fn(t,e){if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function mn(t){var e=t.nextSibling;return t.parentNode.removeChild(t),e}var vn=function(t,e){this.top=t,this.lock=e,this.index=0,this.stack=[],this.changed=!1,this.preMatch=function(t,e){for(var n=t.childCount,r=e.length,o=new Map;0<n&&0<r;r--){var i=e[r-1],s=i.node;if(s){if(s!=t.child(n-1))break;--n,o.set(i,n)}}return{index:n,matched:o}}(t.node.content,t.children)};function gn(t,e){return t.type.side-e.type.side}function yn(t,e,n,r,o){for(var i=[],s=0,a=0;s<t.length;s++){var c=t[s],l=a,p=a+=c.size;n<=l||p<=e?i.push(c):(l<e&&i.push(c.slice(0,e-l,r)),o&&(i.push(o),o=null),n<p&&i.push(c.slice(n-l,c.size,r)))}return i}function bn(t,e){var n=t.root.getSelection(),r=t.state.doc;if(!n.focusNode)return null;var o=t.docView.nearestDesc(n.focusNode),i=o&&0==o.size,s=t.docView.posFromDOM(n.focusNode,n.focusOffset);if(s<0)return null;var a,c,l=r.resolve(s);if(Ee(n)){for(a=l;o&&!o.node;)o=o.parent;!(o&&o.node.isAtom&&oe.isSelectable(o.node)&&o.parent)||o.node.isInline&&function(t,e,n){for(var r=0==e,o=e==Ae(t);r||o;){if(t==n)return 1;var i=xe(t);if(!(t=t.parentNode))return;r=r&&0==i,o=o&&i==Ae(t)}}(n.focusNode,n.focusOffset,o.dom)||(c=o.posBefore,c=new oe(s==c?l:r.resolve(c)))}else{if(n=t.docView.posFromDOM(n.anchorNode,n.anchorOffset),n<0)return null;a=r.resolve(n)}return c||Nn(t,a,l,"pointer"==e||t.state.selection.head<l.pos&&!i?1:-1)}function wn(t){return t.editable?t.hasFocus():An(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function kn(t,e){var n,r,o,i,s=t.state.selection;Cn(t,s),wn(t)&&(t.domObserver.disconnectSelection(),t.cursorWrapper?function(t){var e=t.root.getSelection(),n=document.createRange(),r=t.cursorWrapper.dom,o="IMG"==r.nodeName;o?n.setEnd(r.parentNode,xe(r)+1):n.setEnd(r,0),n.collapse(!1),e.removeAllRanges(),e.addRange(n),!o&&!t.state.selection.visible&&ke.ie&&ke.ie_version<=11&&(r.disabled=!0,r.disabled=!1)}(t):(n=s.anchor,r=s.head,!On||s instanceof ne||(s.$from.parent.inlineContent||(o=xn(t,s.from)),s.empty||s.$from.parent.inlineContent||(i=xn(t,s.to))),t.docView.setSelection(n,r,t.root,e),On&&(o&&Sn(o),i&&Sn(i)),s.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(t){var e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.hideSelectionGuard);var n=t.root.getSelection(),r=n.anchorNode,o=n.anchorOffset;e.addEventListener("selectionchange",t.hideSelectionGuard=function(){n.anchorNode==r&&n.anchorOffset==o||(e.removeEventListener("selectionchange",t.hideSelectionGuard),setTimeout((function(){wn(t)&&!t.state.selection.visible||t.dom.classList.remove("ProseMirror-hideselection")}),20))})}(t))),t.domObserver.setCurSelection(),t.domObserver.connectSelection())}vn.prototype.destroyBetween=function(t,e){if(t!=e){for(var n=t;n<e;n++)this.top.children[n].destroy();this.top.children.splice(t,e-t),this.changed=!0}},vn.prototype.destroyRest=function(){this.destroyBetween(this.index,this.top.children.length)},vn.prototype.syncToMarks=function(t,e,n){for(var r=0,o=this.stack.length>>1,i=Math.min(o,t.length);r<i&&(r==o-1?this.top:this.stack[r+1<<1]).matchesMark(t[r])&&!1!==t[r].type.spec.spanning;)r++;for(;r<o;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<t.length;){this.stack.push(this.top,this.index+1);for(var s,a=-1,c=this.index;c<Math.min(this.index+3,this.top.children.length);c++)if(this.top.children[c].matchesMark(t[o])){a=c;break}-1<a?(a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index]):(s=nn.create(this.top,t[o],e,n),this.top.children.splice(this.index,0,s),this.top=s,this.changed=!0),this.index=0,o++}},vn.prototype.findNodeMatch=function(t,e,n,r){var o=this.top.children,i=-1;if(r>=this.preMatch.index){for(var s=this.index;s<o.length;s++)if(o[s].matchesNode(t,e,n)){i=s;break}}else for(var a=this.index,c=Math.min(o.length,a+1);a<c;a++){var l=o[a];if(l.matchesNode(t,e,n)&&!this.preMatch.matched.has(l)){i=a;break}}return!(i<0)&&(this.destroyBetween(this.index,i),this.index++,!0)},vn.prototype.updateNodeAt=function(t,e,n,r,o){return!!this.top.children[r].update(t,e,n,o)&&(this.destroyBetween(this.index,r),this.index=r+1,!0)},vn.prototype.findIndexWithChild=function(t){for(;;){var e=t.parentNode;if(!e)return-1;if(e==this.top.contentDOM){var n=t.pmViewDesc;if(n)for(var r=this.index;r<this.top.children.length;r++)if(this.top.children[r]==n)return r;return-1}t=e}},vn.prototype.updateNextNode=function(t,e,n,r,o){for(var i=this.index;i<this.top.children.length;i++){var s=this.top.children[i];if(s instanceof rn){var a=this.preMatch.matched.get(s);if(null!=a&&a!=o)return!1;if(a=s.dom,(!this.lock||!(a==this.lock||1==a.nodeType&&a.contains(this.lock.parentNode))||t.isText&&s.node&&s.node.isText&&s.nodeDOM.nodeValue==t.text&&3!=s.dirty&&fn(e,s.outerDeco))&&s.update(t,e,n,r))return this.destroyBetween(this.index,i),s.dom!=a&&(this.changed=!0),this.index++,!0;break}}return!1},vn.prototype.addNode=function(t,e,n,r,o){this.top.children.splice(this.index++,0,rn.create(this.top,t,e,n,r,o)),this.changed=!0},vn.prototype.placeWidget=function(t,e,n){var r=this.index<this.top.children.length?this.top.children[this.index]:null;!r||!r.matchesWidget(t)||t!=r.widget&&r.widget.type.toDOM.parentNode?(n=new tn(this.top,t,e,n),this.top.children.splice(this.index++,0,n),this.changed=!0):this.index++},vn.prototype.addTextblockHacks=function(){for(var t=this.top.children[this.index-1];t instanceof nn;)t=t.children[t.children.length-1];t&&t instanceof sn&&!/\n$/.test(t.node.text)||(ke.safari&&t&&"false"==t.dom.contentEditable&&this.addHackNode("IMG"),this.addHackNode("BR"))},vn.prototype.addHackNode=function(t){this.index<this.top.children.length&&this.top.children[this.index].matchesHack(t)?this.index++:(t=document.createElement(t),this.top.children.splice(this.index++,0,new an(this.top,Ze,t,null)),this.changed=!0)};var On=ke.safari||ke.chrome&&ke.chrome_version<63;function xn(t,e){var n=t.docView.domFromPos(e,0);t=n.node,e=n.offset,n=e<t.childNodes.length?t.childNodes[e]:null,e=e?t.childNodes[e-1]:null;return ke.safari&&n&&"false"==n.contentEditable?Mn(n):n&&"false"!=n.contentEditable||e&&"false"!=e.contentEditable?void 0:n?Mn(n):e?Mn(e):void 0}function Mn(t){return t.contentEditable="true",ke.safari&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function Sn(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function Cn(t,e){e instanceof oe?(e=t.docView.descAt(e.from))!=t.lastSelectedViewDesc&&(Tn(t),e&&e.selectNode(),t.lastSelectedViewDesc=e):Tn(t)}function Tn(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=null)}function Nn(t,e,n,r){return t.someProp("createSelectionBetween",(function(r){return r(t,e,n)}))||ne.between(e,n,r)}function An(t){var e=t.root.getSelection();if(!e.anchorNode)return!1;try{return t.dom.contains(3==e.anchorNode.nodeType?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(3==e.focusNode.nodeType?e.focusNode.parentNode:e.focusNode))}catch(t){return!1}}function En(t,e){var n=t.selection,r=n.$anchor;n=n.$head,n=0<e?r.max(n):r.min(n),n=n.parent.inlineContent?n.depth?t.doc.resolve(0<e?n.after():n.before()):null:n;return n&&te.findFrom(n,e)}function Dn(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function _n(t,e,n){var r=t.state.selection;if(!(r instanceof ne)){if(r instanceof oe&&r.node.isInline)return Dn(t,new ne(0<e?r.$to:r.$from));var o=En(t.state,e);return!!o&&Dn(t,o)}if(!r.empty||-1<n.indexOf("s"))return!1;if(t.endOfTextblock(0<e?"right":"left")){var i=En(t.state,e);return!!(i&&i instanceof oe)&&Dn(t,i)}return ke.mac&&-1<n.indexOf("m")?void 0:(o=r.$head,i=o.textOffset?null:e<0?o.nodeBefore:o.nodeAfter,!(!i||i.isText)&&(n=e<0?o.pos-i.nodeSize:o.pos,!!(i.isAtom||(r=t.docView.descAt(n))&&!r.contentDOM)&&(oe.isSelectable(i)?Dn(t,new oe(e<0?t.state.doc.resolve(o.pos-i.nodeSize):o)):!!ke.webkit&&Dn(t,new ne(t.state.doc.resolve(e<0?n:n+i.nodeSize))))))}function jn(t){return(3==t.nodeType?t.nodeValue:t.childNodes).length}function In(t){var e=t.pmViewDesc;return e&&0==e.size&&(t.nextSibling||"BR"!=t.nodeName)}function zn(t){var e=t.root.getSelection(),n=e.focusNode,r=e.focusOffset;if(n){var o,i,s=!1;for(ke.gecko&&1==n.nodeType&&r<jn(n)&&In(n.childNodes[r])&&(s=!0);;)if(0<r){if(1!=n.nodeType)break;var a=n.childNodes[r-1];if(In(a))o=n,i=--r;else{if(3!=a.nodeType)break;r=(n=a).nodeValue.length}}else{if(Rn(n))break;for(var c=n.previousSibling;c&&In(c);)o=n.parentNode,i=xe(c),c=c.previousSibling;if(c)r=jn(n=c);else{if((n=n.parentNode)==t.dom)break;r=0}}s?Ln(t,e,n,r):o&&Ln(t,e,o,i)}}function Vn(t){var e=t.root.getSelection(),n=e.focusNode,r=e.focusOffset;if(n){for(var o,i,s=jn(n);;)if(r<s){if(1!=n.nodeType)break;if(!In(n.childNodes[r]))break;o=n,i=++r}else{if(Rn(n))break;for(var a=n.nextSibling;a&&In(a);)o=a.parentNode,i=xe(a)+1,a=a.nextSibling;if(a)r=0,s=jn(n=a);else{if((n=n.parentNode)==t.dom)break;r=s=0}}o&&Ln(t,e,o,i)}}function Rn(t){return t=t.pmViewDesc,t&&t.node&&t.node.isBlock}function Ln(t,e,n,r){var o;Ee(e)?((o=document.createRange()).setEnd(n,r),o.setStart(n,r),e.removeAllRanges(),e.addRange(o)):e.extend&&e.extend(n,r),t.domObserver.setCurSelection();var i=t.state;setTimeout((function(){t.state==i&&kn(t)}),50)}function Bn(t,e,n){var r=t.state.selection;if(r instanceof ne&&!r.empty||-1<n.indexOf("s"))return!1;if(ke.mac&&-1<n.indexOf("m"))return!1;var o=r.$from,i=r.$to;return(!o.parent.inlineContent||t.endOfTextblock(e<0?"up":"down"))&&(n=En(t.state,e),n&&n instanceof oe)?Dn(t,n):!o.parent.inlineContent&&(i=e<0?o:i,e=r instanceof se?te.near(i,e):te.findFrom(i,e),!!e&&Dn(t,e))}function Pn(t,e){if(!(t.state.selection instanceof ne))return!0;var n=t.state.selection,r=n.$head,o=n.$anchor;n=n.empty;return!r.sameParent(o)||!!n&&(!!t.endOfTextblock(0<e?"forward":"backward")||(o=!r.textOffset&&(e<0?r.nodeBefore:r.nodeAfter),!(!o||o.isText)&&(n=t.state.tr,e<0?n.delete(r.pos-o.nodeSize,r.pos):n.delete(r.pos,r.pos+o.nodeSize),t.dispatch(n),!0)))}function Hn(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function $n(t,e){var n,r,o,i=e.keyCode,s=(r="",e.ctrlKey&&(r+="c"),e.metaKey&&(r+="m"),e.altKey&&(r+="a"),e.shiftKey&&(r+="s"),r);return 8==i||ke.mac&&72==i&&"c"==s?Pn(t,-1)||zn(t):46==i||ke.mac&&68==i&&"c"==s?Pn(t,1)||Vn(t):13==i||27==i||(37==i?_n(t,-1,s)||zn(t):39==i?_n(t,1,s)||Vn(t):38==i?Bn(t,-1,s)||zn(t):40==i?(n=t,!ke.safari||0<n.state.selection.$head.parentOffset||(r=(e=n.root.getSelection()).focusNode,e=e.focusOffset,r&&1==r.nodeType&&0==e&&r.firstChild&&"false"==r.firstChild.contentEditable&&(o=r.firstChild,Hn(n,o,!0),setTimeout((function(){return Hn(n,o,!1)}),20))),Bn(t,1,s)||Vn(t)):s==(ke.mac?"m":"c")&&(66==i||73==i||89==i||90==i))}function Fn(t){var e=t.pmViewDesc;if(e)return e.parseRule();if("BR"==t.nodeName&&t.parentNode){if(ke.safari&&/^(ul|ol)$/i.test(t.parentNode.nodeName))return e=document.createElement("div"),e.appendChild(document.createElement("li")),{skip:e};if(t.parentNode.lastChild==t||ke.safari&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if("IMG"==t.nodeName&&t.getAttribute("mark-placeholder"))return{ignore:!0}}function qn(t,e,n,r,o){if(e<0){var i=t.lastSelectionTime>Date.now()-50?t.lastSelectionOrigin:null,s=bn(t,i);s&&!t.state.selection.eq(s)&&(a=t.state.tr.setSelection(s),"pointer"==i?a.setMeta("pointer",!0):"key"==i&&a.scrollIntoView(),t.dispatch(a))}else{i=t.state.doc.resolve(e);var a=i.sharedDepth(n);e=i.before(a+1),n=t.state.doc.resolve(n).after(a+1),a=t.state.selection,e=function(t,e,n){var r=t.docView.parseRange(e,n),o=r.node,i=r.fromOffset,s=r.toOffset,a=r.from,c=r.to;e=t.root.getSelection(),n=null;if((r=e.anchorNode)&&t.dom.contains(1==r.nodeType?r:r.parentNode)&&(n=[{node:r,offset:e.anchorOffset}],Ee(e)||n.push({node:e.focusNode,offset:e.focusOffset})),ke.chrome&&8===t.lastKeyCode)for(var l=s;i<l;l--){var p=o.childNodes[l-1],d=p.pmViewDesc;if("BR"==p.nodeName&&!d){s=l;break}if(!d||d.size)break}return r=t.state.doc,e=t.someProp("domParser")||ht.fromSchema(t.state.schema),t=r.resolve(a),r=null,{doc:e.parse(o,{topNode:t.parent,topMatch:t.parent.contentMatchAt(t.index()),topOpen:!0,from:i,to:s,preserveWhitespace:!t.parent.type.spec.code||"full",editableContent:!0,findPositions:n,ruleFromNode:Fn,context:t}),sel:r=n&&null!=n[0].pos?{anchor:(t=n[0].pos)+a,head:(n=null==(n=n[1]&&n[1].pos)?t:n)+a}:r,from:a,to:c}}(t,e,n),ke.chrome&&t.cursorWrapper&&e.sel&&e.sel.anchor==t.cursorWrapper.deco.from&&(p=(l=t.cursorWrapper.deco.type.toDOM.nextSibling)&&l.nodeValue?l.nodeValue.length:1,e.sel={anchor:e.sel.anchor+p,head:e.sel.anchor+p});n=t.state.doc;var c,l=n.slice(e.from,e.to),p=8===t.lastKeyCode&&Date.now()-100<t.lastKeyCodeTime?(c=t.state.selection.to,"end"):(c=t.state.selection.from,"start");if(t.lastKeyCode=null,p=function(t,e,n,r,o){var i=t.findDiffStart(e,n);if(null==i)return null;var s=t.findDiffEnd(e,n+t.size,n+e.size);n=s.a,s=s.b;return"end"==o&&(o=Math.max(0,i-Math.min(n,s)),r-=n+o-i),n<i&&t.size<e.size?(s=(i-=r<=i&&n<=r?i-r:0)+(s-n),n=i):s<i&&(n=(i-=r<=i&&s<=r?i-r:0)+(n-s),s=i),{start:i,endA:n,endB:s}}(l.content,e.doc.content,e.from,c,p),!p){if(!(r&&a instanceof ne&&!a.empty&&a.$head.sameParent(a.$anchor))||t.composing||e.sel&&e.sel.anchor!=e.sel.head)return(ke.ios&&t.lastIOSEnter>Date.now()-225||ke.android)&&o.some((function(t){return"DIV"==t.nodeName||"P"==t.nodeName}))&&t.someProp("handleKeyDown",(function(e){return e(t,De(13,"Enter"))}))?void(t.lastIOSEnter=0):void(!e.sel||(u=Jn(t,t.state.doc,e.sel))&&!u.eq(t.state.selection)&&t.dispatch(t.state.tr.setSelection(u)));p={start:a.from,endA:a.to,endB:a.to}}t.domChangeCount++,t.state.selection.from<t.state.selection.to&&p.start==p.endB&&t.state.selection instanceof ne&&(p.start>t.state.selection.from&&p.start<=t.state.selection.from+2?p.start=t.state.selection.from:p.endA<t.state.selection.to&&p.endA>=t.state.selection.to-2&&(p.endB+=t.state.selection.to-p.endA,p.endA=t.state.selection.to)),ke.ie&&ke.ie_version<=11&&p.endB==p.start+1&&p.endA==p.start&&p.start>e.from&&"  "==e.doc.textBetween(p.start-e.from-1,p.start-e.from+1)&&(p.start--,p.endA--,p.endB--);r=e.doc.resolveNoCache(p.start-e.from);var d,u=e.doc.resolveNoCache(p.endB-e.from);a=r.sameParent(u)&&r.parent.inlineContent;if((ke.ios&&t.lastIOSEnter>Date.now()-225&&(!a||o.some((function(t){return"DIV"==t.nodeName||"P"==t.nodeName})))||!a&&r.pos<e.doc.content.size&&(d=te.findFrom(e.doc.resolve(r.pos+1),1,!0))&&d.head==u.pos)&&t.someProp("handleKeyDown",(function(e){return e(t,De(13,"Enter"))})))t.lastIOSEnter=0;else if(t.state.selection.anchor>p.start&&function(t,e,n,r,o){return!(!r.parent.isTextblock||n-e<=o.pos-r.pos||Wn(r,!0,!1)<o.pos)&&(e=t.resolve(e),!(e.parentOffset<e.parent.content.size||!e.parent.isTextblock)&&(e=t.resolve(Wn(e,!0,!0)),!(!e.parent.isTextblock||e.pos>n||Wn(e,!0,!1)<n)&&r.parent.content.cut(r.parentOffset).eq(e.parent.content)))}(n,p.start,p.endA,r,u)&&t.someProp("handleKeyDown",(function(e){return e(t,De(8,"Backspace"))})))ke.android&&ke.chrome&&t.domObserver.suppressSelectionUpdates();else{ke.chrome&&ke.android&&p.toB==p.from&&(t.lastAndroidDelete=Date.now()),ke.android&&!a&&r.start()!=u.start()&&0==u.parentOffset&&r.depth==u.depth&&e.sel&&e.sel.anchor==e.sel.head&&e.sel.head==p.endA&&(p.endB-=2,u=e.doc.resolveNoCache(p.endB-e.from),setTimeout((function(){t.someProp("handleKeyDown",(function(e){return e(t,De(13,"Enter"))}))}),20));var h,f,m,v,g=p.start,y=p.endA;if(a)if(r.pos==u.pos)ke.ie&&ke.ie_version<=11&&0==r.parentOffset&&(t.domObserver.suppressSelectionUpdates(),setTimeout((function(){return kn(t)}),20)),h=t.state.tr.delete(g,y),f=n.resolve(p.start).marksAcross(n.resolve(p.endA));else if(p.endA==p.endB&&(v=n.resolve(p.start))&&(m=function(t,e){for(var n,r,o,i=t.firstChild.marks,s=e.firstChild.marks,a=i,c=s,l=0;l<s.length;l++)a=s[l].removeFromSet(a);for(var p=0;p<i.length;p++)c=i[p].removeFromSet(c);if(1==a.length&&0==c.length)r=a[0],n="add",o=function(t){return t.mark(r.addToSet(t.marks))};else{if(0!=a.length||1!=c.length)return null;r=c[0],n="remove",o=function(t){return t.mark(r.removeFromSet(t.marks))}}for(var d=[],u=0;u<e.childCount;u++)d.push(o(e.child(u)));if(C.from(d).eq(t))return{mark:r,type:n}}(r.parent.content.cut(r.parentOffset,u.parentOffset),v.parent.content.cut(v.parentOffset,p.endA-v.start()))))h=t.state.tr,"add"==m.type?h.addMark(g,y,m.mark):h.removeMark(g,y,m.mark);else if(r.parent.child(r.index()).isText&&r.index()==u.index()-(u.textOffset?0:1)){var b=r.parent.textBetween(r.parentOffset,u.parentOffset);if(t.someProp("handleTextInput",(function(e){return e(t,g,y,b)})))return;h=t.state.tr.insertText(b,g,y)}h=h||t.state.tr.replace(g,y,e.doc.slice(p.start-e.from,p.endB-e.from)),!e.sel||(e=Jn(t,h.doc,e.sel))&&!(ke.chrome&&ke.android&&t.composing&&e.empty&&(p.start!=p.endB||t.lastAndroidDelete<Date.now()-100)&&(e.head==g||e.head==h.mapping.map(y)-1)||ke.ie&&e.empty&&e.head==g)&&h.setSelection(e),f&&h.ensureMarks(f),t.dispatch(h.scrollIntoView())}}}function Jn(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:Nn(t,e.resolve(n.anchor),e.resolve(n.head))}function Wn(t,e,n){for(var r=t.depth,o=e?t.end():t.pos;0<r&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,o++,e=!1;if(n)for(var i=t.node(r).maybeChild(t.indexAfter(r));i&&!i.isLeaf;)i=i.firstChild,o++;return o}function Kn(t,e){for(var n=[],r=e.content,o=e.openStart,i=e.openEnd;1<o&&1<i&&1==r.childCount&&1==r.firstChild.childCount;){o--,i--;var s=r.firstChild;n.push(s.type.name,s.attrs!=s.type.defaultAttrs?s.attrs:null),r=s.content}var a=t.someProp("clipboardSerializer")||kt.fromSchema(t.state.schema),c=Zn(),l=c.createElement("div");l.appendChild(a.serializeFragment(r,{document:c}));for(var p,d=l.firstChild;d&&1==d.nodeType&&(p=Yn[d.nodeName.toLowerCase()]);){for(var u=p.length-1;0<=u;u--){for(var h=c.createElement(p[u]);l.firstChild;)h.appendChild(l.firstChild);l.appendChild(h)}d=l.firstChild}return d&&1==d.nodeType&&d.setAttribute("data-pm-slice",o+" "+i+" "+JSON.stringify(n)),{dom:l,text:t.someProp("clipboardTextSerializer",(function(t){return t(e)}))||e.content.textBetween(0,e.content.size,"\n\n")}}function Un(t,e,n,r,o){var i=o.parent.type.spec.code;if(!n&&!e)return null;var s=e&&(r||i||!n);if(s){if(t.someProp("transformPastedText",(function(t){e=t(e,i||r)})),i)return new j(C.from(t.state.schema.text(e.replace(/\r\n?/g,"\n"))),0,0);var a,c,l,p,d=t.someProp("clipboardTextParser",(function(t){return t(e,o,r)}));d?u=d:(a=o.marks(),c=t.state.schema,l=kt.fromSchema(c),p=document.createElement("div"),e.trim().split(/(?:\r\n?|\n)+/).forEach((function(t){p.appendChild(document.createElement("p")).appendChild(l.serializeNode(c.text(t,a)))})))}else t.someProp("transformPastedHTML",(function(t){n=t(n)})),p=function(t){var e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));var n,r=Zn().createElement("div");e=/<([a-z][^>\s]+)/i.exec(t);if((n=e&&Yn[e[1].toLowerCase()])&&(t=n.map((function(t){return"<"+t+">"})).join("")+t+n.map((function(t){return"</"+t+">"})).reverse().join("")),r.innerHTML=t,n)for(var o=0;o<n.length;o++)r=r.querySelector(n[o])||r;return r}(n),ke.webkit&&function(t){for(var e=t.querySelectorAll(ke.chrome?"span:not([class]):not([style])":"span.Apple-converted-space"),n=0;n<e.length;n++){var r=e[n];1==r.childNodes.length&&" "==r.textContent&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}(p);var u;d=p&&p.querySelector("[data-pm-slice]"),d=d&&/^(\d+) (\d+) (.*)/.exec(d.getAttribute("data-pm-slice"));return u=u||(t.someProp("clipboardParser")||t.someProp("domParser")||ht.fromSchema(t.state.schema)).parseSlice(p,{preserveWhitespace:!(!s&&!d),context:o}),u=d?function(t,e){if(!t.size)return t;var n,r=t.content.firstChild.type.schema;try{n=JSON.parse(e)}catch(e){return t}for(var o=t.content,i=t.openStart,s=t.openEnd,a=n.length-2;0<=a;a-=2){var c=r.nodes[n[a]];if(!c||c.hasRequiredAttrs())break;o=C.from(c.create(n[a+1],o)),i++,s++}return new j(o,i,s)}(function(t,e,n){return e<t.openStart&&(t=new j(Xn(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new j(Xn(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}(u,+d[1],+d[2]),d[3]):j.maxOpen(function(t,e){if(t.childCount<2)return t;for(var n=function(n){var r=e.node(n).contentMatchAt(e.index(n)),o=void 0,i=[];if(t.forEach((function(t){if(i){var e,n=r.findWrapping(t.type);if(!n)return i=null;(e=i.length&&o.length&&function t(e,n,r,o,i){if(i<e.length&&i<n.length&&e[i]==n[i])return n=t(e,n,r,o.lastChild,i+1),n?o.copy(o.content.replaceChild(o.childCount-1,n)):o.contentMatchAt(o.childCount).matchType(i==e.length-1?r.type:e[i+1])?o.copy(o.content.append(C.from(Gn(r,e,i+1)))):void 0}(n,o,t,i[i.length-1],0))?i[i.length-1]=e:(i.length&&(i[i.length-1]=function t(e,n){if(0==n)return e;var r=e.content.replaceChild(e.childCount-1,t(e.lastChild,n-1));return n=e.contentMatchAt(e.childCount).fillBefore(C.empty,!0),e.copy(r.append(n))}(i[i.length-1],o.length)),t=Gn(t,n),i.push(t),r=r.matchType(t.type,t.attrs),o=n)}})),i)return{v:C.from(i)}},r=e.depth;0<=r;r--){var o=n(r);if(o)return o.v}return t}(u.content,o),!1),t.someProp("transformPasted",(function(t){u=t(u)})),u}function Gn(t,e,n){void 0===n&&(n=0);for(var r=e.length-1;n<=r;r--)t=e[r].create(null,C.from(t));return t}function Xn(t,e,n,r,o,i){var s=e<0?t.firstChild:t.lastChild,a=s.content;return o<r-1&&(a=Xn(a,e,n,r,o+1,i)),n<=o&&(a=e<0?s.contentMatchAt(0).fillBefore(a,1<t.childCount||i<=o).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(C.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,s.copy(a))}var Yn={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},Qn=null;function Zn(){return Qn=Qn||document.implementation.createHTMLDocument("title")}function tr(){this.anchorNode=this.anchorOffset=this.focusNode=this.focusOffset=null}var er={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},nr=ke.ie&&ke.ie_version<=11;function rr(t,e){var n=this;this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=-1,this.observer=window.MutationObserver&&new window.MutationObserver((function(t){for(var e=0;e<t.length;e++)n.queue.push(t[e]);ke.ie&&ke.ie_version<=11&&t.some((function(t){return"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length}))?n.flushSoon():n.flush()})),this.currentSelection=new tr,nr&&(this.onCharData=function(t){n.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),n.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.suppressingSelectionUpdates=!1}tr.prototype.set=function(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset},tr.prototype.eq=function(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset},rr.prototype.flushSoon=function(){var t=this;this.flushingSoon<0&&(this.flushingSoon=window.setTimeout((function(){t.flushingSoon=-1,t.flush()}),20))},rr.prototype.forceFlush=function(){-1<this.flushingSoon&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())},rr.prototype.start=function(){this.observer&&this.observer.observe(this.view.dom,er),nr&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()},rr.prototype.stop=function(){var t=this;if(this.observer){var e=this.observer.takeRecords();if(e.length){for(var n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout((function(){return t.flush()}),20)}this.observer.disconnect()}nr&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()},rr.prototype.connectSelection=function(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)},rr.prototype.disconnectSelection=function(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)},rr.prototype.suppressSelectionUpdates=function(){var t=this;this.suppressingSelectionUpdates=!0,setTimeout((function(){return t.suppressingSelectionUpdates=!1}),50)},rr.prototype.onSelectionChange=function(){if((!(t=this.view).editable||t.root.activeElement==t.dom)&&An(t)){if(this.suppressingSelectionUpdates)return kn(this.view);if(ke.ie&&ke.ie_version<=11&&!this.view.state.selection.empty){var t=this.view.root.getSelection();if(t.focusNode&&Oe(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}},rr.prototype.setCurSelection=function(){this.currentSelection.set(this.view.root.getSelection())},rr.prototype.ignoreSelectionChange=function(t){if(0==t.rangeCount)return!0;var e=t.getRangeAt(0).commonAncestorContainer;t=this.view.docView.nearestDesc(e);return t&&t.ignoreMutation({type:"selection",target:3==e.nodeType?e.parentNode:e})?(this.setCurSelection(),!0):void 0},rr.prototype.flush=function(){if(this.view.docView&&!(-1<this.flushingSoon)){var t=this.observer?this.observer.takeRecords():[];this.queue.length&&(t=this.queue.concat(t),this.queue.length=0);var e,n,r=this.view.root.getSelection(),o=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&An(this.view)&&!this.ignoreSelectionChange(r),i=-1,s=-1,a=!1,c=[];if(this.view.editable)for(var l=0;l<t.length;l++){var p=this.registerMutation(t[l],c);p&&(i=i<0?p.from:Math.min(p.from,i),s=s<0?p.to:Math.max(p.to,s),p.typeOver&&(a=!0))}ke.gecko&&1<c.length&&2==(n=c.filter((function(t){return"BR"==t.nodeName}))).length&&(e=n[0],n=n[1],(e.parentNode&&e.parentNode.parentNode==n.parentNode?n:e).remove()),(-1<i||o)&&(-1<i&&(this.view.docView.markDirty(i,s),o=this.view,or||(or=!0,"normal"==getComputedStyle(o.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."))),this.handleDOMChange(i,s,a,c),this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(r)||kn(this.view),this.currentSelection.set(r))}};var or=!(rr.prototype.registerMutation=function(t,e){if(-1<e.indexOf(t.target))return null;var n=this.view.docView.nearestDesc(t.target);if("attributes"==t.type&&(n==this.view.docView||"contenteditable"==t.attributeName||"style"==t.attributeName&&!t.oldValue&&!t.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(t))return null;if("childList"!=t.type)return"attributes"==t.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:{from:n.posAtStart,to:n.posAtEnd,typeOver:t.target.nodeValue==t.oldValue};for(var r=0;r<t.addedNodes.length;r++)e.push(t.addedNodes[r]);if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(t.target))return{from:n.posBefore,to:n.posAfter};var o=t.previousSibling,i=t.nextSibling;if(ke.ie&&ke.ie_version<=11&&t.addedNodes.length)for(var s=0;s<t.addedNodes.length;s++){var a=t.addedNodes[s],c=a.previousSibling;a=a.nextSibling;(!c||Array.prototype.indexOf.call(t.addedNodes,c)<0)&&(o=c),(!a||Array.prototype.indexOf.call(t.addedNodes,a)<0)&&(i=a)}var l=o&&o.parentNode==t.target?xe(o)+1:0,p=n.localPosFromDOM(t.target,l,-1);l=i&&i.parentNode==t.target?xe(i):t.target.childNodes.length;return{from:p,to:n.localPosFromDOM(t.target,l,1)}}),ir={},sr={};function ar(t){function e(e){var n=ir[e];t.dom.addEventListener(e,t.eventHandlers[e]=function(e){!function(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(var n=e.target;n!=t.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}(t,e)||pr(t,e)||!t.editable&&e.type in sr||n(t,e)})}for(var n in t.shiftKey=!1,t.mouseDown=null,t.lastKeyCode=null,t.lastKeyCodeTime=0,t.lastClick={time:0,x:0,y:0,type:""},t.lastSelectionOrigin=null,t.lastSelectionTime=0,t.lastIOSEnter=0,t.lastIOSEnterFallbackTimeout=null,t.lastAndroidDelete=0,t.composing=!1,t.composingTimeout=null,t.compositionNodes=[],t.compositionEndedAt=-2e8,t.domObserver=new rr(t,(function(e,n,r,o){return qn(t,e,n,r,o)})),t.domObserver.start(),t.domChangeCount=0,t.eventHandlers=Object.create(null),ir)e(n);ke.safari&&t.dom.addEventListener("input",(function(){return null})),lr(t)}function cr(t,e){t.lastSelectionOrigin=e,t.lastSelectionTime=Date.now()}function lr(t){t.someProp("handleDOMEvents",(function(e){for(var n in e)t.eventHandlers[n]||t.dom.addEventListener(n,t.eventHandlers[n]=function(e){return pr(t,e)})}))}function pr(t,e){return t.someProp("handleDOMEvents",(function(n){return n=n[e.type],!!n&&(n(t,e)||e.defaultPrevented)}))}function dr(t){return{left:t.clientX,top:t.clientY}}function ur(t,e,n,r,o){if(-1==r)return!1;for(var i=t.state.doc.resolve(r),s=i.depth+1;0<s;s--){var a=function(r){if(t.someProp(e,(function(e){return r>i.depth?e(t,n,i.nodeAfter,i.before(r),o,!0):e(t,n,i.node(r),i.before(r),o,!1)})))return{v:!0}}(s);if(a)return a.v}return!1}function hr(t,e,n){t.focused||t.focus(),e=t.state.tr.setSelection(e),"pointer"==n&&e.setMeta("pointer",!0),t.dispatch(e)}function fr(t,e,n,r,o){return ur(t,"handleClickOn",e,n,r)||t.someProp("handleClick",(function(n){return n(t,e,r)}))||(o?function(t,e){if(-1!=e){var n,r,o=t.state.selection;o instanceof oe&&(n=o.node);for(var i=t.state.doc.resolve(e),s=i.depth+1;0<s;s--){var a=s>i.depth?i.nodeAfter:i.node(s);if(oe.isSelectable(a)){r=n&&0<o.$from.depth&&s>=o.$from.depth&&i.before(o.$from.depth+1)==o.$from.pos?i.before(o.$from.depth):i.before(s);break}}return null!=r&&(hr(t,oe.create(t.state.doc,r),"pointer"),!0)}}:function(t,e){if(-1!=e){var n=t.state.doc.resolve(e);return!!((e=n.nodeAfter)&&e.isAtom&&oe.isSelectable(e))&&(hr(t,new oe(n),"pointer"),!0)}})(t,n)}function mr(t,e,n,r){return ur(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",(function(n){return n(t,e,r)}))||function(t,e,n){if(0!=n.button)return!1;var r=t.state.doc;if(-1==e)return!!r.inlineContent&&(hr(t,ne.create(r,0,r.content.size),"pointer"),!0);for(var o=r.resolve(e),i=o.depth+1;0<i;i--){var s=i>o.depth?o.nodeAfter:o.node(i),a=o.before(i);if(s.inlineContent)hr(t,ne.create(r,a+1,a+1+s.content.size),"pointer");else{if(!oe.isSelectable(s))continue;hr(t,oe.create(r,a),"pointer")}return!0}}(t,n,r)}function vr(t){return xr(t)}sr.keydown=function(t,e){var n;t.shiftKey=16==e.keyCode||e.shiftKey,br(t,e)||(229!=e.keyCode&&t.domObserver.forceFlush(),t.lastKeyCode=e.keyCode,t.lastKeyCodeTime=Date.now(),!ke.ios||13!=e.keyCode||e.ctrlKey||e.altKey||e.metaKey?t.someProp("handleKeyDown",(function(n){return n(t,e)}))||$n(t,e)?e.preventDefault():cr(t,"key"):(n=Date.now(),t.lastIOSEnter=n,t.lastIOSEnterFallbackTimeout=setTimeout((function(){t.lastIOSEnter==n&&(t.someProp("handleKeyDown",(function(e){return e(t,De(13,"Enter"))})),t.lastIOSEnter=0)}),200)))},sr.keyup=function(t,e){16==e.keyCode&&(t.shiftKey=!1)},sr.keypress=function(t,e){var n,r;br(t,e)||!e.charCode||e.ctrlKey&&!e.altKey||ke.mac&&e.metaKey||(t.someProp("handleKeyPress",(function(n){return n(t,e)}))?e.preventDefault():(n=t.state.selection)instanceof ne&&n.$from.sameParent(n.$to)||(r=String.fromCharCode(e.charCode),t.someProp("handleTextInput",(function(e){return e(t,n.$from.pos,n.$to.pos,r)}))||t.dispatch(t.state.tr.insertText(r).scrollIntoView()),e.preventDefault()))};var gr=ke.mac?"metaKey":"ctrlKey";ir.mousedown=function(t,e){t.shiftKey=e.shiftKey;var n,r,o,i=vr(t),s=Date.now(),a="singleClick";s-t.lastClick.time<500&&(n=e,r=t.lastClick,o=r.x-n.clientX,n=r.y-n.clientY,o*o+n*n<100)&&!e[gr]&&("singleClick"==t.lastClick.type?a="doubleClick":"doubleClick"==t.lastClick.type&&(a="tripleClick")),t.lastClick={time:s,x:e.clientX,y:e.clientY,type:a},s=t.posAtCoords(dr(e)),s&&("singleClick"==a?(t.mouseDown&&t.mouseDown.done(),t.mouseDown=new yr(t,s,e,i)):("doubleClick"==a?function(t,e,n,r){return ur(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",(function(n){return n(t,e,r)}))}:mr)(t,s.pos,s.inside,e)?e.preventDefault():cr(t,"pointer"))};var yr=function(t,e,n,r){var o,i,s=this;this.view=t,this.startDoc=t.state.doc,this.pos=e,this.event=n,this.flushed=r,this.selectNode=n[gr],this.allowDefault=n.shiftKey,i=-1<e.inside?(o=t.state.doc.nodeAt(e.inside),e.inside):(o=(i=t.state.doc.resolve(e.pos)).parent,i.depth?i.before():0),this.mightDrag=null,r=r?null:n.target,r=r?t.docView.nearestDesc(r,!0):null,this.target=r?r.dom:null,r=t.state.selection,(0==n.button&&o.type.spec.draggable&&!1!==o.type.spec.selectable||r instanceof oe&&r.from<=i&&r.to>i)&&(this.mightDrag={node:o,pos:i,addAttr:this.target&&!this.target.draggable,setUneditable:this.target&&ke.gecko&&!this.target.hasAttribute("contentEditable")}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout((function(){s.view.mouseDown==s&&s.target.setAttribute("contentEditable","false")}),20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),cr(t,"pointer")};function br(t,e){return t.composing||ke.safari&&Math.abs(e.timeStamp-t.compositionEndedAt)<500&&(t.compositionEndedAt=-2e8)}yr.prototype.done=function(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.view.mouseDown=null},yr.prototype.up=function(t){var e;this.done(),this.view.dom.contains(3==t.target.nodeType?t.target.parentNode:t.target)&&(e=this.pos,this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(dr(t))),this.allowDefault||!e?cr(this.view,"pointer"):fr(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():0==t.button&&(this.flushed||ke.safari&&this.mightDrag&&!this.mightDrag.node.isAtom||ke.chrome&&!(this.view.state.selection instanceof ne)&&Math.min(Math.abs(e.pos-this.view.state.selection.from),Math.abs(e.pos-this.view.state.selection.to))<=2)?(hr(this.view,te.near(this.view.state.doc.resolve(e.pos)),"pointer"),t.preventDefault()):cr(this.view,"pointer"))},yr.prototype.move=function(t){!this.allowDefault&&(4<Math.abs(this.event.x-t.clientX)||4<Math.abs(this.event.y-t.clientY))&&(this.allowDefault=!0),cr(this.view,"pointer"),0==t.buttons&&this.done()},ir.touchdown=function(t){vr(t),cr(t,"pointer")},ir.contextmenu=vr;var wr=ke.android?5e3:-1;function kr(t,e){clearTimeout(t.composingTimeout),-1<e&&(t.composingTimeout=setTimeout((function(){return xr(t)}),e))}function Or(t){for(t.composing=!1;0<t.compositionNodes.length;)t.compositionNodes.pop().markParentsDirty()}function xr(t,e){return t.domObserver.forceFlush(),Or(t),!(!e&&!t.docView.dirty)&&(e=bn(t),e&&!e.eq(t.state.selection)?t.dispatch(t.state.tr.setSelection(e)):t.updateState(t.state),!0)}sr.compositionstart=sr.compositionupdate=function(t){if(!t.composing){t.domObserver.flush();var e=t.state,n=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some((function(t){return!1===t.type.spec.inclusive}))))t.markCursor=t.state.storedMarks||n.marks(),xr(t,!0),t.markCursor=null;else if(xr(t),ke.gecko&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length)for(var r=t.root.getSelection(),o=r.focusNode,i=r.focusOffset;o&&1==o.nodeType&&0!=i;){var s=i<0?o.lastChild:o.childNodes[i-1];if(!s)break;if(3==s.nodeType){r.collapse(s,s.nodeValue.length);break}o=s,i=-1}t.composing=!0}kr(t,wr)},sr.compositionend=function(t,e){t.composing&&(t.composing=!1,t.compositionEndedAt=e.timeStamp,kr(t,20))};var Mr=ke.ie&&ke.ie_version<15||ke.ios&&ke.webkit_version<604;function Sr(t,e,n,r){var o=Un(t,e,n,t.shiftKey,t.state.selection.$from);return t.someProp("handlePaste",(function(e){return e(t,r,o||j.empty)}))?1:o?(n=0==(n=o).openStart&&0==n.openEnd&&1==n.content.childCount?n.content.firstChild:null,n=n?t.state.tr.replaceSelectionWith(n,t.shiftKey):t.state.tr.replaceSelection(o),t.dispatch(n.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),1):void 0}function Cr(t,e){this.slice=t,this.move=e}ir.copy=sr.cut=function(t,e){var n,r,o,i,s=t.state.selection,a="cut"==e.type;s.empty||(r=Mr?null:e.clipboardData,s=(i=Kn(t,s.content())).dom,i=i.text,r?(e.preventDefault(),r.clearData(),r.setData("text/html",s.innerHTML),r.setData("text/plain",i)):(r=s,(n=t).dom.parentNode&&((o=n.dom.parentNode.appendChild(document.createElement("div"))).appendChild(r),o.style.cssText="position: fixed; left: -10000px; top: 10px",i=getSelection(),(s=document.createRange()).selectNodeContents(r),n.dom.blur(),i.removeAllRanges(),i.addRange(s),setTimeout((function(){o.parentNode&&o.parentNode.removeChild(o),n.focus()}),50))),a&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut")))},sr.paste=function(t,e){var n,r,o,i,s=Mr?null:e.clipboardData;s&&Sr(t,s.getData("text/plain"),s.getData("text/html"),e)?e.preventDefault():(r=e,(n=t).dom.parentNode&&(o=n.shiftKey||n.state.selection.$from.parent.type.spec.code,i=n.dom.parentNode.appendChild(document.createElement(o?"textarea":"div")),o||(i.contentEditable="true"),i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout((function(){n.focus(),i.parentNode&&i.parentNode.removeChild(i),o?Sr(n,i.value,null,r):Sr(n,i.textContent,i.innerHTML,r)}),50)))};var Tr,Nr=ke.mac?"altKey":"ctrlKey";for(Tr in ir.dragstart=function(t,e){var n,r,o,i=t.mouseDown;i&&i.done(),e.dataTransfer&&((n=(r=t.state.selection).empty?null:t.posAtCoords(dr(e)))&&n.pos>=r.from&&n.pos<=(r instanceof oe?r.to-1:r.to)||(i&&i.mightDrag?t.dispatch(t.state.tr.setSelection(oe.create(t.state.doc,i.mightDrag.pos))):!e.target||1!=e.target.nodeType||(o=t.docView.nearestDesc(e.target,!0))&&o.node.type.spec.draggable&&o!=t.docView&&t.dispatch(t.state.tr.setSelection(oe.create(t.state.doc,o.posBefore)))),r=t.state.selection.content(),o=(i=Kn(t,r)).dom,i=i.text,e.dataTransfer.clearData(),e.dataTransfer.setData(Mr?"Text":"text/html",o.innerHTML),e.dataTransfer.effectAllowed="copyMove",Mr||e.dataTransfer.setData("text/plain",i),t.dragging=new Cr(r,!e[Nr]))},ir.dragend=function(t){var e=t.dragging;window.setTimeout((function(){t.dragging==e&&(t.dragging=null)}),50)},sr.dragover=sr.dragenter=function(t,e){return e.preventDefault()},sr.drop=function(t,e){var n,r,o,i,s,a,c,l=t.dragging;t.dragging=null,e.dataTransfer&&(!(a=t.posAtCoords(dr(e)))||(s=t.state.doc.resolve(a.pos))&&((n=l&&l.slice)?t.someProp("transformPasted",(function(t){n=t(n)})):n=Un(t,e.dataTransfer.getData(Mr?"Text":"text/plain"),Mr?null:e.dataTransfer.getData("text/html"),!1,s),r=l&&!e[Nr],t.someProp("handleDrop",(function(o){return o(t,e,n||j.empty,r)}))?e.preventDefault():n&&(e.preventDefault(),null==(o=n?$t(t.state.doc,s.pos,n):s.pos)&&(o=s.pos),i=t.state.tr,r&&i.deleteSelection(),a=i.mapping.map(o),l=0==n.openStart&&0==n.openEnd&&1==n.content.childCount,s=i.doc,l?i.replaceRangeWith(a,a,n.content.firstChild):i.replaceRange(a,a,n),i.doc.eq(s)||(a=i.doc.resolve(a),l&&oe.isSelectable(n.content.firstChild)&&a.nodeAfter&&a.nodeAfter.sameMarkup(n.content.firstChild)?i.setSelection(new oe(a)):(c=i.mapping.map(o),i.mapping.maps[i.mapping.maps.length-1].forEach((function(t,e,n,r){return c=r})),i.setSelection(Nn(t,a,i.doc.resolve(c)))),t.focus(),t.dispatch(i.setMeta("uiEvent","drop"))))))},ir.focus=function(t){t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout((function(){t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.root.getSelection())&&kn(t)}),20))},ir.blur=function(t){t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),t.domObserver.currentSelection.set({}),t.focused=!1)},ir.beforeinput=function(t,e){var n;ke.chrome&&ke.android&&"deleteContentBackward"==e.inputType&&(n=t.domChangeCount,setTimeout((function(){var e;t.domChangeCount==n&&(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",(function(e){return e(t,De(8,"Backspace"))}))||(e=t.state.selection.$cursor)&&0<e.pos&&t.dispatch(t.state.tr.delete(e.pos-1,e.pos).scrollIntoView()))}),50))},sr)ir[Tr]=sr[Tr];function Ar(t,e){if(t==e)return!0;for(var n in t)if(t[n]!==e[n])return!1;for(var r in e)if(!(r in t))return!1;return!0}function Er(t,e){this.spec=e||Vr,this.side=this.spec.side||0,this.toDOM=t}function Dr(t,e){this.spec=e||Vr,this.attrs=t}function _r(t,e){this.spec=e||Vr,this.attrs=t}Er.prototype.map=function(t,e,n,r){return e=t.mapResult(e.from+r,this.side<0?-1:1),r=e.pos,e.deleted?null:new jr(r-n,r-n,this)},Er.prototype.valid=function(){return!0},Er.prototype.eq=function(t){return this==t||t instanceof Er&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&Ar(this.spec,t.spec))},Dr.prototype.map=function(t,e,n,r){var o=t.map(e.from+r,this.spec.inclusiveStart?-1:1)-n;n=t.map(e.to+r,this.spec.inclusiveEnd?1:-1)-n;return n<=o?null:new jr(o,n,this)},Dr.prototype.valid=function(t,e){return e.from<e.to},Dr.prototype.eq=function(t){return this==t||t instanceof Dr&&Ar(this.attrs,t.attrs)&&Ar(this.spec,t.spec)},Dr.is=function(t){return t.type instanceof Dr},_r.prototype.map=function(t,e,n,r){var o=t.mapResult(e.from+r,1);return o.deleted?null:(r=t.mapResult(e.to+r,-1),r.deleted||r.pos<=o.pos?null:new jr(o.pos-n,r.pos-n,this))},_r.prototype.valid=function(t,e){var n=t.content.findIndex(e.from),r=n.index;n=n.offset;return n==e.from&&n+t.child(r).nodeSize==e.to},_r.prototype.eq=function(t){return this==t||t instanceof _r&&Ar(this.attrs,t.attrs)&&Ar(this.spec,t.spec)};var jr=function(t,e,n){this.from=t,this.to=e,this.type=n},Ir={spec:{configurable:!0},inline:{configurable:!0}};jr.prototype.copy=function(t,e){return new jr(t,e,this.type)},jr.prototype.eq=function(t,e){return void 0===e&&(e=0),this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to},jr.prototype.map=function(t,e,n){return this.type.map(t,this,e,n)},jr.widget=function(t,e,n){return new jr(t,t,new Er(e,n))},jr.inline=function(t,e,n,r){return new jr(t,e,new Dr(n,r))},jr.node=function(t,e,n,r){return new jr(t,e,new _r(n,r))},Ir.spec.get=function(){return this.type.spec},Ir.inline.get=function(){return this.type instanceof Dr},Object.defineProperties(jr.prototype,Ir);var zr=[],Vr={},Rr=function(t,e){this.local=t&&t.length?t:zr,this.children=e&&e.length?e:zr};Rr.create=function(t,e){return e.length?Fr(e,t,0,Vr):Lr},Rr.prototype.find=function(t,e,n){var r=[];return this.findInner(null==t?0:t,null==e?1e9:e,r,0,n),r},Rr.prototype.findInner=function(t,e,n,r,o){for(var i=0;i<this.local.length;i++){var s=this.local[i];s.from<=e&&s.to>=t&&(!o||o(s.spec))&&n.push(s.copy(s.from+r,s.to+r))}for(var a,c=0;c<this.children.length;c+=3)this.children[c]<e&&this.children[c+1]>t&&(a=this.children[c]+1,this.children[c+2].findInner(t-a,e-a,n,r+a,o))},Rr.prototype.map=function(t,e,n){return this==Lr||0==t.maps.length?this:this.mapInner(t,e,0,0,n||Vr)},Rr.prototype.mapInner=function(t,e,n,r,o){for(var i,s=0;s<this.local.length;s++){var a=this.local[s].map(t,n,r);a&&a.type.valid(e,a)?(i=i||[]).push(a):o.onRemove&&o.onRemove(this.local[s].spec)}return this.children.length?function(t,e,n,r,o,i,s){for(var a=t.slice(),c=function(t,e,n,r){for(var s=0;s<a.length;s+=3){var c=a[s+1],l=void 0;-1==c||c+i<t||(e>=a[s]+i?a[s+1]=-1:o<=n&&(l=r-n-(e-t))&&(a[s]+=l,a[s+1]+=l))}},l=0;l<n.maps.length;l++)n.maps[l].forEach(c);for(var p=!1,d=0;d<a.length;d+=3){var u,h,f,m,v;-1==a[d+1]&&(v=n.map(t[d]+i),(u=v-o)<0||u>=r.content.size?p=!0:(h=n.map(t[d+1]+i,-1)-o,f=r.content.findIndex(u),m=f.index,f=f.offset,(m=r.maybeChild(m))&&f==u&&f+m.nodeSize==h?(v=a[d+2].mapInner(n,m,v+1,t[d]+i+1,s))!=Lr?(a[d]=u,a[d+1]=h,a[d+2]=v):(a[d+1]=-2,p=!0):p=!0))}if(p){var g=Fr(function(t,e,n,r,o,i,s){for(var a=0;a<t.length;a+=3)-1==t[a+1]&&function t(e,i){for(var a=0;a<e.local.length;a++){var c=e.local[a].map(r,o,i);c?n.push(c):s.onRemove&&s.onRemove(e.local[a].spec)}for(var l=0;l<e.children.length;l+=3)t(e.children[l+2],e.children[l]+i+1)}(t[a+2],e[a]+i+1);return n}(a,t,e||[],n,o,i,s),r,0,s);e=g.local;for(var y=0;y<a.length;y+=3)a[y+1]<0&&(a.splice(y,3),y-=3);for(var b=0,w=0;b<g.children.length;b+=3){for(var k=g.children[b];w<a.length&&a[w]<k;)w+=3;a.splice(w,0,g.children[b],g.children[b+1],g.children[b+2])}}return new Rr(e&&e.sort(qr),a)}(this.children,i,t,e,n,r,o):i?new Rr(i.sort(qr)):Lr},Rr.prototype.add=function(t,e){return e.length?this==Lr?Rr.create(t,e):this.addInner(t,e,0):this},Rr.prototype.addInner=function(t,e,n){var r,o=this,i=0;t.forEach((function(t,s){var a,c=s+n;if(a=Hr(e,t,c)){for(r=r||o.children.slice();i<r.length&&r[i]<s;)i+=3;r[i]==s?r[i+2]=r[i+2].addInner(t,a,c+1):r.splice(i,0,s,s+t.nodeSize,Fr(a,t,c+1,Vr)),i+=3}}));for(var s=Pr(i?$r(e):e,-n),a=0;a<s.length;a++)s[a].type.valid(t,s[a])||s.splice(a--,1);return new Rr(s.length?this.local.concat(s).sort(qr):this.local,r||this.children)},Rr.prototype.remove=function(t){return 0==t.length||this==Lr?this:this.removeInner(t,0)},Rr.prototype.removeInner=function(t,e){for(var n=this.children,r=this.local,o=0;o<n.length;o+=3){for(var i,s,a=void 0,c=n[o]+e,l=n[o+1]+e,p=0;p<t.length;p++)(i=t[p])&&i.from>c&&i.to<l&&(t[p]=null,(a=a||[]).push(i));a&&((s=(n=n==this.children?this.children.slice():n)[o+2].removeInner(a,c+1))!=Lr?n[o+2]=s:(n.splice(o,3),o-=3))}if(r.length)for(var d,u=0;u<t.length;u++)if(d=t[u])for(var h=0;h<r.length;h++)r[h].eq(d,e)&&(r=r==this.local?this.local.slice():r).splice(h--,1);return n==this.children&&r==this.local?this:r.length||n.length?new Rr(r,n):Lr},Rr.prototype.forChild=function(t,e){if(this==Lr)return this;if(e.isLeaf)return Rr.empty;for(var n,r,o=0;o<this.children.length;o+=3)if(this.children[o]>=t){this.children[o]==t&&(n=this.children[o+2]);break}for(var i=t+1,s=i+e.content.size,a=0;a<this.local.length;a++){var c,l,p=this.local[a];p.from<s&&p.to>i&&p.type instanceof Dr&&(c=Math.max(i,p.from)-i)<(l=Math.min(s,p.to)-i)&&(r=r||[]).push(p.copy(c,l))}return r?(e=new Rr(r.sort(qr)),n?new Br([e,n]):e):n||Lr},Rr.prototype.eq=function(t){if(this==t)return!0;if(!(t instanceof Rr)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(var e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(var n=0;n<this.children.length;n+=3)if(this.children[n]!=t.children[n]||this.children[n+1]!=t.children[n+1]||!this.children[n+2].eq(t.children[n+2]))return!1;return!0},Rr.prototype.locals=function(t){return Jr(this.localsInner(t))},Rr.prototype.localsInner=function(t){if(this==Lr)return zr;if(t.inlineContent||!this.local.some(Dr.is))return this.local;for(var e=[],n=0;n<this.local.length;n++)this.local[n].type instanceof Dr||e.push(this.local[n]);return e};var Lr=new Rr;Rr.empty=Lr,Rr.removeOverlap=Jr;var Br=function(t){this.members=t};function Pr(t,e){if(!e||!t.length)return t;for(var n=[],r=0;r<t.length;r++){var o=t[r];n.push(new jr(o.from+e,o.to+e,o.type))}return n}function Hr(t,e,n){if(e.isLeaf)return null;for(var r,o=n+e.nodeSize,i=null,s=0;s<t.length;s++)(r=t[s])&&r.from>n&&r.to<o&&((i=i||[]).push(r),t[s]=null);return i}function $r(t){for(var e=[],n=0;n<t.length;n++)null!=t[n]&&e.push(t[n]);return e}function Fr(t,e,n,r){var o=[],i=!1;e.forEach((function(e,s){var a=Hr(t,e,s+n);a&&(i=!0,(a=Fr(a,e,n+s+1,r))!=Lr&&o.push(s,s+e.nodeSize,a))}));for(var s=Pr(i?$r(t):t,-n).sort(qr),a=0;a<s.length;a++)s[a].type.valid(e,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||o.length?new Rr(s,o):Lr}function qr(t,e){return t.from-e.from||t.to-e.to}function Jr(t){for(var e=t,n=0;n<e.length-1;n++){var r=e[n];if(r.from!=r.to)for(var o=n+1;o<e.length;o++){var i=e[o];if(i.from!=r.from){i.from<r.to&&((e=e==t?t.slice():e)[n]=r.copy(r.from,i.from),Wr(e,o,r.copy(i.from,r.to)));break}i.to!=r.to&&((e=e==t?t.slice():e)[o]=i.copy(i.from,r.to),Wr(e,o+1,i.copy(r.to,i.to)))}}return e}function Wr(t,e,n){for(;e<t.length&&0<qr(n,t[e]);)e++;t.splice(e,0,n)}function Kr(t){var e=[];return t.someProp("decorations",(function(n){n=n(t.state),n&&n!=Lr&&e.push(n)})),t.cursorWrapper&&e.push(Rr.create(t.state.doc,[t.cursorWrapper.deco])),Br.from(e)}function Ur(t,e){this._props=e,this.state=e.state,this.dispatch=this.dispatch.bind(this),this._root=null,this.focused=!1,this.trackWrites=null,this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):t.apply?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=Qr(this),this.markCursor=null,this.cursorWrapper=null,Yr(this),this.nodeViews=Zr(this),this.docView=on(this.state.doc,Xr(this),Kr(this),this.dom,this),this.lastSelectedViewDesc=null,this.dragging=null,ar(this),this.pluginViews=[],this.updatePluginViews()}Br.prototype.forChild=function(t,e){if(e.isLeaf)return Rr.empty;for(var n=[],r=0;r<this.members.length;r++){var o=this.members[r].forChild(t,e);o!=Lr&&(o instanceof Br?n=n.concat(o.members):n.push(o))}return Br.from(n)},Br.prototype.eq=function(t){if(!(t instanceof Br)||t.members.length!=this.members.length)return!1;for(var e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0},Br.prototype.locals=function(t){for(var e,n,r=!0,o=0;o<this.members.length;o++)if((n=this.members[o].localsInner(t)).length)if(e){r&&(e=e.slice(),r=!1);for(var i=0;i<n.length;i++)e.push(n[i])}else e=n;return e?Jr(r?e:e.sort(qr)):zr},Br.from=function(t){switch(t.length){case 0:return Lr;case 1:return t[0];default:return new Br(t)}};var Gr={props:{configurable:!0},root:{configurable:!0}};function Xr(t){var e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",(function(n){if(n="function"==typeof n?n(t.state):n)for(var r in n)"class"==r?e.class+=" "+n[r]:e[r]||"contenteditable"==r||"nodeName"==r||(e[r]=String(n[r]))})),[jr.node(0,t.state.doc.content.size,e)]}function Yr(t){var e;t.markCursor?((e=document.createElement("img")).setAttribute("mark-placeholder","true"),t.cursorWrapper={dom:e,deco:jr.widget(t.state.selection.head,e,{raw:!0,marks:t.markCursor})}):t.cursorWrapper=null}function Qr(t){return!t.someProp("editable",(function(e){return!1===e(t.state)}))}function Zr(t){var e={};return t.someProp("nodeViews",(function(t){for(var n in t)Object.prototype.hasOwnProperty.call(e,n)||(e[n]=t[n])})),e}Gr.props.get=function(){if(this._props.state!=this.state){var t,e=this._props;for(t in this._props={},e)this._props[t]=e[t];this._props.state=this.state}return this._props},Ur.prototype.update=function(t){t.handleDOMEvents!=this._props.handleDOMEvents&&lr(this),this._props=t,this.updateStateInner(t.state,!0)},Ur.prototype.setProps=function(t){var e,n,r={};for(e in this._props)r[e]=this._props[e];for(n in r.state=this.state,t)r[n]=t[n];this.update(r)},Ur.prototype.updateState=function(t){this.updateStateInner(t,this.state.plugins!=t.plugins)},Ur.prototype.updateStateInner=function(t,e){var n=this,r=this.state,o=!1,i=!1;t.storedMarks&&this.composing&&(Or(this),i=!0),this.state=t,e&&(function(t,e){var n,r,o=0,i=0;for(n in t){if(t[n]!=e[n])return!0;o++}for(r in e)i++;return o!=i}(h=Zr(this),this.nodeViews)&&(this.nodeViews=h,o=!0),lr(this)),this.editable=Qr(this),Yr(this);var s=Kr(this),a=Xr(this),c=e?"reset":t.scrollToSelection>r.scrollToSelection?"to selection":"preserve",l=o||!this.docView.matchesNode(t.doc,a,s);!l&&t.selection.eq(r.selection)||(i=!0);var p,d,u,h="preserve"==c&&i&&null==this.dom.style.overflowAnchor&&function(t){for(var e,n,r=t.dom.getBoundingClientRect(),o=Math.max(0,r.top),i=(r.left+r.right)/2,s=o+1;s<Math.min(innerHeight,r.bottom);s+=5){var a=t.root.elementFromPoint(i,s);if(a!=t.dom&&t.dom.contains(a)){var c=a.getBoundingClientRect();if(c.top>=o-20){e=a,n=c.top;break}}}return{refDOM:e,refTop:n,stack:Ie(t.dom)}}(this);i&&(this.domObserver.stop(),d=l&&(ke.ie||ke.chrome)&&!this.composing&&!r.selection.empty&&!t.selection.empty&&(e=r.selection,i=t.selection,d=Math.min(e.$anchor.sharedDepth(e.head),i.$anchor.sharedDepth(i.head)),e.$anchor.start(d)!=i.$anchor.start(d)),l&&(p=ke.chrome?this.trackWrites=this.root.getSelection().focusNode:null,!o&&this.docView.update(t.doc,a,s,this)||(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=on(t.doc,a,s,this.dom,this)),p&&!this.trackWrites&&(d=!0)),d||!(this.mouseDown&&this.domObserver.currentSelection.eq(this.root.getSelection())&&(p=(s=this).docView.domFromPos(s.state.selection.anchor,0),s=s.root.getSelection(),Oe(p.node,p.offset,s.anchorNode,s.anchorOffset)))?kn(this,d):(Cn(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()),this.updatePluginViews(r),"reset"==c?this.dom.scrollTop=0:"to selection"==c?(u=this.root.getSelection().focusNode,this.someProp("handleScrollToSelection",(function(t){return t(n)}))||(t.selection instanceof oe?je(this,this.docView.domAfterPos(t.selection.from).getBoundingClientRect(),u):je(this,this.coordsAtPos(t.selection.head,1),u))):h&&(t=(c=h).refDOM,u=h.refTop,c=h.stack,t=t?t.getBoundingClientRect().top:0,ze(c,0==t?0:t-u))},Ur.prototype.destroyPluginViews=function(){for(var t;t=this.pluginViews.pop();)t.destroy&&t.destroy()},Ur.prototype.updatePluginViews=function(t){if(t&&t.plugins==this.state.plugins)for(var e=0;e<this.pluginViews.length;e++){var n=this.pluginViews[e];n.update&&n.update(this,t)}else{this.destroyPluginViews();for(var r=0;r<this.state.plugins.length;r++){var o=this.state.plugins[r];o.spec.view&&this.pluginViews.push(o.spec.view(this))}}},Ur.prototype.someProp=function(t,e){var n,r=this._props&&this._props[t];if(null!=r&&(n=e?e(r):r))return n;var o=this.state.plugins;if(o)for(var i=0;i<o.length;i++){var s=o[i].props[t];if(null!=s&&(n=e?e(s):s))return n}},Ur.prototype.hasFocus=function(){return this.root.activeElement==this.dom},Ur.prototype.focus=function(){this.domObserver.stop(),this.editable&&function(t){if(t.setActive)return t.setActive();if(Ve)return t.focus(Ve);var e=Ie(t);t.focus(null==Ve?{get preventScroll(){return Ve={preventScroll:!0},!0}}:void 0),Ve||(Ve=!1,ze(e,0))}(this.dom),kn(this),this.domObserver.start()},Gr.root.get=function(){var t=this._root;if(null==t)for(var e=this.dom.parentNode;e;e=e.parentNode)if(9==e.nodeType||11==e.nodeType&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=function(){return document.getSelection()}),this._root=e;return t||document},Ur.prototype.posAtCoords=function(t){return Be(this,t)},Ur.prototype.coordsAtPos=function(t,e){return $e(this,t,e=void 0===e?1:e)},Ur.prototype.domAtPos=function(t,e){return this.docView.domFromPos(t,e=void 0===e?0:e)},Ur.prototype.nodeDOM=function(t){return t=this.docView.descAt(t),t?t.nodeDOM:null},Ur.prototype.posAtDOM=function(t,e,n){if(n=this.docView.posFromDOM(t,e,n=void 0===n?-1:n),null==n)throw new RangeError("DOM position not inside the editor");return n},Ur.prototype.endOfTextblock=function(t,e){return Xe(this,e||this.state,t)},Ur.prototype.destroy=function(){this.docView&&(function(t){for(var e in t.domObserver.stop(),t.eventHandlers)t.dom.removeEventListener(e,t.eventHandlers[e]);clearTimeout(t.composingTimeout),clearTimeout(t.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Kr(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)},Ur.prototype.dispatchEvent=function(t){var e;pr(e=this,t=t)||!ir[t.type]||!e.editable&&t.type in sr||ir[t.type](e,t)},Ur.prototype.dispatch=function(t){var e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))},Object.defineProperties(Ur.prototype,Gr);for(var to={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},eo={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},no="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),ro="undefined"!=typeof navigator&&/Apple Computer/.test(navigator.vendor),oo=(Qe="undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),Ye="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),"undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent)),io=no&&(Ye||+no[1]<57)||Qe&&Ye,so=0;so<10;so++)to[48+so]=to[96+so]=String(so);for(so=1;so<=24;so++)to[so+111]="F"+so;var ao;for(so=65;so<=90;so++)to[so]=String.fromCharCode(so+32),eo[so]=String.fromCharCode(so);for(ao in to)eo.hasOwnProperty(ao)||(eo[ao]=to[ao]);var co="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);function lo(t){var e,n=Object.create(null);for(e in t)n[function(t){var e,n,r,o,i=t.split(/-(?!$)/);"Space"==(t=i[i.length-1])&&(t=" ");for(var s=0;s<i.length-1;s++){var a=i[s];if(/^(cmd|meta|m)$/i.test(a))o=!0;else if(/^a(lt)?$/i.test(a))e=!0;else if(/^(c|ctrl|control)$/i.test(a))n=!0;else if(/^s(hift)?$/i.test(a))r=!0;else{if(!/^mod$/i.test(a))throw new Error("Unrecognized modifier name: "+a);co?o=!0:n=!0}}return e&&(t="Alt-"+t),n&&(t="Ctrl-"+t),o&&(t="Meta-"+t),r?"Shift-"+t:t}(e)]=t[e];return n}function po(t,e,n){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),!1!==n&&e.shiftKey?"Shift-"+t:t}function uo(t){var e=lo(t);return function(t,n){var r=(i=n,i="Down"==(i="Right"==(i="Up"==(i="Left"==(i="Del"==(i="Esc"==(i=!(io&&(i.ctrlKey||i.altKey||i.metaKey)||(ro||oo)&&i.shiftKey&&i.key&&1==i.key.length)&&i.key||(i.shiftKey?eo:to)[i.keyCode]||i.key||"Unidentified")?"Escape":i)?"Delete":i)?"ArrowLeft":i)?"ArrowUp":i)?"ArrowRight":i)?"ArrowDown":i),o=1==r.length&&" "!=r,i=e[po(r,n,!o)];if(i&&i(t.state,t.dispatch,t))return!0;if(o&&(n.shiftKey||n.altKey||n.metaKey||127<r.charCodeAt(0))&&(s=to[n.keyCode])&&s!=r){var s=e[po(s,n,!0)];if(s&&s(t.state,t.dispatch,t))return!0}else if(o&&n.shiftKey&&(n=e[po(r,n,!0)],n&&n(t.state,t.dispatch,t)))return!0;return!1}}function ho(t,e){var n;this.match=t,this.handler="string"==typeof e?(n=e,function(t,e,r,o){var i,s,a=n;return e[1]&&(i=e[0].lastIndexOf(e[1]),a+=e[0].slice(i+e[1].length),0<(s=(r+=i)-o)&&(a=e[0].slice(i-s,i)+a,r=o)),t.tr.insertText(a,r,o)}):e}var fo=500;function mo(t,e,n,r,o,i){if(t.composing)return!1;var s=t.state,a=s.doc.resolve(e);if(a.parent.type.spec.code)return!1;for(var c=a.parent.textBetween(Math.max(0,a.parentOffset-fo),a.parentOffset,null,"￼")+r,l=0;l<o.length;l++){var p=o[l].match.exec(c);p=p&&o[l].handler(s,p,e-(p[0].length-r.length),n);if(p)return t.dispatch(p.setMeta(i,{transform:p,from:e,to:n,text:r})),!0}return!1}function vo(t,e,n,r){return new ho(t,(function(t,o,i,s){var a=n instanceof Function?n(o):n;t=t.tr.delete(i,s),s=t.doc.resolve(i).blockRange(),a=s&&Rt(s,e,a);return a?(t.wrap(s,a),a=t.doc.resolve(i-1).nodeBefore,a&&a.type==e&&Pt(t.doc,i-1)&&(!r||r(o,a))&&t.join(i-1),t):null}))}function go(t,e,n){return new ho(t,(function(t,r,o,i){var s=t.doc.resolve(o);r=n instanceof Function?n(r):n;return s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),e)?t.tr.delete(o,i).setBlockType(o,o,e,r):null}))}function yo(t,e){return!t.selection.empty&&(e&&e(t.tr.deleteSelection().scrollIntoView()),!0)}function bo(t,e,n){var r=t.selection.$cursor;if(!r||(n?!n.endOfTextblock("backward",t):0<r.parentOffset))return!1;var o=Oo(r);if(!o){n=r.blockRange();var i=n&&Vt(n);return null!=i&&(e&&e(t.tr.lift(n,i).scrollIntoView()),!0)}return i=o.nodeBefore,!(i.type.spec.isolating||!Io(t,o,e))||(0!=r.parent.content.size||!wo(i,"end")&&!oe.isSelectable(i)?!(!i.isAtom||o.depth!=r.depth-1)&&(e&&e(t.tr.delete(o.pos-i.nodeSize,o.pos).scrollIntoView()),!0):(e&&((r=t.tr.deleteRange(r.before(),r.after())).setSelection(wo(i,"end")?te.findFrom(r.doc.resolve(r.mapping.map(o.pos,-1)),-1):oe.create(r.doc,o.pos-i.nodeSize)),e(r.scrollIntoView())),!0))}function wo(t,e,n){for(;t;t="start"==e?t.firstChild:t.lastChild){if(t.isTextblock)return 1;if(n&&1!=t.childCount)return}}function ko(t,e,n){var r=t.selection,o=r.$head,i=o;if(!r.empty)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):0<o.parentOffset)return!1;i=Oo(o)}return o=i&&i.nodeBefore,!(!o||!oe.isSelectable(o))&&(e&&e(t.tr.setSelection(oe.create(t.doc,i.pos-o.nodeSize)).scrollIntoView()),!0)}function Oo(t){if(!t.parent.type.spec.isolating)for(var e=t.depth-1;0<=e;e--){if(0<t.index(e))return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function xo(t,e,n){var r=t.selection.$cursor;if(!r||(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size))return!1;var o=So(r);return!!o&&(n=o.nodeAfter,!!Io(t,o,e)||(0!=r.parent.content.size||!wo(n,"start")&&!oe.isSelectable(n)?!(!n.isAtom||o.depth!=r.depth-1)&&(e&&e(t.tr.delete(o.pos,o.pos+n.nodeSize).scrollIntoView()),!0):(e&&((r=t.tr.deleteRange(r.before(),r.after())).setSelection(wo(n,"start")?te.findFrom(r.doc.resolve(r.mapping.map(o.pos)),1):oe.create(r.doc,r.mapping.map(o.pos))),e(r.scrollIntoView())),!0)))}function Mo(t,e,n){var r=t.selection,o=r.$head,i=o;if(!r.empty)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):o.parentOffset<o.parent.content.size)return!1;i=So(o)}return o=i&&i.nodeAfter,!(!o||!oe.isSelectable(o))&&(e&&e(t.tr.setSelection(oe.create(t.doc,i.pos)).scrollIntoView()),!0)}function So(t){if(!t.parent.type.spec.isolating)for(var e=t.depth-1;0<=e;e--){var n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}function Co(t,e){var n=t.selection,r=n.$from;n=n.$to,r=r.blockRange(n),n=r&&Vt(r);return null!=n&&(e&&e(t.tr.lift(r,n).scrollIntoView()),!0)}function To(t,e){var n=t.selection,r=n.$head;n=n.$anchor;return!(!r.parent.type.spec.code||!r.sameParent(n))&&(e&&e(t.tr.insertText("\n").scrollIntoView()),!0)}function No(t){for(var e=0;e<t.edgeCount;e++){var n=t.edge(e).type;if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function Ao(t,e){var n=t.selection,r=n.$head,o=n.$anchor;if(!r.parent.type.spec.code||!r.sameParent(o))return!1;var i=r.node(-1);n=r.indexAfter(-1),o=No(i.contentMatchAt(n));return!!i.canReplaceWith(n,n,o)&&(e&&(r=r.after(),(o=t.tr.replaceWith(r,r,o.createAndFill())).setSelection(te.near(o.doc.resolve(r),1)),e(o.scrollIntoView())),!0)}function Eo(t,e){var n=t.selection,r=n.$from,o=n.$to;return!(n instanceof se||r.parent.inlineContent||o.parent.inlineContent)&&(n=No(o.parent.contentMatchAt(o.indexAfter())),!(!n||!n.isTextblock)&&(e&&(o=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,(n=t.tr.insert(o,n.createAndFill())).setSelection(ne.create(n.doc,o+1)),e(n.scrollIntoView())),!0))}function Do(t,e){var n=t.selection.$cursor;if(!n||n.parent.content.size)return!1;if(1<n.depth&&n.after()!=n.end(-1)){var r=n.before();if(Bt(t.doc,r))return e&&e(t.tr.split(r).scrollIntoView()),!0}return r=n.blockRange(),n=r&&Vt(r),null!=n&&(e&&e(t.tr.lift(r,n).scrollIntoView()),!0)}function _o(t,e){var n,r,o=t.selection,i=o.$from,s=o.$to;return t.selection instanceof oe&&t.selection.node.isBlock?!(!i.parentOffset||!Bt(t.doc,i.pos))&&(e&&e(t.tr.split(i.pos).scrollIntoView()),!0):!!i.parent.isBlock&&(e&&(r=s.parentOffset==s.parent.content.size,n=t.tr,(t.selection instanceof ne||t.selection instanceof se)&&n.deleteSelection(),o=0==i.depth?null:No(i.node(-1).contentMatchAt(i.indexAfter(-1))),s=r&&o?[{type:o}]:null,t=Bt(n.doc,n.mapping.map(i.pos),1,s),s||t||!Bt(n.doc,n.mapping.map(i.pos),1,o&&[{type:o}])||(s=[{type:o}],t=!0),t&&(n.split(n.mapping.map(i.pos),1,s),r||i.parentOffset||i.parent.type==o||(r=n.mapping.map(i.before()),r=n.doc.resolve(r),i.node(-1).canReplaceWith(r.index(),r.index()+1,o)&&n.setNodeMarkup(n.mapping.map(i.before()),o))),e(n.scrollIntoView())),!0)}function jo(t,e){return e&&e(t.tr.setSelection(new se(t.doc))),!0}function Io(t,e,n){var r,o,i=e.nodeBefore,s=e.nodeAfter;if(!i.type.spec.isolating&&!s.type.spec.isolating){if(a=t,c=n,l=(u=e).nodeBefore,p=u.nodeAfter,d=u.index(),l&&p&&l.type.compatibleContent(p.type)&&(!l.content.size&&u.parent.canReplace(d-1,d)?(c&&c(a.tr.delete(u.pos-l.nodeSize,u.pos).scrollIntoView()),1):u.parent.canReplace(d,d+1)&&(p.isTextblock||Pt(a.doc,u.pos))&&(c&&c(a.tr.clearIncompatible(u.pos,l.type,l.contentMatchAt(l.childCount)).join(u.pos).scrollIntoView()),1)))return 1;var a,c,l,p,d,u=e.parent.canReplace(e.index(),e.index()+1);if(u&&(r=(o=i.contentMatchAt(i.childCount)).findWrapping(s.type))&&o.matchType(r[0]||s.type).validEnd){if(n){for(var h=e.pos+s.nodeSize,f=C.empty,m=r.length-1;0<=m;m--)f=C.from(r[m].create(null,f));f=C.from(i.copy(f));var v=t.tr.step(new It(e.pos-1,h,e.pos,h,new j(f,1,0),r.length,!0));h=h+2*r.length;Pt(v.doc,h)&&v.join(h),n(v.scrollIntoView())}return 1}if(h=te.findFrom(e,1),v=h&&h.$from.blockRange(h.$to),h=v&&Vt(v),null!=h&&h>=e.depth)return n&&n(t.tr.lift(v,h).scrollIntoView()),1;if(u&&wo(s,"start",!0)&&wo(i,"end")){for(var g=i,y=[];y.push(g),!g.isTextblock;)g=g.lastChild;for(var b=s,w=1;!b.isTextblock;b=b.firstChild)w++;if(g.canReplace(g.childCount,g.childCount,b.content)){if(n){for(var k=C.empty,O=y.length-1;0<=O;O--)k=C.from(y[O].copy(k));n(t.tr.step(new It(e.pos-y.length,e.pos+s.nodeSize,e.pos+w,e.pos+s.nodeSize-w,new j(k,y.length,0),0,!0)).scrollIntoView())}return 1}}}}function zo(t,e){return function(n,r){var o=n.selection,i=o.$from;o=o.$to,i=i.blockRange(o),o=i&&Rt(i,t,e);return!!o&&(r&&r(n.tr.wrap(i,o).scrollIntoView()),!0)}}function Vo(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return function(e,n,r){for(var o=0;o<t.length;o++)if(t[o](e,n,r))return!0;return!1}}new ho(/--$/,"—"),new ho(/\.\.\.$/,"…"),new ho(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"“"),new ho(/"$/,"”"),new ho(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"‘"),new ho(/'$/,"’");Ir=Vo(yo,bo,ko),Gr=Vo(yo,xo,Mo);var Ro,Lo={Enter:Vo(To,Eo,Do,_o),"Mod-Enter":Ao,Backspace:Ir,"Mod-Backspace":Ir,Delete:Gr,"Mod-Delete":Gr,"Mod-a":jo},Bo={"Ctrl-h":Lo.Backspace,"Alt-Backspace":Lo["Mod-Backspace"],"Ctrl-d":Lo.Delete,"Ctrl-Alt-Backspace":Lo["Mod-Delete"],"Alt-Delete":Lo["Mod-Delete"],"Alt-d":Lo["Mod-Delete"]};for(Ro in Lo)Bo[Ro]=Lo[Ro];function Po(t,e){return function(n,r){var o=n.selection,i=o.$from,s=o.$to,a=i.blockRange(s),c=!1,l=a;if(!a)return!1;if(2<=a.depth&&i.node(a.depth-1).type.compatibleContent(t)&&0==a.startIndex){if(0==i.index(a.depth-1))return!1;o=n.doc.resolve(a.start-2),l=new U(o,o,a.depth),a.endIndex<a.parent.childCount&&(a=new U(i,n.doc.resolve(s.end(a.depth)),a.depth)),c=!0}return l=Rt(l,t,e,a),!!l&&(r&&r(function(t,e,n,r,o){for(var i=C.empty,s=n.length-1;0<=s;s--)i=C.from(n[s].type.create(n[s].attrs,i));t.step(new It(e.start-(r?2:0),e.end,e.start,e.end,new j(i,0,0),n.length,!0));for(var a=0,c=0;c<n.length;c++)n[c].type==o&&(a=c+1);for(var l=n.length-a,p=e.start+n.length-(r?2:0),d=e.parent,u=e.startIndex,h=e.endIndex,f=!0;u<h;u++,f=!1)!f&&Bt(t.doc,p,l)&&(t.split(p,l),p+=2*l),p+=d.child(u).nodeSize;return t}(n.tr,a,l,c,t).scrollIntoView()),!0)}}function Ho(t){return function(e,n){var r=e.selection,o=r.$from;r=r.$to,r=o.blockRange(r,(function(e){return e.childCount&&e.firstChild.type==t}));return!!r&&(!n||(o.node(r.depth-1).type==t?function(t,e,n,r){var o=t.tr,i=r.end;t=r.$to.end(r.depth);return i<t&&(o.step(new It(i-1,t,i,t,new j(C.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new U(o.doc.resolve(r.$from.pos),o.doc.resolve(t),r.depth)),e(o.lift(r,Vt(r)).scrollIntoView()),!0}(e,n,t,r):function(t,e,n){for(var r=t.tr,o=n.parent,i=n.end,s=n.endIndex-1,a=n.startIndex;a<s;s--)i-=o.child(s).nodeSize,r.delete(i-1,i+1);var c=r.doc.resolve(n.start),l=c.nodeAfter,p=0==n.startIndex,d=n.endIndex==o.childCount;t=c.node(-1),n=c.index(-1);return!!t.canReplace(n+(p?0:1),n+1,l.content.append(d?C.empty:C.from(o)))&&(c=c.pos,l=c+l.nodeSize,r.step(new It(c-(p?1:0),l+(d?1:0),c+1,l-1,new j((p?C.empty:C.from(o.copy(C.empty))).append(d?C.empty:C.from(o.copy(C.empty))),p?0:1,d?0:1),p?0:1)),e(r.scrollIntoView()),!0)}(e,n,r)))}}function $o(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function Fo(t,e){if("string"!=typeof t)return t;if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}function qo(t,e){const n=Fo(e,t.schema);var{from:r,to:e}=t.selection;let o=[];return t.doc.nodesBetween(r,e,t=>{o=[...o,t]}),e=o.reverse().find(t=>t.type.name===n.name),e?{...e.attrs}:{}}function Jo(t,e){if("string"!=typeof t)return t;if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}function Wo(t,e){const n=Jo(e,t.schema);var{from:r,to:o,empty:e}=t.selection;let i=[];return e?i=t.selection.$head.marks():t.doc.nodesBetween(r,o,t=>{i=[...i,...t.marks]}),o=i.find(t=>t.type.name===n.name),o?{...o.attrs}:{}}function Ko(t,e){const n=Object.keys(e);return!n.length||!!n.filter(n=>e[n]===t[n]).length}function Uo(t,e,n={}){const{from:r,to:o,empty:i}=t.selection,s=e?Fo(e,t.schema):null;let a=[];return t.doc.nodesBetween(r,o,(t,e)=>{var n;t.isText||(n=Math.max(r,e),e=Math.min(o,e+t.nodeSize),a=[...a,{node:t,from:n,to:e}])}),i?!!a.filter(t=>!s||s.name===t.node.type.name).find(t=>Ko(t.node.attrs,n)):o-r<=a.filter(t=>!s||s.name===t.node.type.name).filter(t=>Ko(t.node.attrs,n)).reduce((t,e)=>t+(e.to-e.from),0)}function Go(t,e,n={}){const{from:r,to:o,empty:i}=t.selection,s=e?Jo(e,t.schema):null;if(i)return!!(t.storedMarks||t.selection.$from.marks()).filter(t=>!s||s.name===t.type.name).find(t=>Ko(t.attrs,n));let a=0,c=[];return t.doc.nodesBetween(r,o,(t,e)=>{if(t.isText){const n=Math.max(r,e),i=Math.min(o,e+t.nodeSize);e=i-n,a+=e,c=[...c,...t.marks.map(t=>({mark:t,from:n,to:i}))]}}),0!==a&&(e=c.filter(t=>!s||s.name===t.mark.type.name).filter(t=>Ko(t.mark.attrs,n)).reduce((t,e)=>t+(e.to-e.from),0),t=c.filter(t=>!s||t.mark.type!==s&&t.mark.type.excludes(s)).reduce((t,e)=>t+(e.to-e.from),0),(0<e?e+t:e)>=a)}function Xo(t){return t=`<body>${t}</body>`,(new window.DOMParser).parseFromString(t,"text/html").body}function Yo(e,n,r){if(r={slice:!0,parseOptions:{},...r},"object"==typeof e&&null!==e)try{return Array.isArray(e)?C.fromArray(e.map(t=>n.nodeFromJSON(t))):n.nodeFromJSON(e)}catch(t){return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",t),Yo("",n,r)}if("string"!=typeof e)return Yo("",n,r);{const t=ht.fromSchema(n);return r.slice?t.parseSlice(Xo(e),r.parseOptions).content:t.parse(Xo(e),r.parseOptions)}}function Qo(t,e,n={}){return Yo(t,e,{slice:!1,parseOptions:n})}function Zo(t,e){t=kt.fromSchema(e).serializeFragment(t.content);const n=document.implementation.createHTMLDocument(),r=n.createElement("div");return r.appendChild(t),r.innerHTML}"undefined"!=typeof navigator?/Mac/.test(navigator.platform):"undefined"!=typeof os&&os.platform();class ti{constructor(t,e){this.editor=t,this.commands=e}createCommands(){var{commands:t,editor:e}=this;const{state:n,view:r}=e,{tr:o}=n,i=this.buildProps(o);return Object.fromEntries(Object.entries(t).map(([t,e])=>[t,(...t)=>(t=e(...t)(i),o.getMeta("preventDispatch")||r.dispatch(o),t)]))}createChain(t,e=!0){var{commands:n,editor:r}=this;const{state:o,view:i}=r,s=[],a=!!t,c=t||o.tr,l={...Object.fromEntries(Object.entries(n).map(([t,n])=>[t,(...t)=>{var r=this.buildProps(c,e);r=n(...t)(r);return s.push(r),l}])),run:()=>(a||!e||c.getMeta("preventDispatch")||i.dispatch(c),s.every(t=>!0===t))};return l}createCan(t){var{commands:e,editor:n}=this,{state:n}=n;const r=t||n.tr,o=this.buildProps(r,void 0);return{...Object.fromEntries(Object.entries(e).map(([t,e])=>[t,(...t)=>e(...t)({...o,dispatch:void 0})])),chain:()=>this.createChain(r,void 0)}}buildProps(t,e=!0){const{editor:n,commands:r}=this;var{state:o,view:i}=n;o.storedMarks&&t.setStoredMarks(o.storedMarks);const s={tr:t,editor:n,view:i,state:this.chainableState(t,o),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(r).map(([t,e])=>[t,(...t)=>e(...t)(s)]))}};return s}chainableState(t,e){let{selection:n}=t,{doc:r}=t,{storedMarks:o}=t;return{...e,schema:e.schema,plugins:e.plugins,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return n},get doc(){return r},get tr(){return n=t.selection,r=t.doc,o=t.storedMarks,t}}}}function ei(t,e,n={}){return void 0===t.config[e]&&t.parent?ei(t.parent,e,n):"function"!=typeof t.config[e]?t.config[e]:t.config[e].bind({...n,parent:t.parent?ei(t.parent,e,n):null})}function ni(t){return{baseExtensions:t.filter(t=>"extension"===t.type),nodeExtensions:t.filter(t=>"node"===t.type),markExtensions:t.filter(t=>"mark"===t.type)}}function ri(t){const e=[];var{nodeExtensions:n,markExtensions:r}=ni(t);const o=[...n,...r],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0};return t.forEach(t=>{const n=ei(t,"addGlobalAttributes",{name:t.name,options:t.options});if(n){const t=n();t.forEach(t=>{t.types.forEach(n=>{Object.entries(t.attributes).forEach(([t,r])=>{e.push({type:n,name:t,attribute:{...i,...r}})})})})}}),o.forEach(t=>{var n={name:t.name,options:t.options};const r=ei(t,"addAttributes",n);r&&(n=r(),Object.entries(n).forEach(([n,r])=>{e.push({type:t.name,name:n,attribute:{...i,...r}})}))}),e}function oi(...t){return t.filter(t=>!!t).reduce((t,e)=>{const n={...t};return Object.entries(e).forEach(([t,e])=>{n[t]?n[t]="class"===t?[n[t],e].join(" "):"style"===t?[n[t],e].join("; "):e:n[t]=e}),n},{})}function ii(t,e){return e.filter(t=>t.attribute.rendered).map(e=>e.attribute.renderHTML?e.attribute.renderHTML(t.attrs)||{}:{[e.name]:t.attrs[e.name]}).reduce((t,e)=>oi(t,e),{})}function si(t,e){return t.style?t:{...t,getAttrs:n=>{var r=t.getAttrs?t.getAttrs(n):t.attrs;if(!1===r)return!1;var o=e.filter(t=>t.attribute.rendered).reduce((t,e)=>{var r=e.attribute.parseHTML?e.attribute.parseHTML(n)||{}:{[e.name]:"string"!=typeof(r=n.getAttribute(e.name))?r:r.match(/^\d*(\.\d+)?$/)?Number(r):"true"===r||"false"!==r&&r};r=Object.fromEntries(Object.entries(r).filter(([,t])=>null!=t));return{...t,...r}},{});return{...r,...o}}}}function ai(t,e,...n){return"function"==typeof t?(e?t.bind(e):t)(...n):t}function ci(t){return Object.fromEntries(Object.entries(t).filter(([t,e])=>("attrs"!==t||([t={}]=[e],0!==Object.keys(t).length||t.constructor!==Object))&&null!=e))}function li(t){const e=ri(t),{nodeExtensions:n,markExtensions:r}=ni(t);var o=null===(s=n.find(t=>ei(t,"topNode")))||void 0===s?void 0:s.name,i=Object.fromEntries(n.map(n=>{const r=e.filter(t=>t.type===n.name),o={name:n.name,options:n.options},i=ci({...t.reduce((t,e)=>{const r=ei(e,"extendNodeSchema",o);return{...t,...r?r(n):{}}},{}),content:ai(ei(n,"content",o)),marks:ai(ei(n,"marks",o)),group:ai(ei(n,"group",o)),inline:ai(ei(n,"inline",o)),atom:ai(ei(n,"atom",o)),selectable:ai(ei(n,"selectable",o)),draggable:ai(ei(n,"draggable",o)),code:ai(ei(n,"code",o)),defining:ai(ei(n,"defining",o)),isolating:ai(ei(n,"isolating",o)),attrs:Object.fromEntries(r.map(t=>[t.name,{default:null===(t=null==t?void 0:t.attribute)||void 0===t?void 0:t.default}]))}),s=ai(ei(n,"parseHTML",o));s&&(i.parseDOM=s.map(t=>si(t,r)));const a=ei(n,"renderHTML",o);return a&&(i.toDOM=t=>a({node:t,HTMLAttributes:ii(t,r)})),[n.name,i]})),s=Object.fromEntries(r.map(n=>{const r=e.filter(t=>t.type===n.name),o={name:n.name,options:n.options},i=ci({...t.reduce((t,e)=>{const r=ei(e,"extendMarkSchema",o);return{...t,...r?r(n):{}}},{}),inclusive:ai(ei(n,"inclusive",o)),excludes:ai(ei(n,"excludes",o)),group:ai(ei(n,"group",o)),spanning:ai(ei(n,"spanning",o)),attrs:Object.fromEntries(r.map(t=>[t.name,{default:null===(t=null==t?void 0:t.attribute)||void 0===t?void 0:t.default}]))}),s=ai(ei(n,"parseHTML",o));s&&(i.parseDOM=s.map(t=>si(t,r)));const a=ei(n,"renderHTML",o);return a&&(i.toDOM=t=>a({mark:t,HTMLAttributes:ii(t,r)})),[n.name,i]}));return new dt({topNode:o,nodes:i,marks:s})}function pi(t,e){return e.nodes[t]||e.marks[t]||null}class di{constructor(t,e){this.splittableMarks=[],this.editor=e,this.extensions=di.resolve(t),this.schema=li(this.extensions),this.extensions.forEach(t=>{var e={name:t.name,options:t.options,editor:this.editor,type:pi(t.name,this.schema)};"mark"!==t.type||null!==(n=ai(ei(t,"keepOnSplit",e)))&&void 0!==n&&!n||this.splittableMarks.push(t.name);var n=ei(t,"onBeforeCreate",e);n&&this.editor.on("beforeCreate",n),n=ei(t,"onCreate",e),n&&this.editor.on("create",n),n=ei(t,"onUpdate",e),n&&this.editor.on("update",n),n=ei(t,"onSelectionUpdate",e),n&&this.editor.on("selectionUpdate",n),n=ei(t,"onTransaction",e),n&&this.editor.on("transaction",n),n=ei(t,"onFocus",e),n&&this.editor.on("focus",n),n=ei(t,"onBlur",e),n&&this.editor.on("blur",n),e=ei(t,"onDestroy",e),e&&this.editor.on("destroy",e)})}static resolve(t){return di.sort(di.flatten(t))}static flatten(t){return t.map(t=>{const e=ei(t,"addExtensions",{name:t.name,options:t.options});return e?[t,...this.flatten(e())]:t}).flat(10)}static sort(t){return t.sort((t,e)=>(t=ei(t,"priority")||100,e=ei(e,"priority")||100,e<t?-1:t<e?1:0))}get commands(){return this.extensions.reduce((t,e)=>{const n=ei(e,"addCommands",{name:e.name,options:e.options,editor:this.editor,type:pi(e.name,this.schema)});return n?{...t,...n()}:t},{})}get plugins(){return[...this.extensions].reverse().map(t=>{var e,n,r,o,i={name:t.name,options:t.options,editor:this.editor,type:pi(t.name,this.schema)};const s=[],a=ei(t,"addKeyboardShortcuts",i);a&&(e=Object.fromEntries(Object.entries(a()).map(([t,e])=>[t,()=>e({editor:this.editor})])),e=new ge({props:{handleKeyDown:uo(e)}}),s.push(e));const c=ei(t,"addInputRules",i);this.editor.options.enableInputRules&&c&&(o=(o=c()).length?[(n={rules:o}.rules,r=new ge({state:{init:function(){return null},apply:function(t,e){var n=t.getMeta(this);return n||(t.selectionSet||t.docChanged?null:e)}},props:{handleTextInput:function(t,e,o,i){return mo(t,e,o,i,n,r)},handleDOMEvents:{compositionend:function(t){setTimeout((function(){var e=t.state.selection.$cursor;e&&mo(t,e.pos,e.pos,"",n,r)}))}}},isInputRules:!0}))]:[],s.push(...o));const l=ei(t,"addPasteRules",i);this.editor.options.enablePasteRules&&l&&(o=l(),s.push(...o));const p=ei(t,"addProseMirrorPlugins",i);return p&&(i=p(),s.push(...i)),s}).flat()}get attributes(){return ri(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=ni(this.extensions);return Object.fromEntries(e.filter(t=>!!ei(t,"addNodeView")).map(e=>{const n=this.attributes.filter(t=>t.type===e.name);var r={name:e.name,options:e.options,editor:t,type:Fo(e.name,this.schema)};const o=ei(e,"addNodeView",r);return o?[e.name,(r,i,s,a)=>{var c=ii(r,n);return o()({editor:t,node:r,getPos:s,decorations:a,HTMLAttributes:c,extension:e})}]:[]}))}get textSerializers(){const{editor:t}=this,{nodeExtensions:e}=ni(this.extensions);return Object.fromEntries(e.filter(t=>!!ei(t,"renderText")).map(e=>{const n=ei(e,"renderText",{name:e.name,options:e.options,editor:t,type:Fo(e.name,this.schema)});return n?[e.name,t=>n(t)]:[]}))}}function ui(t){return"Object"===Object.prototype.toString.call(t).slice(8,-1)&&t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function hi(t,e){const n={...t};return ui(t)&&ui(e)&&Object.keys(e).forEach(r=>{ui(e[r])&&r in t?n[r]=hi(t[r],e[r]):Object.assign(n,{[r]:e[r]})}),n}class fi{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,this.options=this.config.defaultOptions}static create(t={}){return new fi(t)}configure(t={}){const e=this.extend();return e.options=hi(this.options,t),e}extend(t={}){const e=new fi(t);return(e.parent=this).child=e,e.name=t.name||e.parent.name,e.options=t.defaultOptions||e.parent.options,e}}no=fi.create({name:"editable",addProseMirrorPlugins(){return[new ge({key:new we("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{var{editor:t}=this,{from:e,to:n}=t.state.selection;return((t,e,n,r,o)=>{let i="",s=!0;return t.state.doc.nodesBetween(e,n,(a,c)=>{var l;const p=t.extensionManager.textSerializers[a.type.name];p?(i+=p({node:a}),s=!r):a.isText?(i+=null===(l=null==a?void 0:a.text)||void 0===l?void 0:l.slice(Math.max(e,c)-c,n-c),s=!r):a.isLeaf&&o?(i+=o,s=!r):!s&&a.isBlock&&(i+=r,s=!0)},0),i})(t,e,n,"\n")}}})]}});var mi=Object.freeze({__proto__:null,blur:()=>({view:t})=>{const e=t.dom;return e.blur(),!0}}),vi=Object.freeze({__proto__:null,clearContent:(t=!1)=>({commands:e})=>e.setContent("",t)}),gi=Object.freeze({__proto__:null,clearNodes:()=>({state:t,tr:e,dispatch:n})=>{var{selection:r}=e;const{ranges:o}=r;return o.forEach(r=>{t.doc.nodesBetween(r.$from.pos,r.$to.pos,(t,r)=>{if(!t.type.isText){const i=e.doc.resolve(e.mapping.map(r));var o=e.doc.resolve(e.mapping.map(r+t.nodeSize));r=i.blockRange(o);r&&(o=Vt(r),t.type.isTextblock&&n&&(({defaultType:t}=i.parent.contentMatchAt(i.index())),e.setNodeMarkup(r.start,t)),(o||0===o)&&n&&e.lift(r,o))}})}),!0}}),yi=Object.freeze({__proto__:null,command:t=>e=>t(e)}),bi=Object.freeze({__proto__:null,createParagraphNear:()=>({state:t,dispatch:e})=>Eo(t,e)}),wi=Object.freeze({__proto__:null,deleteRange:t=>({tr:e,dispatch:n})=>{var{from:r,to:o}=t;return n&&e.delete(r,o),!0}}),ki=Object.freeze({__proto__:null,deleteSelection:()=>({state:t,dispatch:e})=>yo(t,e)}),Oi=Object.freeze({__proto__:null,enter:()=>({commands:t})=>t.keyboardShortcut("Enter")}),xi=Object.freeze({__proto__:null,exitCode:()=>({state:t,dispatch:e})=>Ao(t,e)});function Mi(t,e,n={}){return t.find(t=>t.type===e&&Ko(t.attrs,n))}function Si(t,e,n={}){if(t&&e){var r,o,i,s=t.parent.childAfter(t.parentOffset);if(s.node){const a=Mi(s.node.marks,e,n);if(a){let c=t.index(),l=t.start()+s.offset,p=c+1,d=l+s.node.nodeSize;for(Mi(s.node.marks,e,n);0<c&&a.isInSet(t.parent.child(c-1).marks);)--c,l-=t.parent.child(c).nodeSize;for(;p<t.parent.childCount&&([r,o,i={}]=[t.parent.child(p).marks,e,n],Mi(r,o,i));)d+=t.parent.child(p).nodeSize,p+=1;return{from:l,to:d}}}}}var Ci=Object.freeze({__proto__:null,extendMarkRange:(t,e={})=>({tr:n,state:r,dispatch:o})=>{var i=Jo(t,r.schema),{doc:s,selection:a}=n,{$from:c,from:r,to:a}=a;return!o||(i=Si(c,i,e))&&i.from<=r&&i.to>=a&&(i=ne.create(s,i.from,i.to),n.setSelection(i)),!0}}),Ti=Object.freeze({__proto__:null,first:t=>e=>{const n="function"==typeof t?t(e):t;for(let t=0;t<n.length;t+=1)if(n[t](e))return!0;return!1}});function Ni(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function Ai(t){return t&&"object"==typeof t&&!Array.isArray(t)&&!("class"===(null===(t=(t=t).constructor)||void 0===t?void 0:t.toString().substring(0,5)))}function Ei(t){return Ai(t)&&t instanceof ne}var Di=Object.freeze({__proto__:null,focus:(t=null)=>({editor:e,view:n,tr:r,dispatch:o})=>{if(n.hasFocus()&&null===t||!1===t)return!0;if(o&&null===t&&!Ei(e.state.selection))return n.focus(),!0;var{from:i,to:s}=function(t,e=null){if(!e)return null;if("start"===e||!0===e)return{from:0,to:0};if("end"!==e)return{from:e,to:e};var{size:t}=t.doc.content;return{from:t,to:t}}(e.state,t)||e.state.selection,{doc:a,storedMarks:c}=r,i=Ni(i,0,a.content.size),s=(s=Ni(s,0,a.content.size),ne.create(a,i,s));e=e.state.selection.eq(s);return o&&(r.setSelection(s),e&&c&&r.setStoredMarks(c),n.focus()),!0}}),_i=Object.freeze({__proto__:null,forEach:(t,e)=>n=>t.every((t,r)=>e(t,{...n,index:r}))}),ji=Object.freeze({__proto__:null,insertContent:t=>({tr:e,commands:n})=>n.insertContentAt({from:e.selection.from,to:e.selection.to},t)}),Ii=Object.freeze({__proto__:null,insertContentAt:(t,e)=>({tr:n,dispatch:r,editor:o})=>{if(r){const i=Yo(e,o.schema,{parseOptions:{preserveWhitespace:"full"}});if("<>"===i.toString())return!0;var{from:r,to:o}="number"==typeof t?{from:t,to:t}:t;n.replaceWith(r,o,i),function(t,e,n){var r=t.steps.length-1;if(!(r<e)&&(e=t.steps[r],e instanceof jt||e instanceof It)){const e=t.mapping.maps[r];let o=0;e.forEach((t,e,n,r)=>{0===o&&(o=r)}),t.setSelection(te.near(t.doc.resolve(o),n))}}(n,n.steps.length-1,1)}return!0}}),zi=Object.freeze({__proto__:null,joinBackward:()=>({state:t,dispatch:e})=>bo(t,e)}),Vi=Object.freeze({__proto__:null,joinForward:()=>({state:t,dispatch:e})=>xo(t,e)});const Ri="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);var Li=Object.freeze({__proto__:null,keyboardShortcut:t=>({editor:e,view:n,tr:r,dispatch:o})=>{const i=function(t){var e=t.split(/-(?!$)/);let n,r,o,i,s=e[e.length-1];"Space"===s&&(s=" ");for(let c=0;c<e.length-1;c+=1){var a=e[c];if(/^(cmd|meta|m)$/i.test(a))i=!0;else if(/^a(lt)?$/i.test(a))n=!0;else if(/^(c|ctrl|control)$/i.test(a))r=!0;else if(/^s(hift)?$/i.test(a))o=!0;else{if(!/^mod$/i.test(a))throw new Error("Unrecognized modifier name: "+a);Ri?i=!0:r=!0}}return n&&(s="Alt-"+s),r&&(s="Ctrl-"+s),i&&(s="Meta-"+s),o&&(s="Shift-"+s),s}(t).split(/-(?!$)/);var s=i.find(t=>!["Alt","Ctrl","Meta","Shift"].includes(t));const a=new KeyboardEvent("keydown",{key:"Space"===s?" ":s,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),c=e.captureTransaction(()=>{n.someProp("handleKeyDown",t=>t(n,a))});return null!==c&&void 0!==c&&c.steps.forEach(t=>{t=t.map(r.mapping),t&&o&&r.maybeStep(t)}),!0}}),Bi=Object.freeze({__proto__:null,lift:(t,e={})=>({state:n,dispatch:r})=>!!Uo(n,Fo(t,n.schema),e)&&Co(n,r)}),Pi=Object.freeze({__proto__:null,liftEmptyBlock:()=>({state:t,dispatch:e})=>Do(t,e)}),Hi=Object.freeze({__proto__:null,liftListItem:t=>({state:e,dispatch:n})=>Ho(Fo(t,e.schema))(e,n)}),$i=Object.freeze({__proto__:null,newlineInCode:()=>({state:t,dispatch:e})=>To(t,e)}),Fi=Object.freeze({__proto__:null,replace:(t,e={})=>({state:n,commands:r})=>{console.warn("[tiptap warn]: replace() is deprecated. please use insertContent() instead.");var{from:o,to:n}=n.selection;return r.replaceRange({from:o,to:n},t,e)}}),qi=Object.freeze({__proto__:null,replaceRange:(t,e,n={})=>({tr:r,state:o,dispatch:i})=>{console.warn("[tiptap warn]: replaceRange() is deprecated. please use insertContent() instead.");const s=Fo(e,o.schema);var{from:a,to:o}=t;return i&&r.replaceRangeWith(a,o,s.create(n)),!0}});function Ji(t,e){const n="string"==typeof e?[e]:e;return Object.keys(t).reduce((e,r)=>(n.includes(r)||(e[r]=t[r]),e),{})}var Wi=Object.freeze({__proto__:null,resetAttributes:(t,e)=>({tr:n,state:r,dispatch:o})=>{let i=null,s=null;var a=$o("string"==typeof t?t:t.name,r.schema);return!!a&&("node"===a&&(i=Fo(t,r.schema)),"mark"===a&&(s=Jo(t,r.schema)),o&&n.selection.ranges.forEach(t=>{r.doc.nodesBetween(t.$from.pos,t.$to.pos,(t,r)=>{i&&i===t.type&&n.setNodeMarkup(r,void 0,Ji(t.attrs,e)),s&&t.marks.length&&t.marks.forEach(o=>{s===o.type&&n.addMark(r,r+t.nodeSize,s.create(Ji(o.attrs,e)))})})}),!0)}}),Ki=Object.freeze({__proto__:null,scrollIntoView:()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0)}),Ui=Object.freeze({__proto__:null,selectAll:()=>({state:t,dispatch:e})=>jo(t,e)}),Gi=Object.freeze({__proto__:null,selectNodeBackward:()=>({state:t,dispatch:e})=>ko(t,e)}),Xi=Object.freeze({__proto__:null,selectNodeForward:()=>({state:t,dispatch:e})=>Mo(t,e)}),Yi=Object.freeze({__proto__:null,selectParentNode:()=>({state:t,dispatch:e})=>{return r=e,t=(e=(n=t).selection).$from,e=e.to,0!=(e=t.sharedDepth(e))&&(e=t.before(e),r&&r(n.tr.setSelection(oe.create(n.doc,e))),!0);var n,r}}),Qi=Object.freeze({__proto__:null,setContent:(t,e=!1,n={})=>({tr:r,editor:o,dispatch:i})=>{var{doc:s}=r,s=(o=Qo(t,o.schema,n),ne.create(s,0,s.content.size));return i&&r.setSelection(s).replaceSelectionWith(o,!1).setMeta("preventUpdate",!e),!0}}),Zi=Object.freeze({__proto__:null,setMark:(t,e={})=>({tr:n,state:r,dispatch:o})=>{var{selection:i}=n;const{empty:s,ranges:a}=i,c=Jo(t,r.schema);return o&&(s?(o=Wo(r,c),n.addStoredMark(c.create({...o,...e}))):a.forEach(t=>{const o=t.$from.pos,i=t.$to.pos;r.doc.nodesBetween(o,i,(t,r)=>{const s=Math.max(r,o),a=Math.min(r+t.nodeSize,i);t.marks.find(t=>t.type===c)?t.marks.forEach(t=>{c===t.type&&n.addMark(s,a,c.create({...t.attrs,...e}))}):n.addMark(s,a,c.create(e))})})),!0}}),ts=Object.freeze({__proto__:null,setMeta:(t,e)=>({tr:n})=>(n.setMeta(t,e),!0)}),es=Object.freeze({__proto__:null,setNode:(t,e={})=>({state:n,dispatch:r})=>{var o,i,s=Fo(t,n.schema);return o=s,i=e,function(t,e){var n=t.selection,r=n.from,s=(n=n.to,!1);return t.doc.nodesBetween(r,n,(function(e,n){return!s&&void(e.isTextblock&&!e.hasMarkup(o,i)&&(s=e.type==o||(n=(e=t.doc.resolve(n)).index(),e.parent.canReplaceWith(n,n+1,o))))})),!!s&&(e&&e(t.tr.setBlockType(r,n,o,i).scrollIntoView()),!0)}(n,r)}}),ns=Object.freeze({__proto__:null,setNodeSelection:t=>({tr:e,dispatch:n})=>{var r;return n&&(({doc:r}=e),n=Ni(t,0,r.content.size),n=oe.create(r,n),e.setSelection(n)),!0}}),rs=Object.freeze({__proto__:null,setTextSelection:t=>({tr:e,dispatch:n})=>{var r,o;return n&&(({doc:r}=e),({from:o,to:n}="number"==typeof t?{from:t,to:t}:t),o=Ni(o,0,r.content.size),n=Ni(n,0,r.content.size),n=ne.create(r,o,n),e.setSelection(n)),!0}}),is=Object.freeze({__proto__:null,sinkListItem:t=>({state:e,dispatch:n})=>{var r,o=Fo(t,e.schema);return r=o,function(t,e){var n=t.selection,o=n.$from,i=n.$to,s=o.blockRange(i,(function(t){return t.childCount&&t.firstChild.type==r}));return!!s&&(n=s.startIndex,0!=n&&(o=s.parent,i=o.child(n-1),i.type==r&&(e&&(n=i.lastChild&&i.lastChild.type==o.type,i=C.from(n?r.create():null),o=new j(C.from(r.create(null,C.from(o.type.create(null,i)))),n?3:1,0),i=s.start,s=s.end,e(t.tr.step(new It(i-(n?3:1),s,i,s,o,1,!0)).scrollIntoView())),!0)))}(e,n)}});function ss(t,e,n){return Object.fromEntries(Object.entries(n).filter(([n])=>{var r=t.find(t=>t.type===e&&t.name===n);return!!r&&r.attribute.keepOnSplit}))}function as(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();var r;n&&(r=n.filter(t=>null==e?void 0:e.includes(t.type.name)),t.tr.ensureMarks(r))}var cs=Object.freeze({__proto__:null,splitBlock:({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:o})=>{var{selection:i,doc:s}=e;const{$from:a,$to:c}=i;var l=ss(o.extensionManager.attributes,a.node().type.name,a.node().attrs);if(i instanceof oe&&i.node.isBlock)return!(!a.parentOffset||!Bt(s,a.pos))&&(r&&(t&&as(n,o.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;if(r){r=c.parentOffset===c.parent.content.size,i instanceof ne&&e.deleteSelection(),i=0===a.depth?void 0:function(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(a.node(-1).contentMatchAt(a.indexAfter(-1)));let s=r&&i?[{type:i,attrs:l}]:void 0,p=Bt(e.doc,e.mapping.map(a.pos),1,s);if(s||p||!Bt(e.doc,e.mapping.map(a.pos),1,i?[{type:i}]:void 0)||(p=!0,s=i?[{type:i,attrs:l}]:void 0),p&&(e.split(e.mapping.map(a.pos),1,s),i&&!r&&!a.parentOffset&&a.parent.type!==i)){r=e.mapping.map(a.before());const t=e.doc.resolve(r);a.node(-1).canReplaceWith(t.index(),t.index()+1,i)&&e.setNodeMarkup(e.mapping.map(a.before()),i)}t&&as(n,o.extensionManager.splittableMarks),e.scrollIntoView()}return!0}}),ls=Object.freeze({__proto__:null,splitListItem:t=>({tr:e,state:n,dispatch:r,editor:o})=>{const i=Fo(t,n.schema),{$from:s,$to:a}=n.selection;var c=n.selection.node;if(c&&c.isBlock||s.depth<2||!s.sameParent(a))return!1;const l=s.node(-1);if(l.type!==i)return!1;if(n=o.extensionManager.attributes,0===s.parent.content.size&&s.node(-1).childCount===s.indexAfter(-1)){if(2===s.depth||s.node(-3).type!==i||s.index(-2)!==s.node(-2).childCount-1)return!1;if(r){let t=C.empty;c=s.index(-1)?1:s.index(-2)?2:3;for(let e=s.depth-c;e>=s.depth-3;--e)t=C.from(s.node(e).copy(t));o=s.indexAfter(-1)<s.node(-2).childCount?1:s.indexAfter(-2)<s.node(-3).childCount?2:3;const r=ss(n,s.node().type.name,s.node().attrs),a=(null===(p=i.contentMatch.defaultType)||void 0===p?void 0:p.createAndFill(r))||void 0;t=t.append(C.from(i.createAndFill(null,a)||void 0));var p=s.before(s.depth-(c-1));e.replace(p,s.after(-o),new j(t,4-c,0));let l=-1;e.doc.nodesBetween(p,e.doc.content.size,(t,e)=>!(-1<l)&&void(t.isTextblock&&0===t.content.size&&(l=e+1))),-1<l&&e.setSelection(ne.near(e.doc.resolve(l))),e.scrollIntoView()}return!0}const d=a.pos===s.end()?l.contentMatchAt(0).defaultType:null;p=ss(n,l.type.name,l.attrs);const u=ss(n,s.node().type.name,s.node().attrs);return e.delete(s.pos,a.pos),p=d?[{type:i,attrs:p},{type:d,attrs:u}]:[{type:i,attrs:p}],!!Bt(e.doc,s.pos,2)&&(r&&e.split(s.pos,2,p).scrollIntoView(),!0)}});function ps(t){return e=>function(t,e){for(let r=t.depth;0<r;--r){var n=t.node(r);if(e(n))return{pos:0<r?t.before(r):0,start:t.start(r),depth:r,node:n}}}(e.$from,t)}function ds(t,e){const{nodeExtensions:n}=ni(e);if(e=n.find(e=>e.name===t),!e)return!1;const r=ai(ei(e,"group",{name:e.name,options:e.options}));return"string"==typeof r&&r.split(" ").includes("list")}var us=Object.freeze({__proto__:null,toggleList:(t,e)=>({editor:n,tr:r,state:o,dispatch:i,chain:s,commands:a,can:c})=>{const{extensions:l}=n.extensionManager,p=Fo(t,o.schema);var d=Fo(e,o.schema),{selection:n}=o;const{$from:u,$to:h}=n;if(o=u.blockRange(h),!o)return!1;if(n=ps(t=>ds(t.type.name,l))(n),1<=o.depth&&n&&o.depth-n.depth<=1){if(n.node.type===p)return a.liftListItem(d);if(ds(n.node.type.name,l)&&p.validContent(n.node.content)&&i)return r.setNodeMarkup(n.pos,p),!0}return c().wrapInList(p)?a.wrapInList(p):s().clearNodes().wrapInList(p).run()}}),hs=Object.freeze({__proto__:null,toggleMark:(t,e={})=>({state:n,commands:r})=>{var o=Jo(t,n.schema);return Go(n,o,e)?r.unsetMark(o):r.setMark(o,e)}}),fs=Object.freeze({__proto__:null,toggleNode:(t,e,n={})=>({state:r,commands:o})=>{var i=Fo(t,r.schema),s=Fo(e,r.schema);return Uo(r,i,n)?o.setNode(s):o.setNode(i,n)}}),ms=Object.freeze({__proto__:null,toggleWrap:(t,e={})=>({state:n,dispatch:r})=>{var o=Fo(t,n.schema);return(Uo(n,o,e)?Co:zo(o,e))(n,r)}}),vs=Object.freeze({__proto__:null,undoInputRule:()=>({state:t,dispatch:e})=>function(t,e){for(var n=t.plugins,r=0;r<n.length;r++){var o=n[r],i=void 0;if(o.spec.isInputRules&&(i=o.getState(t))){if(e){for(var s=t.tr,a=i.transform,c=a.steps.length-1;0<=c;c--)s.step(a.steps[c].invert(a.docs[c]));i.text?(o=s.doc.resolve(i.from).marks(),s.replaceWith(i.from,i.to,t.schema.text(i.text,o))):s.delete(i.from,i.to),e(s)}return!0}}return!1}(t,e)}),gs=Object.freeze({__proto__:null,unsetAllMarks:()=>({tr:t,state:e,dispatch:n})=>{var{selection:r}=t;const{empty:o,ranges:i}=r;return o||n&&Object.entries(e.schema.marks).forEach(([,e])=>{i.forEach(n=>{t.removeMark(n.$from.pos,n.$to.pos,e)})}),!0}}),ys=Object.freeze({__proto__:null,unsetMark:t=>({tr:e,state:n,dispatch:r})=>{var{selection:o}=e;const i=Jo(t,n.schema),{$from:s,empty:a,ranges:c}=o;if(r){if(a){let{from:t,to:n}=o;o=Si(s,i),o&&(t=o.from,n=o.to),e.removeMark(t,n,i)}else c.forEach(t=>{e.removeMark(t.$from.pos,t.$to.pos,i)});e.removeStoredMark(i)}return!0}}),bs=Object.freeze({__proto__:null,updateAttributes:(t,e={})=>({tr:n,state:r,dispatch:o})=>{let i=null,s=null;var a=$o("string"==typeof t?t:t.name,r.schema);return!!a&&("node"===a&&(i=Fo(t,r.schema)),"mark"===a&&(s=Jo(t,r.schema)),o&&n.selection.ranges.forEach(t=>{const o=t.$from.pos,a=t.$to.pos;r.doc.nodesBetween(o,a,(t,r)=>{i&&i===t.type&&n.setNodeMarkup(r,void 0,{...t.attrs,...e}),s&&t.marks.length&&t.marks.forEach(i=>{var c,l;s===i.type&&(c=Math.max(r,o),l=Math.min(r+t.nodeSize,a),n.addMark(c,l,s.create({...i.attrs,...e})))})})}),!0)}}),ws=Object.freeze({__proto__:null,wrapIn:(t,e={})=>({state:n,dispatch:r})=>{var o=Fo(t,n.schema);return!Uo(n,o,e)&&zo(o,e)(n,r)}}),ks=Object.freeze({__proto__:null,wrapInList:(t,e={})=>({state:n,dispatch:r})=>Po(Fo(t,n.schema),e)(n,r)}),Os=(Qe=fi.create({name:"commands",addCommands(){return{...mi,...vi,...gi,...yi,...bi,...wi,...ki,...Oi,...xi,...Ci,...Ti,...Di,..._i,...ji,...Ii,...zi,...Vi,...Li,...Bi,...Pi,...Hi,...$i,...Fi,...qi,...Wi,...Ki,...Ui,...Gi,...Xi,...Yi,...Qi,...Zi,...ts,...es,...ns,...rs,...is,...cs,...ls,...us,...hs,...fs,...ms,...vs,...gs,...ys,...bs,...ws,...ks}}}),Ye=fi.create({name:"editable",addProseMirrorPlugins(){return[new ge({key:new we("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Ir=fi.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new ge({key:new we("focusEvents"),props:{attributes:{tabindex:"0"},handleDOMEvents:{focus:(e,n)=>(t.isFocused=!0,n=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1),e.dispatch(n),!1),blur:(e,n)=>(t.isFocused=!1,n=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1),e.dispatch(n),!1)}}})]}}),Gr=fi.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:t})=>[()=>t.undoInputRule(),()=>t.deleteSelection(),()=>t.joinBackward(),()=>t.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:t})=>[()=>t.deleteSelection(),()=>t.joinForward(),()=>t.selectNodeForward()]);return{Enter:()=>this.editor.commands.first(({commands:t})=>[()=>t.newlineInCode(),()=>t.createParagraphNear(),()=>t.liftEmptyBlock(),()=>t.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:()=>t(),"Mod-Backspace":()=>t(),Delete:()=>e(),"Mod-Delete":()=>e()}}}),Object.freeze({__proto__:null,ClipboardTextSerializer:no,Commands:Qe,Editable:Ye,FocusEvents:Ir,Keymap:Gr}));class xs extends class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const n=this.callbacks[t];return n&&n.forEach(t=>t.apply(this,e)),this}off(t,e){const n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter(t=>t!==e):delete this.callbacks[t]),this}removeAllListeners(){this.callbacks={}}}{constructor(t={}){super(),this.isFocused=!1,this.options={element:document.createElement("div"),content:"",injectCSS:!0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get commands(){return this.commandManager.createCommands()}chain(){return this.commandManager.createChain()}can(){return this.commandManager.createCan()}injectCSS(){this.options.injectCSS&&document&&(this.css=function(t){var e=document.querySelector("style[data-tiptap-style]");if(null!==e)return e;const n=document.createElement("style");return n.setAttribute("data-tiptap-style",""),n.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(n),n}('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}'))}setOptions(t={}){this.options={...this.options,...t}}setEditable(t){this.setOptions({editable:t}),this.view&&this.state&&!this.isDestroyed&&this.view.updateState(this.state)}get isEditable(){return this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,e){t="function"==typeof e?e(t,this.state.plugins):[...this.state.plugins,t],t=this.state.reconfigure({plugins:t}),this.view.updateState(t)}unregisterPlugin(t){if(!this.isDestroyed){const e="string"==typeof t?t+"$":t.key;t=this.state.reconfigure({plugins:this.state.plugins.filter(t=>!t.key.startsWith(e))}),this.view.updateState(t)}}createExtensionManager(){var t=[...Object.entries(Os).map(([,t])=>t),...this.options.extensions].filter(t=>["extension","node","mark"].includes(null==t?void 0:t.type));this.extensionManager=new di(t,this)}createCommandManager(){this.commandManager=new ti(this,this.extensionManager.commands)}createSchema(){this.schema=this.extensionManager.schema}createView(){this.view=new Ur(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:fe.create({doc:Qo(this.options.content,this.schema,this.options.parseOptions)})});var t=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(t),this.createNodeViews();const e=this.view.dom;e.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}captureTransaction(t){return this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1,t=this.capturedTransaction,this.capturedTransaction=null,t}dispatchTransaction(t){if(this.isCapturingTransaction)return this.capturedTransaction?void t.steps.forEach(t=>{var e;return null===(e=this.capturedTransaction)||void 0===e?void 0:e.step(t)}):void(this.capturedTransaction=t);var e=this.state.apply(t),n=!this.state.selection.eq(e.selection);this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t}),n&&this.emit("selectionUpdate",{editor:this}),e=t.getMeta("focus"),n=t.getMeta("blur"),e&&this.emit("focus",{editor:this,event:e.event}),n&&this.emit("blur",{editor:this,event:n.event}),t.docChanged&&!t.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return e=this.state,"node"===(t=$o("string"==typeof(n=t)?n:n.name,e.schema))?qo(e,n):"mark"===t?Wo(e,n):{};var e,n}getNodeAttributes(t){return console.warn("[tiptap warn]: editor.getNodeAttributes() is deprecated. please use editor.getAttributes() instead."),qo(this.state,t)}getMarkAttributes(t){return console.warn("[tiptap warn]: editor.getMarkAttributes() is deprecated. please use editor.getAttributes() instead."),Wo(this.state,t)}isActive(t,e){return function(t,e,n={}){if(!e)return Uo(t,null,n)||Go(t,null,n);var r=$o(e,t.schema);return"node"===r?Uo(t,e,n):"mark"===r&&Go(t,e,n)}(this.state,"string"==typeof t?t:null,"string"==typeof t?e:t)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Zo(this.state.doc,this.schema)}get isEmpty(){return t=this.state.doc,e=null===(e=t.type.createAndFill())||void 0===e?void 0:e.toJSON(),t=t.toJSON(),JSON.stringify(e)===JSON.stringify(t);var t,e}getCharacterCount(){return this.state.doc.content.size-2}destroy(){var t;this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners(),(t=this.css)&&t.parentNode&&t.parentNode.removeChild(t)}get isDestroyed(){var t;return!(null!==(t=this.view)&&void 0!==t&&t.docView)}}class Ms{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,this.options=this.config.defaultOptions}static create(t={}){return new Ms(t)}configure(t={}){const e=this.extend();return e.options=hi(this.options,t),e}extend(t={}){const e=new Ms(t);return(e.parent=this).child=e,e.name=t.name||e.parent.name,e.options=t.defaultOptions||e.parent.options,e}}class Ss{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,this.options=this.config.defaultOptions}static create(t={}){return new Ss(t)}configure(t={}){const e=this.extend();return e.options=hi(this.options,t),e}extend(t={}){const e=new Ss(t);return(e.parent=this).child=e,e.name=t.name||e.parent.name,e.options=t.defaultOptions||e.parent.options,e}}function Cs(t,e,n){return new ho(t,(t,r,o,i)=>{var s=n instanceof Function?n(r):n;const{tr:a}=t;var c=r[r.length-1];const l=r[0];var p;if(c){var d=l.search(/\S/);const n=o+l.indexOf(c);if(r=n+c.length,function(t,e,n){let r=[];return n.doc.nodesBetween(t,e,(t,e)=>{r=[...r,...t.marks.map(n=>({from:e,to:e+t.nodeSize,mark:n}))]}),r}(o,i,t).filter(t=>{const{excluded:n}=t.mark.type;return n.find(t=>t.name===e.name)}).filter(t=>t.to>n).length)return null;r<i&&a.delete(r,i),n>o&&a.delete(o+d,n),p=o+d+c.length,a.addMark(o+d,p,e.create(s)),a.removeStoredMark(e)}return a})}function Ts(t,e,n){const r=(o,i)=>{const s=[];return o.forEach(o=>{if(o.isText&&o.text){var{text:a}=o;let r,h=0;for(;null!==(r=t.exec(a));){var c,l,p,d=Math.max(r.length-2,0),u=Math.max(r.length-1,0);null!=i&&i.type.allowsMarkType(e)&&(l=(c=r.index+r[0].indexOf(r[d]))+r[d].length,d=(p=c+r[d].lastIndexOf(r[u]))+r[u].length,u=n instanceof Function?n(r):n,0<c&&s.push(o.cut(h,c)),s.push(o.cut(p,d).mark(e.create(u).addToSet(o.marks))),h=l)}h<a.length&&s.push(o.cut(h))}else s.push(o.copy(r(o.content,o)))}),C.fromArray(s)};return new ge({key:new we("markPasteRule"),props:{transformPasted:t=>new j(r(t.content),t.openStart,t.openEnd)}})}function Ns(t,e,n){var r=t.coordsAtPos(e),o=t.coordsAtPos(n,-1);e=Math.min(r.top,o.top),t=Math.max(r.bottom,o.bottom),n=Math.min(r.left,o.left),o=Math.max(r.right,o.right);const i={top:e,bottom:t,left:n,right:o,width:o-n,height:t-e,x:n,y:e};return{...i,toJSON:()=>i}}var As=n("39c3"),Es=(Ye=n("0ab4"),"tippy-content"),Ds="tippy-backdrop",_s="tippy-arrow",js="tippy-svg-arrow",Is={passive:!0,capture:!0};function zs(t,e,n){if(Array.isArray(t)){var r=t[e];return null==r?Array.isArray(n)?n[e]:n:r}return t}function Vs(t,e){return t={}.toString.call(t),0===t.indexOf("[object")&&-1<t.indexOf(e+"]")}function Rs(t,e){return"function"==typeof t?t.apply(void 0,e):t}function Ls(t,e){return 0===e?t:function(r){clearTimeout(n),n=setTimeout((function(){t(r)}),e)};var n}function Bs(t){return[].concat(t)}function Ps(t,e){-1===t.indexOf(e)&&t.push(e)}function Hs(t){return t.split("-")[0]}function $s(t){return[].slice.call(t)}function Fs(){return document.createElement("div")}function qs(t){return["Element","Fragment"].some((function(e){return Vs(t,e)}))}function Js(t){return Vs(t,"MouseEvent")}function Ws(t){return t&&t._tippy&&t._tippy.reference===t}function Ks(t){return qs(t)?[t]:Vs(t,"NodeList")?$s(t):Array.isArray(t)?t:$s(document.querySelectorAll(t))}function Us(t,e){t.forEach((function(t){t&&(t.style.transitionDuration=e+"ms")}))}function Gs(t,e){t.forEach((function(t){t&&t.setAttribute("data-state",e)}))}function Xs(t){var e=Bs(t)[0];return null!=e&&null!=(t=e.ownerDocument)&&t.body?e.ownerDocument:document}function Ys(t,e,n){var r=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach((function(e){t[r](e,n)}))}var Qs={isTouch:!1},Zs=0;function ta(){Qs.isTouch||(Qs.isTouch=!0,window.performance&&document.addEventListener("mousemove",ea))}function ea(){var t=performance.now();t-Zs<20&&(Qs.isTouch=!1,document.removeEventListener("mousemove",ea)),Zs=t}function na(){var t,e=document.activeElement;Ws(e)&&(t=e._tippy,e.blur&&!t.state.isVisible&&e.blur())}Ir="undefined"!=typeof window&&"undefined"!=typeof document?navigator.userAgent:"";var ra=/MSIE |Trident\//.test(Ir),oa={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},ia=Object.assign({appendTo:function(){return document.body},aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},oa,{},{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),sa=Object.keys(ia);function aa(t){var e=(t.plugins||[]).reduce((function(e,n){var r=n.name;n=n.defaultValue;return r&&(e[r]=void 0!==t[r]?t[r]:n),e}),{});return Object.assign({},t,{},e)}function ca(t,e){var n,r=Object.assign({},e,{content:Rs(e.content,[t])},e.ignoreAttributes?{}:(n=t,((r=e.plugins)?Object.keys(aa(Object.assign({},ia,{plugins:r}))):sa).reduce((function(e,r){var o=(n.getAttribute("data-tippy-"+r)||"").trim();if(!o)return e;if("content"===r)e[r]=o;else try{e[r]=JSON.parse(o)}catch(t){e[r]=o}return e}),{})));return r.aria=Object.assign({},ia.aria,{},r.aria),r.aria={expanded:"auto"===r.aria.expanded?e.interactive:r.aria.expanded,content:"auto"===r.aria.content?e.interactive?null:"describedby":r.aria.content},r}var la=function(){return"innerHTML"};function pa(t,e){t[la()]=e}function da(t){var e=Fs();return!0===t?e.className=_s:(e.className=js,qs(t)?e.appendChild(t):pa(e,t)),e}function ua(t,e){qs(e.content)?(pa(t,""),t.appendChild(e.content)):"function"!=typeof e.content&&(e.allowHTML?pa(t,e.content):t.textContent=e.content)}function ha(t){var e=t.firstElementChild;t=$s(e.children);return{box:e,content:t.find((function(t){return t.classList.contains(Es)})),arrow:t.find((function(t){return t.classList.contains(_s)||t.classList.contains(js)})),backdrop:t.find((function(t){return t.classList.contains(Ds)}))}}function fa(t){var e=Fs(),n=Fs();n.className="tippy-box",n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var r=Fs();function o(n,r){var o=ha(e),i=o.box,s=o.content;o=o.arrow;r.theme?i.setAttribute("data-theme",r.theme):i.removeAttribute("data-theme"),"string"==typeof r.animation?i.setAttribute("data-animation",r.animation):i.removeAttribute("data-animation"),r.inertia?i.setAttribute("data-inertia",""):i.removeAttribute("data-inertia"),i.style.maxWidth="number"==typeof r.maxWidth?r.maxWidth+"px":r.maxWidth,r.role?i.setAttribute("role",r.role):i.removeAttribute("role"),n.content===r.content&&n.allowHTML===r.allowHTML||ua(s,t.props),r.arrow?o?n.arrow!==r.arrow&&(i.removeChild(o),i.appendChild(da(r.arrow))):i.appendChild(da(r.arrow)):o&&i.removeChild(o)}return r.className=Es,r.setAttribute("data-state","hidden"),ua(r,t.props),e.appendChild(n),n.appendChild(r),o(t.props,t.props),{popper:e,onUpdate:o}}fa.$$tippy=!0;var ma=1,va=[],ga=[];function ya(t,e){var n,r,o,i,s,a,c,l,p,d=ca(t,Object.assign({},ia,{},aa((n=e,Object.keys(n).reduce((function(t,e){return void 0!==n[e]&&(t[e]=n[e]),t}),{}))))),u=!1,h=!1,f=!1,m=!1,v=[],g=Ls(W,d.interactiveDebounce),y=ma++,b=(e=(p=d.plugins).filter((function(t,e){return p.indexOf(t)===e})),{id:y,reference:t,popper:Fs(),popperInstance:null,props:d,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:e,clearDelayTimeouts:function(){clearTimeout(r),clearTimeout(o),cancelAnimationFrame(i)},setProps:function(e){var n,r;b.state.isDestroyed||(_("onBeforeUpdate",[b,e]),q(),n=b.props,r=ca(t,Object.assign({},b.props,{},e,{ignoreAttributes:!0})),b.props=r,F(),n.interactiveDebounce!==r.interactiveDebounce&&(z(),g=Ls(W,r.interactiveDebounce)),n.triggerTarget&&!r.triggerTarget?Bs(n.triggerTarget).forEach((function(t){t.removeAttribute("aria-expanded")})):r.triggerTarget&&t.removeAttribute("aria-expanded"),I(),D(),k&&k(n,r),b.popperInstance&&(X(),Q().forEach((function(t){requestAnimationFrame(t._tippy.popperInstance.forceUpdate)}))),_("onAfterUpdate",[b,e]))},setContent:function(t){b.setProps({content:t})},show:function(){var t=b.state.isVisible,e=b.state.isDestroyed,n=!b.state.isEnabled,r=Qs.isTouch&&!b.props.touch,o=zs(b.props.duration,0,ia.duration);t||e||n||r||T().hasAttribute("disabled")||(_("onShow",[b],!1),!1!==b.props.onShow(b)&&(b.state.isVisible=!0,C()&&(w.style.visibility="visible"),D(),B(),b.state.isMounted||(w.style.transition="none"),C()&&(n=A(),r=n.box,n=n.content,Us([r,n],0)),c=function(){var t,e;b.state.isVisible&&!m&&(m=!0,w.offsetHeight,w.style.transition=b.props.moveTransition,C()&&b.props.animation&&(Us([t=(e=A()).box,e=e.content],o),Gs([t,e],"visible")),j(),I(),Ps(ga,b),null!=(e=b.popperInstance)&&e.forceUpdate(),b.state.isMounted=!0,_("onMount",[b]),b.props.animation&&C()&&H(o,(function(){b.state.isShown=!0,_("onShown",[b])})))},function(){var t=b.props.appendTo,e=T();e=b.props.interactive&&t===ia.appendTo||"parent"===t?e.parentNode:Rs(t,[e]),e.contains(w)||e.appendChild(w),X()}()))},hide:function(){var t=!b.state.isVisible,e=b.state.isDestroyed,n=!b.state.isEnabled,r=zs(b.props.duration,1,ia.duration);t||e||n||(_("onHide",[b],!1),!1!==b.props.onHide(b)&&(b.state.isVisible=!1,b.state.isShown=!1,u=m=!1,C()&&(w.style.visibility="hidden"),z(),P(),D(),C()&&(e=A(),n=e.box,e=e.content,b.props.animation&&(Us([n,e],r),Gs([n,e],"hidden"))),j(),I(),b.props.animation?C()&&function(t,e){H(t,(function(){!b.state.isVisible&&w.parentNode&&w.parentNode.contains(w)&&e()}))}(r,b.unmount):b.unmount()))},hideWithInteractivity:function(t){N().addEventListener("mousemove",g),Ps(va,g),g(t)},enable:function(){b.state.isEnabled=!0},disable:function(){b.hide(),b.state.isEnabled=!1},unmount:function(){b.state.isVisible&&b.hide(),b.state.isMounted&&(Y(),Q().forEach((function(t){t._tippy.unmount()})),w.parentNode&&w.parentNode.removeChild(w),ga=ga.filter((function(t){return t!==b})),b.state.isMounted=!1,_("onHidden",[b]))},destroy:function(){b.state.isDestroyed||(b.clearDelayTimeouts(),b.unmount(),q(),delete t._tippy,b.state.isDestroyed=!0,_("onDestroy",[b]))}});if(!d.render)return b;y=d.render(b);var w=y.popper,k=y.onUpdate;w.setAttribute("data-tippy-root",""),w.id="tippy-"+b.id,b.popper=w,t._tippy=b,w._tippy=b;var O=e.map((function(t){return t.fn(b)})),x=t.hasAttribute("aria-expanded");return F(),I(),D(),_("onCreate",[b]),d.showOnCreate&&Z(),w.addEventListener("mouseenter",(function(){b.props.interactive&&b.state.isVisible&&b.clearDelayTimeouts()})),w.addEventListener("mouseleave",(function(t){b.props.interactive&&0<=b.props.trigger.indexOf("mouseenter")&&(N().addEventListener("mousemove",g),g(t))})),b;function M(){var t=b.props.touch;return Array.isArray(t)?t:[t,0]}function S(){return"hold"===M()[0]}function C(){var t;return null!=(t=b.props.render)&&t.$$tippy}function T(){return l||t}function N(){var t=T().parentNode;return t?Xs(t):document}function A(){return ha(w)}function E(t){return b.state.isMounted&&!b.state.isVisible||Qs.isTouch||s&&"focus"===s.type?0:zs(b.props.delay,t?0:1,ia.delay)}function D(){w.style.pointerEvents=b.props.interactive&&b.state.isVisible?"":"none",w.style.zIndex=""+b.props.zIndex}function _(t,e,n){void 0===n&&(n=!0),O.forEach((function(n){n[t]&&n[t].apply(void 0,e)})),n&&(n=b.props)[t].apply(n,e)}function j(){var e,n,r=b.props.aria;r.content&&(e="aria-"+r.content,n=w.id,Bs(b.props.triggerTarget||t).forEach((function(t){var r=t.getAttribute(e);b.state.isVisible?t.setAttribute(e,r?r+" "+n:n):(r=r&&r.replace(n,"").trim())?t.setAttribute(e,r):t.removeAttribute(e)})))}function I(){!x&&b.props.aria.expanded&&Bs(b.props.triggerTarget||t).forEach((function(t){b.props.interactive?t.setAttribute("aria-expanded",b.state.isVisible&&t===T()?"true":"false"):t.removeAttribute("aria-expanded")}))}function z(){N().removeEventListener("mousemove",g),va=va.filter((function(t){return t!==g}))}function V(t){if(!(Qs.isTouch&&(f||"mousedown"===t.type)||b.props.interactive&&w.contains(t.target))){if(T().contains(t.target)){if(Qs.isTouch)return;if(b.state.isVisible&&0<=b.props.trigger.indexOf("click"))return}else _("onClickOutside",[b,t]);!0===b.props.hideOnClick&&(b.clearDelayTimeouts(),b.hide(),h=!0,setTimeout((function(){h=!1})),b.state.isMounted||P())}}function R(){f=!0}function L(){f=!1}function B(){var t=N();t.addEventListener("mousedown",V,!0),t.addEventListener("touchend",V,Is),t.addEventListener("touchstart",L,Is),t.addEventListener("touchmove",R,Is)}function P(){var t=N();t.removeEventListener("mousedown",V,!0),t.removeEventListener("touchend",V,Is),t.removeEventListener("touchstart",L,Is),t.removeEventListener("touchmove",R,Is)}function H(t,e){var n=A().box;function r(t){t.target===n&&(Ys(n,"remove",r),e())}if(0===t)return e();Ys(n,"remove",a),Ys(n,"add",r),a=r}function $(e,n,r){void 0===r&&(r=!1),Bs(b.props.triggerTarget||t).forEach((function(t){t.addEventListener(e,n,r),v.push({node:t,eventType:e,handler:n,options:r})}))}function F(){S()&&($("touchstart",J,{passive:!0}),$("touchend",K,{passive:!0})),b.props.trigger.split(/\s+/).filter(Boolean).forEach((function(t){if("manual"!==t)switch($(t,J),t){case"mouseenter":$("mouseleave",K);break;case"focus":$(ra?"focusout":"blur",U);break;case"focusin":$("focusout",U)}}))}function q(){v.forEach((function(t){var e=t.node,n=t.eventType,r=t.handler;t=t.options;e.removeEventListener(n,r,t)})),v=[]}function J(t){var e,n=!1;!b.state.isEnabled||G(t)||h||(e="focus"===(null==s?void 0:s.type),l=(s=t).currentTarget,I(),!b.state.isVisible&&Js(t)&&va.forEach((function(e){return e(t)})),"click"===t.type&&(b.props.trigger.indexOf("mouseenter")<0||u)&&!1!==b.props.hideOnClick&&b.state.isVisible?n=!0:Z(t),"click"===t.type&&(u=!n),n&&!e&&tt(t))}function W(t){var e,n,r=t.target;r=T().contains(r)||w.contains(r);"mousemove"===t.type&&r||(r=Q().concat(w).map((function(t){var e=null==(e=t._tippy.popperInstance)?void 0:e.state;return e?{popperRect:t.getBoundingClientRect(),popperState:e,props:d}:null})).filter(Boolean),e=t.clientX,n=t.clientY,r.every((function(t){var r=t.popperRect,o=t.popperState,i=t.props.interactiveBorder,s=Hs(o.placement),a=o.modifiersData.offset;if(!a)return!0;var c="bottom"===s?a.top.y:0;t="top"===s?a.bottom.y:0,o="right"===s?a.left.x:0,a="left"===s?a.right.x:0,c=r.top-n+c>i,t=n-r.bottom-t>i,o=r.left-e+o>i,i=e-r.right-a>i;return c||t||o||i}))&&(z(),tt(t)))}function K(t){G(t)||0<=b.props.trigger.indexOf("click")&&u||(b.props.interactive?b.hideWithInteractivity(t):tt(t))}function U(t){b.props.trigger.indexOf("focusin")<0&&t.target!==T()||b.props.interactive&&t.relatedTarget&&w.contains(t.relatedTarget)||tt(t)}function G(t){return!!Qs.isTouch&&S()!==0<=t.type.indexOf("touch")}function X(){Y();var e=b.props,n=e.popperOptions,r=e.placement,o=e.offset,i=e.getReferenceClientRect,s=e.moveTransition;e=C()?ha(w).arrow:null,i=i?{getBoundingClientRect:i,contextElement:i.contextElement||T()}:t,s=[{name:"offset",options:{offset:o}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!s}},{name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(t){var e,n=t.state;C()&&(e=A().box,["placement","reference-hidden","escaped"].forEach((function(t){"placement"===t?e.setAttribute("data-placement",n.placement):n.attributes.popper["data-popper-"+t]?e.setAttribute("data-"+t,""):e.removeAttribute("data-"+t)})),n.attributes.popper={})}}];C()&&e&&s.push({name:"arrow",options:{element:e,padding:3}}),s.push.apply(s,(null==n?void 0:n.modifiers)||[]),b.popperInstance=Object(As.a)(i,w,Object.assign({},n,{placement:r,onFirstUpdate:c,modifiers:s}))}function Y(){b.popperInstance&&(b.popperInstance.destroy(),b.popperInstance=null)}function Q(){return $s(w.querySelectorAll("[data-tippy-root]"))}function Z(t){b.clearDelayTimeouts(),t&&_("onTrigger",[b,t]),B();var e=E(!0),n=M();t=n[0],n=n[1];(e=Qs.isTouch&&"hold"===t&&n?n:e)?r=setTimeout((function(){b.show()}),e):b.show()}function tt(t){b.clearDelayTimeouts(),_("onUntrigger",[b,t]),b.state.isVisible?0<=b.props.trigger.indexOf("mouseenter")&&0<=b.props.trigger.indexOf("click")&&0<=["mouseleave","mousemove"].indexOf(t.type)&&u||((t=E(!1))?o=setTimeout((function(){b.state.isVisible&&b.hide()}),t):i=requestAnimationFrame((function(){b.hide()}))):P()}}function ba(t,e){var n=ia.plugins.concat((e=void 0===e?{}:e).plugins||[]);document.addEventListener("touchstart",ta,Is),window.addEventListener("blur",na);var r=Object.assign({},e,{plugins:n});n=Ks(t).reduce((function(t,e){return e=e&&ya(e,r),e&&t.push(e),t}),[]);return qs(t)?n[0]:n}ba.defaultProps=ia,ba.setDefaultProps=function(t){Object.keys(t).forEach((function(e){ia[e]=t[e]}))},ba.currentInput=Qs,Object.assign({},Ye.a,{effect:function(t){var e=t.state;t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow)}}),ba.setDefaultProps({render:fa});var wa=ba;class ka{constructor({editor:t,element:e,view:n,tippyOptions:r}){this.preventHide=!1,this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:t})=>{var e;this.preventHide?this.preventHide=!1:null!=t&&t.relatedTarget&&null!==(e=this.element.parentNode)&&void 0!==e&&e.contains(t.relatedTarget)||this.hide()},this.editor=t,this.element=e,this.view=n,this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.createTooltip(r),this.element.style.visibility="visible"}createTooltip(t={}){this.tippy=wa(this.view.dom,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle",...t})}update(t,e){var{state:n,composing:r}=t;const{doc:o,selection:i}=n;if(e=e&&e.doc.eq(o)&&e.selection.eq(i),!r&&!e){const{empty:n,ranges:r}=i,s=Math.min(...r.map(t=>t.$from.pos)),a=Math.max(...r.map(t=>t.$to.pos));e=!o.textBetween(s,a).length&&Ei(t.state.selection),n||e?this.hide():(this.tippy.setProps({getReferenceClientRect:()=>{if(Ai(e=t.state.selection)&&e instanceof oe){const e=t.nodeDOM(s);if(e)return e.getBoundingClientRect()}var e;return Ns(t,s,a)}}),this.show())}}show(){this.tippy.show()}hide(){this.tippy.hide()}destroy(){this.tippy.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const Oa=new we("menuBubble"),xa=t=>new ge({key:Oa,view:e=>new ka({view:e,...t})});fi.create({name:"bubbleMenu",defaultOptions:{element:null,tippyOptions:{}},addProseMirrorPlugins(){return this.options.element?[xa({editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions})]:[]}});class Ma{constructor({editor:t,element:e,view:n,tippyOptions:r}){this.preventHide=!1,this.mousedownHandler=()=>{this.preventHide=!0},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:t})=>{var e;this.preventHide?this.preventHide=!1:null!=t&&t.relatedTarget&&null!==(e=this.element.parentNode)&&void 0!==e&&e.contains(t.relatedTarget)||this.hide()},this.editor=t,this.element=e,this.view=n,this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.createTooltip(r),this.element.style.visibility="visible"}createTooltip(t={}){this.tippy=wa(this.view.dom,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"right",hideOnClick:"toggle",...t})}update(t,e){var{state:n,composing:r}=t,{doc:o,selection:n}=n;e=e&&e.doc.eq(o)&&e.selection.eq(n);if(!r&&!e){const{$anchor:r,empty:o,from:i,to:s}=n;e=1===r.depth,n=!n.$anchor.parent.isLeaf&&!n.$anchor.parent.textContent,o&&e&&n?(this.tippy.setProps({getReferenceClientRect:()=>Ns(t,i,s)}),this.show()):this.hide()}}show(){this.tippy.show()}hide(){this.tippy.hide()}destroy(){this.tippy.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const Sa=new we("menuFloating"),Ca=t=>new ge({key:Sa,view:e=>new Ma({view:e,...t})});fi.create({name:"floatingMenu",defaultOptions:{element:null,tippyOptions:{}},addProseMirrorPlugins(){return this.options.element?[Ca({editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions})]:[]}}),Object(r.defineComponent)({name:"BubbleMenu",props:{editor:{type:Object,required:!0},tippyOptions:{type:Object,default:()=>({})}},setup(t,{slots:e}){const n=Object(r.ref)(null);return Object(r.onMounted)(()=>{const{editor:e,tippyOptions:r}=t;e.registerPlugin(xa({editor:e,element:n.value,tippyOptions:r}))}),Object(r.onBeforeUnmount)(()=>{const{editor:e}=t;e.unregisterPlugin(Oa)}),()=>{var t;return Object(r.h)("div",{ref:n},null===(t=e.default)||void 0===t?void 0:t.call(e))}}});class Ta extends xs{constructor(t={}){var e;return super(t),this.vueRenderers=Object(r.reactive)(new Map),this.contentComponent=null,this.reactiveState=(e=this.view.state,Object(r.customRef)((t,n)=>({get(){return t(),e},set(t){e=t,requestAnimationFrame(()=>{requestAnimationFrame(()=>{n()})})}}))),this.on("transaction",()=>{this.reactiveState.value=this.view.state}),Object(r.markRaw)(this)}get state(){return this.reactiveState?this.reactiveState.value:this.view.state}registerPlugin(t,e){super.registerPlugin(t,e),this.reactiveState.value=this.view.state}unregisterPlugin(t){super.unregisterPlugin(t),this.reactiveState.value=this.view.state}}function Na(t,e){var n=this;this.editorView=t,this.width=e.width||1,this.color=e.color||"black",this.class=e.class,this.cursorPos=null,this.element=null,this.timeout=null,this.handlers=["dragover","dragend","drop","dragleave"].map((function(e){function r(t){return n[e](t)}return t.dom.addEventListener(e,r),{name:e,handler:r}}))}Gr=Object(r.defineComponent)({name:"EditorContent",props:{editor:{default:null,type:Object}},setup(t){const e=Object(r.ref)(),n=Object(r.getCurrentInstance)();return Object(r.watchEffect)(()=>{const o=t.editor;o&&o.options.element&&e.value&&Object(r.nextTick)(()=>{var t;e.value&&o.options.element.firstChild&&(t=Object(r.unref)(e.value),e.value.append(...o.options.element.childNodes),o.contentComponent=n.ctx._,o.setOptions({element:t}),o.createNodeViews())})}),Object(r.onBeforeUnmount)(()=>{const e=t.editor;if(e&&(e.isDestroyed||e.view.setProps({nodeViews:{}}),e.contentComponent=null,e.options.element.firstChild)){const t=document.createElement("div");t.append(...e.options.element.childNodes),e.setOptions({element:t})}}),{rootEl:e}},render(){const t=[];return this.editor&&this.editor.vueRenderers.forEach(e=>{e=Object(r.h)(r.Teleport,{to:e.teleportElement,key:e.id},Object(r.h)(e.component,{ref:e.id,...e.props})),t.push(e)}),Object(r.h)("div",{ref:t=>{this.rootEl=t}},...t)}}),Object(r.defineComponent)({name:"FloatingMenu",props:{editor:{type:Object,required:!0},tippyOptions:{type:Object,default:()=>({})}},setup(t,{slots:e}){const n=Object(r.ref)(null);return Object(r.onMounted)(()=>{const{editor:e,tippyOptions:r}=t;e.registerPlugin(Ca({editor:e,element:n.value,tippyOptions:r}))}),Object(r.onBeforeUnmount)(()=>{const{editor:e}=t;e.unregisterPlugin(Sa)}),()=>{var t;return Object(r.h)("div",{ref:n},null===(t=e.default)||void 0===t?void 0:t.call(e))}}}),Boolean,Object(r.defineComponent)({props:{as:{type:String,default:"div"}},inject:["onDragStart","decorationClasses"],render(){var t,e;return Object(r.h)(this.as,{class:this.decorationClasses.value,style:{whiteSpace:"normal"},"data-node-view-wrapper":"",onDragStart:this.onDragStart},null===(e=(t=this.$slots).default)||void 0===e?void 0:e.call(t))}}),Object(r.defineComponent)({props:{as:{type:String,default:"div"}},render(){return Object(r.h)(this.as,{style:{whiteSpace:"pre-wrap"},"data-node-view-content":""})}}),Na.prototype.destroy=function(){var t=this;this.handlers.forEach((function(e){var n=e.name;e=e.handler;return t.editorView.dom.removeEventListener(n,e)}))},Na.prototype.update=function(t,e){null!=this.cursorPos&&e.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())},Na.prototype.setCursor=function(t){t!=this.cursorPos&&(null==(this.cursorPos=t)?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())},Na.prototype.updateOverlay=function(){var t,e,n=this.editorView.state.doc.resolve(this.cursorPos);n.parent.inlineContent||(t=n.nodeBefore,n=n.nodeAfter,(t||n)&&(e=this.editorView.nodeDOM(this.cursorPos-(t?t.nodeSize:0)).getBoundingClientRect(),i=t?e.bottom:e.top,t&&n&&(i=(i+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),e={left:e.left,right:e.right,top:i-this.width/2,bottom:i+this.width/2})),e||(e={left:(r=this.editorView.coordsAtPos(this.cursorPos)).left-this.width/2,right:r.left+this.width/2,top:r.top,bottom:r.bottom});var r,o,i=this.editorView.dom.offsetParent;this.element||(this.element=i.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none; background-color: "+this.color),i=!i||i==document.body&&"static"==getComputedStyle(i).position?(o=-pageXOffset,-pageYOffset):(o=(r=i.getBoundingClientRect()).left-i.scrollLeft,r.top-i.scrollTop),this.element.style.left=e.left-o+"px",this.element.style.top=e.top-i+"px",this.element.style.width=e.right-e.left+"px",this.element.style.height=e.bottom-e.top+"px"},Na.prototype.scheduleRemoval=function(t){var e=this;clearTimeout(this.timeout),this.timeout=setTimeout((function(){return e.setCursor(null)}),t)},Na.prototype.dragover=function(t){if(this.editorView.editable&&(t=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),t)){if(t=t.pos,this.editorView.dragging&&this.editorView.dragging.slice&&null==(t=$t(this.editorView.state.doc,t,this.editorView.dragging.slice)))return this.setCursor(null);this.setCursor(t),this.scheduleRemoval(5e3)}},Na.prototype.dragend=function(){this.scheduleRemoval(20)},Na.prototype.drop=function(){this.scheduleRemoval(20)},Na.prototype.dragleave=function(t){t.target!=this.editorView.dom&&this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)};var Aa=fi.create({name:"dropCursor",defaultOptions:{color:"currentColor",width:1,class:null},addProseMirrorPlugins(){return[(void 0===(t=this.options)&&(t={}),new ge({view:function(e){return new Na(e,t)}}))];var t}}),Ea=function(t){function e(e){t.call(this,e,e)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.map=function(n,r){return r=n.resolve(r.map(this.head)),e.valid(r)?new e(r):t.near(r)},e.prototype.content=function(){return j.empty},e.prototype.eq=function(t){return t instanceof e&&t.head==this.head},e.prototype.toJSON=function(){return{type:"gapcursor",pos:this.head}},e.fromJSON=function(t,n){if("number"!=typeof n.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new e(t.resolve(n.pos))},e.prototype.getBookmark=function(){return new Da(this.anchor)},e.valid=function(t){var e=t.parent;if(e.isTextblock||!function(t){for(var e=t.depth;0<=e;e--){var n=t.index(e);if(0!=n)for(var r=t.node(e).child(n-1);;r=r.lastChild){if(0==r.childCount&&!r.inlineContent||r.isAtom||r.type.spec.isolating)return!0;if(r.inlineContent)return!1}}return!0}(t)||!function(t){for(var e=t.depth;0<=e;e--){var n=t.indexAfter(e),r=t.node(e);if(n!=r.childCount)for(var o=r.child(n);;o=o.firstChild){if(0==o.childCount&&!o.inlineContent||o.isAtom||o.type.spec.isolating)return!0;if(o.inlineContent)return!1}}return!0}(t))return!1;var n=e.type.spec.allowGapCursor;return null!=n?n:(t=e.contentMatchAt(t.index()).defaultType,t&&t.isTextblock)},e.findFrom=function(t,n,r){t:for(;;){if(!r&&e.valid(t))return t;for(var o=t.pos,i=null,s=t.depth;;s--){var a=t.node(s);if(0<n?t.indexAfter(s)<a.childCount:0<t.index(s)){i=a.child(0<n?t.indexAfter(s):t.index(s)-1);break}if(0==s)return null;if(o+=n,a=t.doc.resolve(o),e.valid(a))return a}for(;;){var c=0<n?i.firstChild:i.lastChild;if(!c){if(!i.isAtom||i.isText||oe.isSelectable(i))break;t=t.doc.resolve(o+i.nodeSize*n),r=!1;continue t}if(i=c,o+=n,c=t.doc.resolve(o),e.valid(c))return c}return null}},e}(te);Ea.prototype.visible=!1,te.jsonID("gapcursor",Ea);var Da=function(t){this.pos=t};Da.prototype.map=function(t){return new Da(t.map(this.pos))},Da.prototype.resolve=function(t){return t=t.resolve(this.pos),Ea.valid(t)?new Ea(t):te.near(t)};var _a=uo({ArrowLeft:ja("horiz",-1),ArrowRight:ja("horiz",1),ArrowUp:ja("vert",-1),ArrowDown:ja("vert",1)});function ja(t,e){var n="vert"==t?0<e?"down":"up":0<e?"right":"left";return function(t,r,o){var i=t.selection,s=0<e?i.$to:i.$from,a=i.empty;if(i instanceof ne){if(!o.endOfTextblock(n)||0==s.depth)return!1;a=!1,s=t.doc.resolve(0<e?s.after():s.before())}return a=Ea.findFrom(s,e,a),!!a&&(r&&r(t.tr.setSelection(new Ea(a))),!0)}}function Ia(t,e,n){return!!t.editable&&(e=t.state.doc.resolve(e),!!Ea.valid(e)&&(n=t.posAtCoords({left:n.clientX,top:n.clientY}).inside,!(-1<n&&oe.isSelectable(t.state.doc.nodeAt(n)))&&(t.dispatch(t.state.tr.setSelection(new Ea(e))),!0)))}function za(t){if(!(t.selection instanceof Ea))return null;var e=document.createElement("div");return e.className="ProseMirror-gapcursor",Rr.create(t.doc,[jr.widget(t.selection.head,e,{key:"gapcursor"})])}function Va(){}var Ra=fi.create({name:"gapCursor",addProseMirrorPlugins(){return[new ge({props:{decorations:za,createSelectionBetween:function(t,e,n){if(e.pos==n.pos&&Ea.valid(n))return new Ea(n)},handleClick:Ia,handleKeyDown:_a}})]},extendNodeSchema(t){return{allowGapCursor:null!==(t=ai(ei(t,"allowGapCursor",{name:t.name,options:t.options})))&&void 0!==t?t:null}}}),La=Ms.create({name:"doc",topNode:!0,content:"block+"}),Ba=Ms.create({name:"paragraph",priority:1e3,defaultOptions:{HTMLAttributes:{}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",oi(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.toggleNode("paragraph","paragraph")}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Pa=Ms.create({name:"text",group:"inline"});Va.prototype.append=function(t){return t.length?(t=Va.from(t),!this.length&&t||t.length<200&&this.leafAppend(t)||this.length<200&&t.leafPrepend(this)||this.appendInner(t)):this},Va.prototype.prepend=function(t){return t.length?Va.from(t).append(this):this},Va.prototype.appendInner=function(t){return new $a(this,t)},Va.prototype.slice=function(t,e){return(e=void 0===e?this.length:e)<=(t=void 0===t?0:t)?Va.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,e))},Va.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)},Va.prototype.forEach=function(t,e,n){(e=void 0===e?0:e)<=(n=void 0===n?this.length:n)?this.forEachInner(t,e,n,0):this.forEachInvertedInner(t,e,n,0)},Va.prototype.map=function(t,e,n){void 0===n&&(n=this.length);var r=[];return this.forEach((function(e,n){return r.push(t(e,n))}),e=void 0===e?0:e,n),r},Va.from=function(t){return t instanceof Va?t:t&&t.length?new Ha(t):Va.empty};var Ha=function(t){function e(e){t.call(this),this.values=e}t&&(e.__proto__=t);var n={length:{configurable:!0},depth:{configurable:!0}};return((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(t,n){return 0==t&&n==this.length?this:new e(this.values.slice(t,n))},e.prototype.getInner=function(t){return this.values[t]},e.prototype.forEachInner=function(t,e,n,r){for(var o=e;o<n;o++)if(!1===t(this.values[o],r+o))return!1},e.prototype.forEachInvertedInner=function(t,e,n,r){for(var o=e-1;n<=o;o--)if(!1===t(this.values[o],r+o))return!1},e.prototype.leafAppend=function(t){if(this.length+t.length<=200)return new e(this.values.concat(t.flatten()))},e.prototype.leafPrepend=function(t){if(this.length+t.length<=200)return new e(t.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(Va);Va.empty=new Ha([]);var $a=function(t){function e(e,n){t.call(this),this.left=e,this.right=n,this.length=e.length+n.length,this.depth=Math.max(e.depth,n.depth)+1}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(t){return t<this.left.length?this.left.get(t):this.right.get(t-this.left.length)},e.prototype.forEachInner=function(t,e,n,r){var o=this.left.length;return!(e<o&&!1===this.left.forEachInner(t,e,Math.min(n,o),r))&&!(o<n&&!1===this.right.forEachInner(t,Math.max(e-o,0),Math.min(this.length,n)-o,r+o))&&void 0},e.prototype.forEachInvertedInner=function(t,e,n,r){var o=this.left.length;return!(o<e&&!1===this.right.forEachInvertedInner(t,e-o,Math.max(n,o)-o,r+o))&&!(n<o&&!1===this.left.forEachInvertedInner(t,Math.min(e,o),n,r))&&void 0},e.prototype.sliceInner=function(t,e){if(0==t&&e==this.length)return this;var n=this.left.length;return e<=n?this.left.slice(t,e):n<=t?this.right.slice(t-n,e-n):this.left.slice(t,n).append(this.right.slice(0,e-n))},e.prototype.leafAppend=function(t){if(t=this.right.leafAppend(t),t)return new e(this.left,t)},e.prototype.leafPrepend=function(t){if(t=this.left.leafPrepend(t),t)return new e(t,this.right)},e.prototype.appendInner=function(t){return this.left.depth>=Math.max(this.right.depth,t.depth)+1?new e(this.left,new e(this.right,t)):new e(this,t)},e}(Va),Fa=Va,qa=function(t,e){this.items=t,this.eventCount=e};qa.prototype.popEvent=function(t,e){var n=this;if(0==this.eventCount)return null;for(var r,o,i=this.items.length;;i--)if(this.items.get(i-1).selection){--i;break}e&&(r=this.remapping(i,this.items.length),o=r.maps.length);var s,a,c=t.tr,l=[],p=[];return this.items.forEach((function(t,e){return t.step?(r?(p.push(new Ja(t.map)),(d=t.step.map(r.slice(o)))&&c.maybeStep(d).doc&&(u=c.mapping.maps[c.mapping.maps.length-1],l.push(new Ja(u,null,null,l.length+p.length))),o--,u&&r.appendMap(u,o)):c.maybeStep(t.step),t.selection?(s=r?t.selection.map(r.slice(o)):t.selection,a=new qa(n.items.slice(0,i).append(p.reverse().concat(l)),n.eventCount-1),!1):void 0):(r||(r=n.remapping(i,e+1),o=r.maps.length),o--,void p.push(t));var d,u}),this.items.length,0),{remaining:a,transform:c,selection:s}},qa.prototype.addTransform=function(t,e,n,r){for(var o=[],i=this.eventCount,s=this.items,a=!r&&s.length?s.get(s.length-1):null,c=0;c<t.steps.length;c++){var l=t.steps[c].invert(t.docs[c]),p=new Ja(t.mapping.maps[c],l,e);(l=a&&a.merge(p))&&(p=l,c?o.pop():s=s.slice(0,s.length-1)),o.push(p),e&&(i++,e=null),r||(a=p)}var d,u,h=i-n.depth;return Ka<h&&(d=h,(n=s).forEach((function(t,e){if(t.selection&&0==d--)return u=e,!1})),s=n.slice(u),i-=h),new qa(s.append(o),i)},qa.prototype.remapping=function(t,e){var n=new Nt;return this.items.forEach((function(e,r){r=null!=e.mirrorOffset&&r-e.mirrorOffset>=t?n.maps.length-e.mirrorOffset:null,n.appendMap(e.map,r)}),t,e),n},qa.prototype.addMaps=function(t){return 0==this.eventCount?this:new qa(this.items.append(t.map((function(t){return new Ja(t)}))),this.eventCount)},qa.prototype.rebased=function(t,e){if(!this.eventCount)return this;var n=[],r=Math.max(0,this.items.length-e),o=t.mapping,i=t.steps.length,s=this.eventCount;this.items.forEach((function(t){t.selection&&s--}),r);var a=e;this.items.forEach((function(e){var r,c,l=o.getMirror(--a);null!=l&&(i=Math.min(i,l),r=o.maps[l],e.step?(c=t.steps[l].invert(t.docs[l]),(l=e.selection&&e.selection.map(o.slice(a+1,l)))&&s++,n.push(new Ja(r,c,l))):n.push(new Ja(r)))}),r);for(var c=[],l=e;l<i;l++)c.push(new Ja(o.maps[l]));return r=this.items.slice(0,r).append(c).append(n),r=new qa(r,s),500<r.emptyItemCount()?r.compress(this.items.length-n.length):r},qa.prototype.emptyItemCount=function(){var t=0;return this.items.forEach((function(e){e.step||t++})),t},qa.prototype.compress=function(t){void 0===t&&(t=this.items.length);var e=this.remapping(0,t),n=e.maps.length,r=[],o=0;return this.items.forEach((function(i,s){var a,c;t<=s?(r.push(i),i.selection&&o++):i.step?(a=(c=i.step.map(e.slice(n)))&&c.getMap(),n--,a&&e.appendMap(a,n),c&&((s=i.selection&&i.selection.map(e.slice(n)))&&o++,a=new Ja(a.invert(),c,s),c=r.length-1,(s=r.length&&r[c].merge(a))?r[c]=s:r.push(a))):i.map&&n--}),this.items.length,0),new qa(Fa.from(r.reverse()),o)},qa.empty=new qa(Fa.empty,0);var Ja=function(t,e,n,r){this.map=t,this.step=e,this.selection=n,this.mirrorOffset=r};Ja.prototype.merge=function(t){if(this.step&&t.step&&!t.selection&&(t=t.step.merge(this.step),t))return new Ja(t.getMap().invert(),t,this.selection)};var Wa=function(t,e,n,r){this.done=t,this.undone=e,this.prevRanges=n,this.prevTime=r},Ka=20;function Ua(t,e,n,r){var o=n.getMeta(ec);if(o)return o.historyState;if(n.getMeta(nc)&&(t=new Wa(t.done,t.undone,null,0)),o=n.getMeta("appendedTransaction"),0==n.steps.length)return t;if(o&&o.getMeta(ec))return o.getMeta(ec).redo?new Wa(t.done.addTransform(n,null,r,tc(e)),t.undone,Ga(n.mapping.maps[n.steps.length-1]),t.prevTime):new Wa(t.done,t.undone.addTransform(n,null,r,tc(e)),null,t.prevTime);if(!1===n.getMeta("addToHistory")||o&&!1===o.getMeta("addToHistory"))return(i=n.getMeta("rebased"))?new Wa(t.done.rebased(n,i),t.undone.rebased(n,i),Xa(t.prevRanges,n.mapping),t.prevTime):new Wa(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),Xa(t.prevRanges,n.mapping),t.prevTime);var i=0==t.prevTime||!o&&(t.prevTime<(n.time||0)-r.newGroupDelay||!function(t,e){if(!e)return!1;if(!t.docChanged)return!0;var n=!1;return t.mapping.maps[0].forEach((function(t,r){for(var o=0;o<e.length;o+=2)t<=e[o+1]&&r>=e[o]&&(n=!0)})),n}(n,t.prevRanges));o=o?Xa(t.prevRanges,n.mapping):Ga(n.mapping.maps[n.steps.length-1]);return new Wa(t.done.addTransform(n,i?e.selection.getBookmark():null,r,tc(e)),qa.empty,o,n.time)}function Ga(t){var e=[];return t.forEach((function(t,n,r,o){return e.push(r,o)})),e}function Xa(t,e){if(!t)return null;for(var n=[],r=0;r<t.length;r+=2){var o=e.map(t[r],1),i=e.map(t[r+1],-1);o<=i&&n.push(o,i)}return n}function Ya(t,e,n,r){var o,i=tc(e),s=ec.get(e).spec.config,a=(r?t.undone:t.done).popEvent(e,i);a&&(o=a.selection.resolve(a.transform.doc),i=(r?t.done:t.undone).addTransform(a.transform,e.selection.getBookmark(),s,i),i=new Wa(r?i:a.remaining,r?a.remaining:i,null,0),n(a.transform.setSelection(o).setMeta(ec,{redo:r,historyState:i}).scrollIntoView()))}var Qa=!1,Za=null;function tc(t){var e=t.plugins;if(Za!=e){Qa=!1,Za=e;for(var n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){Qa=!0;break}}return Qa}var ec=new we("history"),nc=new we("closeHistory"),rc=fi.create({name:"history",defaultOptions:{depth:100,newGroupDelay:500},addCommands(){return{undo:()=>({state:t,dispatch:e})=>{return n=t,t=e,!(!(e=ec.getState(n))||0==e.done.eventCount)&&(t&&Ya(e,n,t,!1),!0);var n},redo:()=>({state:t,dispatch:e})=>{return n=t,t=e,!(!(e=ec.getState(n))||0==e.undone.eventCount)&&(t&&Ya(e,n,t,!0),!0);var n}}},addProseMirrorPlugins(){return[(t={depth:(t=this.options)&&t.depth||100,newGroupDelay:t&&t.newGroupDelay||500},new ge({key:ec,state:{init:function(){return new Wa(qa.empty,qa.empty,null,0)},apply:function(e,n,r){return Ua(n,r,e,t)}},config:t}))];var t},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo()}}});const oc=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/gm,ic=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/gm,sc=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/gm,ac=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/gm;var cc=Ss.create({name:"bold",defaultOptions:{HTMLAttributes:{}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>"normal"!==t.style.fontWeight&&null},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",oi(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark("bold"),toggleBold:()=>({commands:t})=>t.toggleMark("bold"),unsetBold:()=>({commands:t})=>t.unsetMark("bold")}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Cs(oc,this.type),Cs(sc,this.type)]},addPasteRules(){return[Ts(ic,this.type),Ts(ac,this.type)]}});const lc=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/gm,pc=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/gm,dc=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/gm,uc=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/gm;var hc=Ss.create({name:"italic",defaultOptions:{HTMLAttributes:{}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>"normal"!==t.style.fontStyle&&null},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",oi(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark("italic"),toggleItalic:()=>({commands:t})=>t.toggleMark("italic"),unsetItalic:()=>({commands:t})=>t.unsetMark("italic")}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Cs(lc,this.type),Cs(dc,this.type)]},addPasteRules(){return[Ts(pc,this.type),Ts(uc,this.type)]}});const fc=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/gm;var mc=Ss.create({name:"code",defaultOptions:{HTMLAttributes:{}},excludes:"_",parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",oi(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark("code"),toggleCode:()=>({commands:t})=>t.toggleMark("code"),unsetCode:()=>({commands:t})=>t.unsetMark("code")}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Cs(fc,this.type)]},addPasteRules(){return[Ts(fc,this.type)]}});const vc=/^```(?<language>[a-z]*)? $/,gc=/^~~~(?<language>[a-z]*)? $/;var yc=Ms.create({name:"codeBlock",defaultOptions:{languageClassPrefix:"language-",HTMLAttributes:{}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:t=>{const e=null===(t=t.firstElementChild)||void 0===t?void 0:t.getAttribute("class");return e?(t=new RegExp(`^(${this.options.languageClassPrefix})`),{language:e.replace(t,"")}):null},renderHTML:t=>t.language?{class:this.options.languageClassPrefix+t.language}:null}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({HTMLAttributes:t}){return["pre",this.options.HTMLAttributes,["code",t,0]]},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode("codeBlock",t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode("codeBlock","paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{var{empty:t,$anchor:e}=this.editor.state.selection,n=1===e.pos;return!(!t||e.parent.type.name!==this.name)&&(n||!e.parent.textContent.length)&&this.editor.commands.clearNodes()}}},addInputRules(){return[go(vc,this.type,({groups:t})=>t),go(gc,this.type,({groups:t})=>t)]}}),bc=Ms.create({name:"heading",defaultOptions:{levels:[1,2,3,4,5,6],HTMLAttributes:{}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:"h"+t,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return["h"+(this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]),oi(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>!!this.options.levels.includes(t.level)&&e.setNode("heading",t),toggleHeading:t=>({commands:e})=>!!this.options.levels.includes(t.level)&&e.toggleNode("heading","paragraph",t)}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,["Mod-Alt-"+e]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>go(new RegExp(`^(#{1,${t}})\\s$`),this.type,{level:t}))}}),wc=Ms.create({name:"hardBreak",defaultOptions:{HTMLAttributes:{}},inline:!0,group:"inline",selectable:!1,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",oi(this.options.HTMLAttributes,t)]},addCommands(){return{setHardBreak:()=>({commands:t})=>t.first([()=>t.exitCode(),()=>t.insertContent({type:this.name})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}});const kc=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/gm,Oc=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/gm;var xc=Ss.create({name:"strike",defaultOptions:{HTMLAttributes:{}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>!!t.includes("line-through")&&{}}]},renderHTML({HTMLAttributes:t}){return["s",oi(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark("strike"),toggleStrike:()=>({commands:t})=>t.toggleMark("strike"),unsetStrike:()=>({commands:t})=>t.unsetMark("strike")}},addKeyboardShortcuts(){return{"Mod-Shift-x":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Cs(kc,this.type)]},addPasteRules(){return[Ts(Oc,this.type)]}});const Mc=/^\s*>\s$/gm;var Sc=Ms.create({name:"blockquote",defaultOptions:{HTMLAttributes:{}},content:"block*",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return["blockquote",oi(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn("blockquote"),toggleBlockquote:()=>({commands:t})=>t.toggleWrap("blockquote"),unsetBlockquote:()=>({commands:t})=>t.lift("blockquote")}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[vo(Mc,this.type)]}}),Cc=Ms.create({name:"horizontalRule",defaultOptions:{HTMLAttributes:{}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",oi(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t})=>t().insertContent({type:this.name}).command(({tr:t,dispatch:e})=>{var n;return e&&(({parent:n,pos:e}=t.selection.$from),t.doc.nodeAt(e+=1)||(n=null===(n=n.type.contentMatch.defaultType)||void 0===n?void 0:n.create())&&(t.insert(e,n),t.setSelection(ne.create(t.doc,e))),t.scrollIntoView()),!0}).run()}},addInputRules(){return[(t=/^(?:---|—-|___\s|\*\*\*\s)$/,e=this.type,new ho(t,(t,r,o,i)=>{var s=n instanceof Function?n(r):n;const{tr:a}=t;return r[0]&&a.replaceWith(o-1,i,e.create(s)),a}))];var t,e,n}});const Tc=/^\s*([-+*])\s$/;var Nc=Ms.create({name:"bulletList",defaultOptions:{HTMLAttributes:{}},group:"block list",content:"listItem+",parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",oi(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t})=>t.toggleList("bulletList","listItem")}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){return[vo(Tc,this.type)]}});const Ac=/^(\d+)\.\s$/;var Ec=Ms.create({name:"orderedList",defaultOptions:{HTMLAttributes:{}},group:"block list",content:"listItem+",addAttributes(){return{start:{default:1,parseHTML:t=>({start:t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1})}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return 1===e?["ol",oi(this.options.HTMLAttributes,n),0]:["ol",oi(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t})=>t.toggleList("orderedList","listItem")}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){return[vo(Ac,this.type,t=>({order:+t[1]}),(t,e)=>e.childCount+e.attrs.order===+t[1])]}}),Dc=Ms.create({name:"listItem",defaultOptions:{HTMLAttributes:{}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",oi(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem("listItem"),Tab:()=>this.editor.commands.sinkListItem("listItem"),"Shift-Tab":()=>this.editor.commands.liftListItem("listItem")}}});fi.create({name:"starterKit",addExtensions(){var t,e,n,r,o,i,s,a,c;const l=[];return!1!==this.options.blockquote&&l.push(Sc.configure(null===(t=this.options)||void 0===t?void 0:t.blockquote)),!1!==this.options.bold&&l.push(cc.configure(null===(t=this.options)||void 0===t?void 0:t.bold)),!1!==this.options.bulletList&&l.push(Nc.configure(null===(e=this.options)||void 0===e?void 0:e.bulletList)),!1!==this.options.code&&l.push(mc.configure(null===(e=this.options)||void 0===e?void 0:e.code)),!1!==this.options.codeBlock&&l.push(yc.configure(null===(n=this.options)||void 0===n?void 0:n.codeBlock)),!1!==this.options.document&&l.push(La.configure(null===(n=this.options)||void 0===n?void 0:n.document)),!1!==this.options.dropcursor&&l.push(Aa.configure(null===(r=this.options)||void 0===r?void 0:r.dropcursor)),!1!==this.options.gapcursor&&l.push(Ra.configure(null===(r=this.options)||void 0===r?void 0:r.gapcursor)),!1!==this.options.hardBreak&&l.push(wc.configure(null===(o=this.options)||void 0===o?void 0:o.hardBreak)),!1!==this.options.heading&&l.push(bc.configure(null===(o=this.options)||void 0===o?void 0:o.heading)),!1!==this.options.history&&l.push(rc.configure(null===(i=this.options)||void 0===i?void 0:i.history)),!1!==this.options.horizontalRule&&l.push(Cc.configure(null===(i=this.options)||void 0===i?void 0:i.horizontalRule)),!1!==this.options.italic&&l.push(hc.configure(null===(s=this.options)||void 0===s?void 0:s.italic)),!1!==this.options.listItem&&l.push(Dc.configure(null===(s=this.options)||void 0===s?void 0:s.listItem)),!1!==this.options.orderedList&&l.push(Ec.configure(null===(a=this.options)||void 0===a?void 0:a.orderedList)),!1!==this.options.paragraph&&l.push(Ba.configure(null===(a=this.options)||void 0===a?void 0:a.paragraph)),!1!==this.options.strike&&l.push(xc.configure(null===(c=this.options)||void 0===c?void 0:c.strike)),!1!==this.options.text&&l.push(Pa.configure(null===(c=this.options)||void 0===c?void 0:c.text)),l}});var _c=Ss.create({name:"underline",defaultOptions:{HTMLAttributes:{}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>!!t.includes("underline")&&{}}]},renderHTML({HTMLAttributes:t}){return["u",oi(this.options.HTMLAttributes,t),0]},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark("underline"),toggleUnderline:()=>({commands:t})=>t.toggleMark("underline"),unsetUnderline:()=>({commands:t})=>t.unsetMark("underline")}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline()}}}),jc=fi.create({name:"textAlign",defaultOptions:{types:[],alignments:["left","center","right","justify"],defaultAlignment:"left"},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:t=>({textAlign:t.style.textAlign||this.options.defaultAlignment}),renderHTML:t=>t.textAlign===this.options.defaultAlignment?{}:{style:"text-align: "+t.textAlign}}}}]},addCommands(){return{setTextAlign:t=>({commands:e})=>!!this.options.alignments.includes(t)&&this.options.types.every(n=>e.updateAttributes(n,{textAlign:t})),unsetTextAlign:()=>({commands:t})=>this.options.types.every(e=>t.resetAttributes(e,"textAlign"))}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}}),Ic=(Ir=Object(r.defineComponent)({name:"EditProduct",components:{EditorContent:Gr},setup:function(){var t=Object(r.ref)(!1),e=Object(r.ref)(null),n=(t=>{const e=Object(r.ref)();return Object(r.onMounted)(()=>{e.value=new Ta(t)}),Object(r.onBeforeUnmount)(()=>{var t;null!==(t=e.value)&&void 0!==t&&t.destroy()}),e})({content:"",extensions:[].concat(Object(x.a)((console.warn('[tiptap warn]: defaultExtensions() is deprecated. please use the default export "StarterKit". "StarterKit" is a regular extension that contains all other extensions.'),[La,Ba.configure(null==o?void 0:o.paragraph),Pa,cc.configure(null==o?void 0:o.bold),hc.configure(null==o?void 0:o.italic),mc.configure(null==o?void 0:o.code),xc.configure(null==o?void 0:o.strike),wc.configure(null==o?void 0:o.hardBreak),bc.configure(null==o?void 0:o.heading),Sc.configure(null==o?void 0:o.blockquote),Nc.configure(null==o?void 0:o.bulletList),Ec.configure(null==o?void 0:o.orderedList),Dc.configure(null==o?void 0:o.listItem),Cc.configure(null==o?void 0:o.horizontalRule),yc.configure(null==o?void 0:o.codeBlock),rc.configure(null==o?void 0:o.history),Aa.configure(null==o?void 0:o.dropcursor),Ra])),[La,Ba,Pa,_c,jc.configure({types:["heading","paragraph"]})])}),o=Object(r.reactive)([[{tip:"段落",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 6v15h-2v-5a6 6 0 1 1 0-12h10v2h-3v15h-2V6h-3zm-2 0a4 4 0 1 0 0 8V6z"/></svg>',handleClick:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.chain().focus().setParagraph().run()},handleIsActive:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.isActive("paragraph")}},{tip:"h1",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" > <path fill="none" d="M0 0H24V24H0z" /> <path d="M13 20h-2v-7H4v7H2V4h2v7h7V4h2v16zm8-12v12h-2v-9.796l-2 .536V8.67L19.5 8H21z" /> </svg>',handleClick:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.chain().focus().toggleHeading({level:1}).run()},handleIsActive:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.isActive("heading",{level:1})}},{tip:"h2",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0H24V24H0z"/><path d="M4 4v7h7V4h2v16h-2v-7H4v7H2V4h2zm14.5 4c2.071 0 3.75 1.679 3.75 3.75 0 .857-.288 1.648-.772 2.28l-.148.18L18.034 18H22v2h-7v-1.556l4.82-5.546c.268-.307.43-.709.43-1.148 0-.966-.784-1.75-1.75-1.75-.918 0-1.671.707-1.744 1.606l-.006.144h-2C14.75 9.679 16.429 8 18.5 8z"/></svg>',handleClick:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.chain().focus().toggleHeading({level:2}).run()},handleIsActive:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.isActive("heading",{level:2})}},{tip:"h3",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0H24V24H0z"/><path d="M22 8l-.002 2-2.505 2.883c1.59.435 2.757 1.89 2.757 3.617 0 2.071-1.679 3.75-3.75 3.75-1.826 0-3.347-1.305-3.682-3.033l1.964-.382c.156.806.866 1.415 1.718 1.415.966 0 1.75-.784 1.75-1.75s-.784-1.75-1.75-1.75c-.286 0-.556.069-.794.19l-1.307-1.547L19.35 10H15V8h7zM4 4v7h7V4h2v16h-2v-7H4v7H2V4h2z"/></svg>',handleClick:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.chain().focus().toggleHeading({level:3}).run()},handleIsActive:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.isActive("heading",{level:3})}},{tip:"h4",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0H24V24H0z"/><path d="M13 20h-2v-7H4v7H2V4h2v7h7V4h2v16zm9-12v8h1.5v2H22v2h-2v-2h-5.5v-1.34l5-8.66H22zm-2 3.133L17.19 16H20v-4.867z"/></svg>',handleClick:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.chain().focus().toggleHeading({level:4}).run()},handleIsActive:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.isActive("heading",{level:4})}},{tip:"h5",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0H24V24H0z"/><path d="M22 8v2h-4.323l-.464 2.636c.33-.089.678-.136 1.037-.136 2.21 0 4 1.79 4 4s-1.79 4-4 4c-1.827 0-3.367-1.224-3.846-2.897l1.923-.551c.24.836 1.01 1.448 1.923 1.448 1.105 0 2-.895 2-2s-.895-2-2-2c-.63 0-1.193.292-1.56.748l-1.81-.904L16 8h6zM4 4v7h7V4h2v16h-2v-7H4v7H2V4h2z"/></svg>',handleClick:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.chain().focus().toggleHeading({level:5}).run()},handleIsActive:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.isActive("heading",{level:5})}},{tip:"h6",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0H24V24H0z"/><path d="M21.097 8l-2.598 4.5c2.21 0 4.001 1.79 4.001 4s-1.79 4-4 4-4-1.79-4-4c0-.736.199-1.426.546-2.019L18.788 8h2.309zM4 4v7h7V4h2v16h-2v-7H4v7H2V4h2zm14.5 10.5c-1.105 0-2 .895-2 2s.895 2 2 2 2-.895 2-2-.895-2-2-2z"/></svg>',handleClick:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.chain().focus().toggleHeading({level:6}).run()},handleIsActive:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.isActive("heading",{level:6})}},{tip:"斜体",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M15 20H7v-2h2.927l2.116-12H9V4h8v2h-2.927l-2.116 12H15z"/></svg>',handleClick:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.chain().focus().toggleItalic().run()},handleIsActive:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.isActive("italic")}},{tip:"粗体",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M8 11h4.5a2.5 2.5 0 1 0 0-5H8v5zm10 4.5a4.5 4.5 0 0 1-4.5 4.5H6V4h6.5a4.5 4.5 0 0 1 3.256 7.606A4.498 4.498 0 0 1 18 15.5zM8 13v5h5.5a2.5 2.5 0 1 0 0-5H8z"/></svg>',handleClick:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.chain().focus().toggleBold().run()},handleIsActive:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.isActive("bold")}},{tip:"下划线",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M8 3v9a4 4 0 1 0 8 0V3h2v9a6 6 0 1 1-12 0V3h2zM4 20h16v2H4v-2z"/></svg>',handleClick:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.chain().focus().toggleUnderline().run()},handleIsActive:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.isActive("underline")}},{tip:"中划线",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M17.154 14c.23.516.346 1.09.346 1.72 0 1.342-.524 2.392-1.571 3.147C14.88 19.622 13.433 20 11.586 20c-1.64 0-3.263-.381-4.87-1.144V16.6c1.52.877 3.075 1.316 4.666 1.316 2.551 0 3.83-.732 3.839-2.197a2.21 2.21 0 0 0-.648-1.603l-.12-.117H3v-2h18v2h-3.846zm-4.078-3H7.629a4.086 4.086 0 0 1-.481-.522C6.716 9.92 6.5 9.246 6.5 8.452c0-1.236.466-2.287 1.397-3.153C8.83 4.433 10.271 4 12.222 4c1.471 0 2.879.328 4.222.984v2.152c-1.2-.687-2.515-1.03-3.946-1.03-2.48 0-3.719.782-3.719 2.346 0 .42.218.786.654 1.099.436.313.974.562 1.613.75.62.18 1.297.414 2.03.699z"/></svg>',handleClick:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.chain().focus().toggleStrike().run()},handleIsActive:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.isActive("strike")}}],[{tip:"无序列表",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M8 4h13v2H8V4zM4.5 6.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm0 7a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm0 6.9a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zM8 11h13v2H8v-2zm0 7h13v2H8v-2z"/></svg>',handleClick:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.chain().focus().toggleBulletList().run()},handleIsActive:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.isActive("bulletList")}},{tip:"有序列表",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M8 4h13v2H8V4zM5 3v3h1v1H3V6h1V4H3V3h2zM3 14v-2.5h2V11H3v-1h3v2.5H4v.5h2v1H3zm2 5.5H3v-1h2V18H3v-1h3v4H3v-1h2v-.5zM8 11h13v2H8v-2zm0 7h13v2H8v-2z"/></svg>',handleClick:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.chain().focus().toggleOrderedList().run()},handleIsActive:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.isActive("orderedList")}}],[{tip:"居左",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M3 4h18v2H3V4zm0 15h14v2H3v-2zm0-5h18v2H3v-2zm0-5h14v2H3V9z"/></svg>',handleClick:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.chain().focus().setTextAlign("left").run()},handleIsActive:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.isActive({textAlign:"left"})}},{tip:"居中",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M3 4h18v2H3V4zm2 15h14v2H5v-2zm-2-5h18v2H3v-2zm2-5h14v2H5V9z"/></svg>',handleClick:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.chain().focus().setTextAlign("center").run()},handleIsActive:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.isActive({textAlign:"center"})}},{tip:"居右",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M3 4h18v2H3V4zm4 15h14v2H7v-2zm-4-5h18v2H3v-2zm4-5h14v2H7V9z"/></svg>',handleClick:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.chain().focus().setTextAlign("right").run()},handleIsActive:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.isActive({textAlign:"right"})}},{tip:"两端对齐",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M3 4h18v2H3V4zm0 15h18v2H3v-2zm0-5h18v2H3v-2zm0-5h18v2H3V9z"/></svg>',handleClick:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.chain().focus().setTextAlign("justify").run()},handleIsActive:function(){var t;return null===(t=n.value)||void 0===t?void 0:t.isActive({textAlign:"justify"})}}],[]]);return Object(r.onBeforeUnmount)((function(){var t;null!==(t=n.value)&&void 0!==t&&t.destroy()})),{sourceShow:t,textareaEl:e,toolsList:o,editor:n,handleSwitchHTML:function(){var o;t.value?Object(r.unref)(e)&&null!==(o=Object(r.unref)(n))&&void 0!==o&&o.commands.setContent(null===(o=Object(r.unref)(e))||void 0===o?void 0:o.value):e&&e.value&&n&&n.value&&(e.value.value=n.value.getHTML()),t.value=!t.value}}}}),Ye=(n("654a"),n("6b0d")),Gr=n.n(Ye),Ye=Gr()(Ir,[["render",O],["__scopeId","data-v-6815dab7"]]),n("5530"));Ir=Object(r.withScopeId)("data-v-3adc1e29");Object(r.pushScopeId)("data-v-3adc1e29");var zc=Object(r.createVNode)("i",{class:"el-icon-close"},null,-1),Vc=Object(r.createVNode)("i",{class:"el-icon-arrow-left"},null,-1),Rc=Object(r.createVNode)("i",{class:"el-icon-arrow-right"},null,-1),Lc={class:"media-viewer__btn media-viewer__actions"},Bc={class:"media-viewer__actions__inner"},Pc=Object(r.createVNode)("i",{class:"media-viewer__actions__divider"},null,-1),Hc=Object(r.createVNode)("i",{class:"media-viewer__actions__divider"},null,-1),$c={class:"media-viewer__canvas"};Object(r.popScopeId)();O=Ir((function(t,e,n,o,i,s){return Object(r.openBlock)(),Object(r.createBlock)("div",{class:"preview-media__wrapper",style:{zIndex:t.zIndex}},[Object(r.createVNode)("div",{class:"media-viewer__mask",onClick:e[1]||(e[1]=function(){return t.hideOnClickModal?t.hide():void 0})}),Object(r.createVNode)("span",{class:"media-viewer__btn media-viewer__close",onClick:e[2]||(e[2]=function(){return t.hide&&t.hide.apply(t,arguments)})},[zc]),Object(r.createVNode)("span",{class:"media-viewer__btn media-viewer__prev",onClick:e[3]||(e[3]=function(){return t.prev&&t.prev.apply(t,arguments)})},[Vc]),Object(r.createVNode)("span",{class:"media-viewer__btn media-viewer__next",onClick:e[4]||(e[4]=function(){return t.next&&t.next.apply(t,arguments)})},[Rc]),Object(r.createVNode)("div",Lc,[Object(r.createVNode)("div",Bc,[Object(r.createVNode)("i",{class:"el-icon-zoom-out",onClick:e[5]||(e[5]=function(e){return t.handleActions("zoomOut")})}),Object(r.createVNode)("i",{class:"el-icon-zoom-in",onClick:e[6]||(e[6]=function(e){return t.handleActions("zoomIn")})}),Pc,Object(r.createVNode)("i",{class:"el-icon-full-screen",onClick:e[7]||(e[7]=function(){return t.toggleMode&&t.toggleMode.apply(t,arguments)})}),Hc,Object(r.createVNode)("i",{class:"el-icon-refresh-left",onClick:e[8]||(e[8]=function(e){return t.handleActions("anticlocelise")})}),Object(r.createVNode)("i",{class:"el-icon-refresh-right",onClick:e[9]||(e[9]=function(e){return t.handleActions("clocelise")})})])]),Object(r.createVNode)("div",$c,[(Object(r.openBlock)(!0),Object(r.createBlock)(r.Fragment,null,Object(r.renderList)(t.mediaList,(function(e,n){return Object(r.openBlock)(),Object(r.createBlock)(r.Fragment,{key:e.id},["image"===e.type?(Object(r.openBlock)(),Object(r.createBlock)("img",{key:0,src:e.src,alt:"",style:Object(Ic.a)(Object(Ic.a)({},t.mediaStyle),{},{display:t.index===n?"initial":"none"})},null,12,["src"])):"video"===e.type?(Object(r.openBlock)(),Object(r.createBlock)("video",{key:1,src:e.src,style:Object(Ic.a)(Object(Ic.a)({},t.mediaStyle),{},{display:t.index===n?"initial":"none"}),controls:""},null,12,["src"])):Object(r.createCommentVNode)("",!0)],64)})),128))])],4)}));var Fc=(n("a9e3"),n("b0c0"),n("b680"),{CONTAIN:{name:"contain",icon:"el-icon-full-screen"},ORIGINAL:{name:"original",icon:"el-icon-c-scale-to-original"}});Ir=Object(r.defineComponent)({name:"PreviewMedia",props:{mediaList:{type:Array,default:function(){return[]}},zIndex:{type:Number,default:2e3},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1}},emits:["close","switch"],setup:function(t,e){function n(){var e;f.value&&!t.infinite||(e=t.mediaList.length,d.value=(d.value-1+e)%e)}function o(){var e;m.value&&!t.infinite||(e=t.mediaList.length,d.value=(d.value+1)%e)}function i(){u.value=u.value.name===Fc.CONTAIN.name?Fc.ORIGINAL:Fc.CONTAIN,h.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function s(t){var e=(r=Object.assign({zoomRate:.2,rotateDeg:90,enableTransition:!0},1<arguments.length&&void 0!==arguments[1]?arguments[1]:{})).zoomRate,n=r.rotateDeg,r=r.enableTransition;switch(t){case"zoomOut":.2<h.value.scale&&(h.value.scale=parseFloat((h.value.scale-e).toFixed(3)));break;case"zoomIn":h.value.scale=parseFloat((h.value.scale+e).toFixed(3));break;case"clocelise":h.value.deg+=n;break;case"anticlocelise":h.value.deg-=n}h.value.enableTransition=r}var a=e.emit,c=null,l=null,p=Object(r.ref)(""),d=Object(r.ref)(t.initialIndex),u=Object(r.ref)(Fc.CONTAIN),h=Object(r.ref)({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),f=(Object(r.computed)((function(){return t.mediaList.length<=1})),Object(r.computed)((function(){return 0===d.value}))),m=Object(r.computed)((function(){return d.value===t.mediaList.length-1})),v=(e=(Object(r.computed)((function(){return t.mediaList[d.value]})),Object(r.computed)((function(){var t=h.value,e=t.scale,n=t.deg,r=t.offsetX,o=t.offsetY;t=t.enableTransition,o={transform:"scale(".concat(e,") rotate(").concat(n,"deg)"),transition:t?"transform .3s":"",marginLeft:"".concat(r,"px"),marginTop:"".concat(o,"px")};return u.value.name===Fc.CONTAIN.name&&(o.maxWidth=o.maxHeight="100%"),o}))),function(){document.removeEventListener("keydown",c),document.removeEventListener("mousewheel",l),document.removeEventListener("DOMMouseScroll",l),l=c=null,document.querySelector("body").style.overflow=p.value,a("close")});return Object(r.onMounted)((function(){c=function(t){switch(t.code){case"ArrowUp":s("zoomIn");break;case"ArrowDown":s("zoomOut");break;case"ArrowLeft":n();break;case"ArrowRight":o();break;case"Space":i();break;case"Escape":v()}},l=function(t){t=t.wheelDelta|-t.detail,s(0<t?"zoomIn":"zoomOut",{zoomRate:.015,enableTransition:!1})},document.addEventListener("keydown",c),document.addEventListener("mousewheel",l),document.addEventListener("DOMMouseScroll",l),p.value=document.querySelector("body").style.overflow,document.querySelector("body").style.overflow="hidden"})),{mediaStyle:e,index:d,handleActions:s,prev:n,next:o,toggleMode:i,hide:v}}}),n("abb3"),O=Gr()(Ir,[["render",O],["__scopeId","data-v-3adc1e29"]]),O=Object(r.defineComponent)({name:"EditProduct",components:{Editor:Ye,PreviewMedia:O},setup:function(){Object(f.useRouter)();var t=Object(f.useRoute)(),e=Object(r.ref)(!1),n=Object(r.reactive)([]);return console.log(t.params.product_id,t.params.vendor_id),Object(f.onBeforeRouteLeave)(function(){var t=Object(h.a)(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:window.confirm("确认离开吗？");case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),{media:n,showViewer:e,handleClosePreview:function(){e.value=!1}}}});n("d7db"),e.default=Gr()(O,[["render",u],["__scopeId","data-v-321a5573"]])},d28b:function(t,e,n){n("746f")("iterator")},d7db:function(t,e,n){"use strict";n("0a31")}}]);